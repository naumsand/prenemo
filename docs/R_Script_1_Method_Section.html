<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Method section</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/table1-1.0/table1_defaults.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Naumann et al.</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="glyphicon glyphicon-info-sign"></span>
     
    Introduction
  </a>
</li>
<li>
  <a href="R_Script_1_Method_Section.html">
    <span class="glyphicon glyphicon-wrench"></span>
     
    Method section
  </a>
</li>
<li>
  <a href="R_Script_2_EEG_task_measures.html">
    <span class="glyphicon glyphicon-hand-up"></span>
     
    EEG task measures
  </a>
</li>
<li>
  <a href="R_Script_3_ERP_measures.html">
    <span class="glyphicon glyphicon-user"></span>
     
    ERP measures
  </a>
</li>
<li>
  <a href="R_Script_4_Emotion_empathy_measures.html">
    <span class="glyphicon glyphicon-link"></span>
     
    Emotion &amp; Empathy measures
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Method section</h1>

</div>


<!-- Set up workspace -->
<p><br></p>
<div id="participants" class="section level3">
<h3>2.1 Participants</h3>
<pre class="r"><code># Load questionnaire data
  qn_data = readWorksheetFromFile(&quot;./data/QN_Data.xlsx&quot;, 
                             sheet = &quot;QN_data&quot;, 
                             startCol = 1,
                             endCol = 0) 

# De-select participants 
  # 5 = ERP components not visible 
  qn_data = qn_data[with(qn_data, !(qn_data$ID==&quot;5&quot;)), ]

# Define N/A data
  qn_data[qn_data==-99] = NA


# Get length of data frame

  ntotal = 33
  num_part = nrow(qn_data) 
  
# Calculate attrition rate 
  attr_rate = 100-(nrow(qn_data)*100)/ntotal 


# Extract age from birth/test date
# Needs to be numeric in order to create a table
  qn_data$age = as.numeric(cbind(age_calc(as.Date(qn_data$birth_date),
                                          as.Date(qn_data$test_date), units = &quot;years&quot;)))

# Calculate mean 
  age_mean = mean(qn_data$age)

# Calculate SD
  age_sd = sd(qn_data$age)
  
  
# Re-code gender
  qn_data$sex[qn_data$sex == 1] = &quot;Male&quot;
  qn_data$sex[qn_data$sex == 2] = &quot;Female&quot;

# Count &quot;female&quot; instances 
  fem = sum(str_count(qn_data$sex, pattern = &quot;Female&quot;))
  mal = num_part - fem</code></pre>
<p><br></p>
<div id="table-xx" class="section level4">
<h4>Table XX</h4>
<pre class="r"><code># Calculate Winkler-Index 

  # Create Winkler Index 
  
    # For the Winkler Index, one awards points for income, occupation and education level of each
    # parent. Points range from 1-5. These points are added up. The maximum value would be 15 points.
    # For education and occupation, the parent with the larger score was chosen per family. 
  
  # Income
    # 1 = 0-1250 Euro
    # 2 = 1250-2000 Euro
    # 3 = 2000-3000 Euro,
    # 4 = 3000-5000 Euro
    # 5 = more than 5000 Euro
  
    qn_data$income_rec[qn_data$income==1 | qn_data$income==2 | qn_data$income==3 | qn_data$income==4] = 1
    qn_data$income_rec[qn_data$income==5 | qn_data$income==6 | qn_data$income==7] = 2
    qn_data$income_rec[qn_data$income==8 | qn_data$income==9 | qn_data$income==10] = 3
    qn_data$income_rec[qn_data$income==11 | qn_data$income==12] = 4
    qn_data$income_rec[qn_data$income==13] = 5
    
  # Education
    # 1 = no degree
    # 2 = secondary modern school [German: &quot;Hauptschule&quot;]
    # 3 = middle school [German: &quot;Realschule&quot;]
    # 4 = advanced technical college entrance qualification [German: &quot;Fachhochschulreife&quot;]
    # 5 = higher education entrance qualification (A-levels) [German: &quot;Abitur&quot;]
  
  # for mum
    qn_data$mum_ed_rec[qn_data$mum_ed==7 | qn_data$mum_ed==8] = 1
    qn_data$mum_ed_rec[qn_data$mum_ed==1 | qn_data$mum_ed==6] = 2
    qn_data$mum_ed_rec[qn_data$mum_ed==2 | qn_data$mum_ed==3] = 3
    qn_data$mum_ed_rec[qn_data$mum_ed==4] = 4
    qn_data$mum_ed_rec[qn_data$mum_ed==5] = 5

  
  # for dad
    qn_data$dad_ed_rec[qn_data$dad_ed==7 | qn_data$dad_ed==8] = 1
    qn_data$dad_ed_rec[qn_data$dad_ed==1 | qn_data$dad_ed==6] = 2
    qn_data$dad_ed_rec[qn_data$dad_ed==2 | qn_data$dad_ed==3] = 3
    qn_data$dad_ed_rec[qn_data$dad_ed==4] = 4
    qn_data$dad_ed_rec[qn_data$dad_ed==5] = 5
  
  # Occupation 
    # 1 = student
    # 2 = skilled worker [German:Gelernter &quot;Facharbeiter&quot;]
    # 3 = foremen/forwomen [German: &quot;Vorarbeiter&quot;]
    # 4 = clerk in the middle grade of the civil service [German: &quot;Beamter mittlerer Dienst&quot;]
    # 5 = senior officials [German: &quot;Beamte höherer Dienst&quot;]
  
  # for mum
    qn_data$occ_mum[qn_data$mum_occup_ISCO==5 | qn_data$mum_occup_ISCO==11 |
                      qn_data$mum_occup_ISCO==12 | qn_data$mum_occup_ISCO==51 | 
                      qn_data$mum_occup_ISCO==52] = 1
    
    qn_data$occ_mum[qn_data$mum_occup_ISCO==13 | qn_data$mum_occup_ISCO==21 |
                      qn_data$mum_occup_ISCO==26 | qn_data$mum_occup_ISCO==31 |
                      qn_data$mum_occup_ISCO==32] = 2
    
    qn_data$occ_mum[qn_data$mum_occup_ISCO==14 | qn_data$mum_occup_ISCO==33 | 
                      qn_data$mum_occup_ISCO==41] = 3
    
    qn_data$occ_mum[qn_data$mum_occup_ISCO==2 | qn_data$mum_occup_ISCO==22 | 
                      qn_data$mum_occup_ISCO==23 | qn_data$mum_occup_ISCO==24 |
                      qn_data$mum_occup_ISCO==34 | qn_data$mum_occup_ISCO==42] = 4
    
    qn_data$occ_mum[qn_data$mum_occup_ISCO==25 | 
                      qn_data$mum_occup_ISCO==35 | qn_data$mum_occup_ISCO==43 |
                      qn_data$mum_occup_ISCO==44] = 5
  
  # for dad
    qn_data$occ_dad[qn_data$dad_occup_ISCO==5 | qn_data$dad_occup_ISCO==11 |
                      qn_data$dad_occup_ISCO==12 | qn_data$dad_occup_ISCO==51 |
                      qn_data$dad_occup_ISCO==52] = 1
    
    qn_data$occ_dad[qn_data$dad_occup_ISCO==13 | qn_data$dad_occup_ISCO==21 | 
                      qn_data$dad_occup_ISCO==26 | qn_data$dad_occup_ISCO==31 | 
                      qn_data$dad_occup_ISCO==32] = 2
    
    qn_data$occ_dad[qn_data$dad_occup_ISCO==14 | qn_data$dad_occup_ISCO==33 | 
                      qn_data$dad_occup_ISCO==41] = 3
    
    qn_data$occ_dad[qn_data$dad_occup_ISCO==2 | qn_data$dad_occup_ISCO==22 | 
                      qn_data$dad_occup_ISCO==23 | qn_data$dad_occup_ISCO==24 |
                      qn_data$dad_occup_ISCO==34 | qn_data$dad_occup_ISCO==42] = 4
    
    qn_data$occ_dad[qn_data$dad_occup_ISCO==25 | qn_data$dad_occup_ISCO==35 |
                      qn_data$dad_occup_ISCO==43 | qn_data$dad_occup_ISCO==44] = 5
  
  # Calculate Winkler index
    # Sum up all points (choose the parent with the larger score). 
  
    for (h in 1:length(qn_data$ID)){
      qn_data$wink_ind[h] = sum(qn_data$income_rec[h],
                            max(qn_data$occ_dad[h],qn_data$occ_mum[h]),
                            max(qn_data$mum_ed_rec[h],qn_data$dad_ed_rec[h]))
    }
    
    
# Based on tutorial: https://cran.r-project.org/web/packages/table1/vignettes/table1-examples.html 
  # Creat for table in RMarkdown: styles.css file in same folder 
      
  # Create labels 
    labels = list(
      variables=list(age = &quot;Child age in years&quot;,
                     sex = &quot;Child sex&quot;,
                     PPVT_Perc=&quot;PPVT (%ile rank)&quot;,
                     CMM_Perc=&quot;CMM (%ile rank)&quot;,
                     SRS = &quot;SRS raw value&quot;,
                     SCQ = &quot;SCQ raw value&quot;,
                    wink_ind = &quot;Winkler Index&quot;)) # this is where you set your headings for the table
    
  # Creates list in which order we want to display columns
    strata &lt;- c(list(Total=qn_data))
    
  # Customize the contents using custom renderers
    my.render.cont = function(x) {
      with(stats.apply.rounding(stats.default(x), digits=3),
           c(&quot;&quot;, &quot;mean (SD)&quot;=sprintf(&quot;%s (%s)&quot;, MEAN, SD)))
    }
    
    my.render.cat = function(x) {
      c(&quot;&quot;, sapply(stats.default(x),
                   function(y) with(y, sprintf(&quot;%d (%0.0f %%)&quot;, FREQ, PCT))))
    }
    
  # Create table
    table1(strata, labels, render.continuous=my.render.cont, render.categorical=my.render.cat)</code></pre>
<div class="Rtable1"><table class="Rtable1">
<thead>
<tr>
<th class='rowlabel firstrow lastrow'></th>
<th class='firstrow lastrow'><span class='stratlabel'>Total<br><span class='stratn'>(N=31)</span></span></th>
</tr>
</thead>
<tbody>
<tr>
<td class='rowlabel firstrow'>Child age in years</td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel lastrow'>mean (SD)</td>
<td class='lastrow'>5.14 (0.668)</td>
</tr>
<tr>
<td class='rowlabel firstrow'>Child sex</td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Female</td>
<td>15 (48 %)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Male</td>
<td class='lastrow'>16 (52 %)</td>
</tr>
<tr>
<td class='rowlabel firstrow'>PPVT (%ile rank)</td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>mean (SD)</td>
<td>58.5 (27.4)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Missing</td>
<td class='lastrow'>1 (3.2%)</td>
</tr>
<tr>
<td class='rowlabel firstrow'>CMM (%ile rank)</td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>mean (SD)</td>
<td>60.1 (36.3)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Missing</td>
<td class='lastrow'>1 (3.2%)</td>
</tr>
<tr>
<td class='rowlabel firstrow'>SRS raw value</td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel lastrow'>mean (SD)</td>
<td class='lastrow'>35.0 (12.7)</td>
</tr>
<tr>
<td class='rowlabel firstrow'>SCQ raw value</td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel lastrow'>mean (SD)</td>
<td class='lastrow'>4.26 (2.08)</td>
</tr>
<tr>
<td class='rowlabel firstrow'>Winkler Index</td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel lastrow'>mean (SD)</td>
<td class='lastrow'>11.8 (2.26)</td>
</tr>
</tbody>
</table>
</div>
<p><br></p>
</div>
</div>
<div id="eeg-recording-processing-and-analysis" class="section level3">
<h3>2.4 EEG recording, processing, and analysis</h3>
<pre class="r"><code># Combine EEG data and EEG task information ----------------------------------------------------

# List files of EEG/RT within a folder and get number of participants
  files_eeg = list.files(path = &quot;./data/ERPs&quot;, pattern=&quot;*ind.csv&quot;)
  nfiles = length(files_eeg)

# Get RT/Accuracy data for EEG task (please see Script 2 on how to get this data set)
  EEG_behav = readRDS(&quot;./data/EEG_behav_data.rds&quot;, refhook = NULL)

# Start data concatenation   

for (i in 1:nfiles) {

# Get EEG file per subject
  Subj_Data = read.csv(file=paste(&quot;./data/ERPs/&quot;,files_eeg[i], sep = &quot;&quot;), header=TRUE, sep=&quot;,&quot;)

# EEG table transformations -----------------------------------------------

##### Add ID
  Subj_Data$ID = substr(files_eeg [i],1,2)

##### Re-format single conditions into numbers
  Subj_Data$Condition =as.numeric(as.factor(Subj_Data$Condition))

# Reminder: (p=prime, c=comgruent, ic=incongruent)
  # 1 - p_happy; 2 - p_neutral; 3 - p_angry
  # 4 - c_happy; 5 - c_neutral; 6 - c_angry
  # 7 - ic_happy; 8 - ic_neutral; 9 - ic_angry

##### Add group conditions (prime, congruent, incongruent)

# Create grouping variable
  grouping = data.frame(single=c(1:9),group_pcic=c(rep(1,3),rep(2,3),rep(3,3)),
                        group_pt=c(rep(1,3),rep(2,6)),group_en=c(1,2,1,rep(3,6)))

# group_pcic = prime vs congruent vs incongruent, group_pt = prime vs target, group_en = neutral vs emotional prime

# Match grouping variable with subject data
  Subj_Data$Group_pcic = grouping$group_pcic[match(Subj_Data$Condition,grouping$single,nomatch = NA)]
  Subj_Data$Group_pt = grouping$group_pt[match(Subj_Data$Condition,grouping$single,nomatch = NA)]
  Subj_Data$Group_en = grouping$group_en[match(Subj_Data$Condition,grouping$single,nomatch = NA)]

##### Average ROIs
  Subj_Data$mean_ROI_P1 = rowMeans(subset(Subj_Data,select = c(P1_PO3,P1_PO4,P1_O1,P1_O2,P1_Oz)),
                                   na.rm = TRUE)
  Subj_Data$mean_ROI_N170l = rowMeans(subset(Subj_Data,select = c(N170l_TP7,N170l_CP5,N170l_P7)),
                                   na.rm = TRUE)
  Subj_Data$mean_ROI_N170r = rowMeans(subset(Subj_Data,select = c(N170r_TP8,N170r_CP6,N170r_P8)),
                                   na.rm = TRUE)
  Subj_Data$mean_ROI_P3 = rowMeans(subset(Subj_Data,select = c(P3_PO3,P3_PO4,P3_O1,P3_O2,P3_Oz)),
                                   na.rm = TRUE)

# Match EEG table with behavioral information  ------------------------------------------------

# Function to map values together (RT values and ERP trial values): match ()

# Match RTs
  Subj_Data$RTs = EEG_behav$RTs[match(Subj_Data$RT_Nr,EEG_behav$Trial_EEG,nomatch = NA)]

# Match Responses
  Subj_Data$Response = EEG_behav$Response[match(Subj_Data$RT_Nr,EEG_behav$Trial_EEG,nomatch = NA)]

# Match Blocks
  Subj_Data$Block = EEG_behav$Block[match(Subj_Data$RT_Nr,EEG_behav$Trial_EEG,nomatch = NA)]

# Match RT inclusion / exclusion criteria
  Subj_Data$Exclude_smaller_250ms = EEG_behav$Exclude_smaller_250ms[match(Subj_Data$RT_Nr,
                                                                          EEG_behav$Trial_EEG,nomatch = NA)]
  Subj_Data$Exclude_larger_7s = EEG_behav$Exclude_larger_7s[match(Subj_Data$RT_Nr,
                                                                          EEG_behav$Trial_EEG,nomatch = NA)]
  Subj_Data$Exclude_MAD = EEG_behav$Exclude_MAD[match(Subj_Data$RT_Nr,
                                                                          EEG_behav$Trial_EEG,nomatch = NA)]

# Match randomization / stimulus type
  Subj_Data$EEG_Random = EEG_behav$EEG_Random[match(Subj_Data$RT_Nr,EEG_behav$Trial_EEG,nomatch = NA)]
  Subj_Data$Stim_Type = EEG_behav$Stim_Type[match(Subj_Data$RT_Nr,EEG_behav$Trial_EEG,nomatch = NA)]

# Match age / working memory
  Subj_Data$Age = EEG_behav$Age[match(Subj_Data$ID,EEG_behav$ID,nomatch = NA)]
  Subj_Data$WM = EEG_behav$WM[match(Subj_Data$ID,EEG_behav$ID,nomatch = NA)]

# Combine all subject data ------------------------------------------

  if (i==1) {
    All_Subj = Subj_Data # first round: create all_subj data frame
  } else {
    All_Subj = rbind(All_Subj,Subj_Data) # add to all_subj data frame
  }

  # Clear previous
  remove(Subj_Data)

}

# Remove EEG_Nr &amp; RT_Nr
  All_Subj = subset(All_Subj, select = -c(EEG_Nr,RT_Nr))

# Remove NAs for amplitudes with no clear indication to a block (error during recording of the data)
  All_Subj=All_Subj[complete.cases(All_Subj[ , 28]),]

  sapply(All_Subj,function(x) sum(is.na(x)))


# Trials per emotion condition  ----------------------------------------

# De-select participants 
# 1 = accuracy in EEG task &lt; 50 %
# 5 = ERP components not visible 
  All_Subj = All_Subj[with(All_Subj, !(All_Subj$ID==&quot;01&quot;|All_Subj$ID==&quot;05&quot;)), ] 
  
  All_Subj$Response[All_Subj$Response==1] = &quot;correct&quot;
  All_Subj$Response[All_Subj$Response==0] = &quot;incorrect&quot;

# Only choose primes

  All_Subj_p = subset(All_Subj,Group_pt == 1)
  
  All_Subj_p$Condition[All_Subj_p$Condition==1] = &quot;happy&quot;
  All_Subj_p$Condition[All_Subj_p$Condition==2] = &quot;neutral&quot;
  All_Subj_p$Condition[All_Subj_p$Condition==3] = &quot;angry&quot;
  
# Get trial counts   
  emo_trials=data.frame(xtabs(~ID+Condition,All_Subj_p))

# Calculate mean and SD   
  tr_mean_emo = tapply(emo_trials$Freq,emo_trials$Condition,mean)
  tr_sd_emo = tapply(emo_trials$Freq,emo_trials$Condition,sd)

# Calculate one-way ANOVA to test equality of trial numbers
  emo.aov = aov(Freq ~ Condition, data = emo_trials)

# Extract values to present 
  emo.aov.sum = summary(emo.aov)
  emo.aov.sum = data.frame(emo.aov.sum[[1]])</code></pre>
<pre class="r"><code># Trials per repetition condition -----------------------------------------
  
# Only choose targets
  All_Subj$Response[All_Subj$Response==1] = &quot;correct&quot;
  All_Subj$Response[All_Subj$Response==0] = &quot;incorrect&quot;
  
  All_Subj_t = subset(All_Subj,Group_pt == 2) 
  
  All_Subj_t$Group_pcic[All_Subj_t$Group_pcic==2] = &quot;repeated&quot;
  All_Subj_t$Group_pcic[All_Subj_t$Group_pcic==3] = &quot;novel&quot;

# From these trials: only use correct trials 
  All_Subj_t_corr = subset(All_Subj_t,Response == &quot;correct&quot;) 
  
# Get trial counts
  rep_trials = data.frame(xtabs(~ID+Group_pcic,All_Subj_t_corr))
  
# Calculate mean and SD   
  tr_mean_rep = tapply(rep_trials$Freq,rep_trials$Group_pcic,mean)
  tr_sd_rep = tapply(rep_trials$Freq,rep_trials$Group_pcic,sd)
  
# Paired-samples t-test
  t_test_res = t.test(rep_trials$Freq[rep_trials$Group_pcic==&quot;novel&quot;], rep_trials$Freq[rep_trials$Group_pcic==&quot;repeated&quot;],
         paired = TRUE, alternative = &quot;two.sided&quot;)</code></pre>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
