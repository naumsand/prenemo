<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

    
    
    <title>ERP measures</title>
    <!-- Material Design fonts -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/icon?family=Material+Icons">

        <script src="site_libs/header-attrs-2.7/header-attrs.js"></script>
        <script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="site_libs/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="site_libs/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
        <script src="site_libs/navigation-1.1/tabsets.js"></script>
        <script src="site_libs/navigation-1.1/codefolding.js"></script>
        <link href="site_libs/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
        <script src="site_libs/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
        <link href="site_libs/bootstrap_material-0.1/bootstrap-material-design.min.css" rel="stylesheet" />
        <link href="site_libs/bootstrap_material-0.1/ripples.min.css" rel="stylesheet" />
        <script src="site_libs/bootstrap_material-0.1/material.min.js"></script>
        <script src="site_libs/bootstrap_material-0.1/ripples.min.js"></script>
        <link href="site_libs/material-0.1/material.css" rel="stylesheet" />
        <script src="site_libs/material-0.1/material.js"></script>
        <script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
        <link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
        <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
        <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
    
    
        <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          background-color: #ffffff;
          color: #a0a0a0;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
      div.sourceCode
        { color: #1f1c1b; background-color: #ffffff; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span { color: #1f1c1b; } /* Normal */
      code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
      code span.an { color: #ca60ca; } /* Annotation */
      code span.at { color: #0057ae; } /* Attribute */
      code span.bn { color: #b08000; } /* BaseN */
      code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
      code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #924c9d; } /* Char */
      code span.cn { color: #aa5500; } /* Constant */
      code span.co { color: #898887; } /* Comment */
      code span.cv { color: #0095ff; } /* CommentVar */
      code span.do { color: #607880; } /* Documentation */
      code span.dt { color: #0057ae; } /* DataType */
      code span.dv { color: #b08000; } /* DecVal */
      code span.er { color: #bf0303; text-decoration: underline; } /* Error */
      code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
      code span.fl { color: #b08000; } /* Float */
      code span.fu { color: #644a9b; } /* Function */
      code span.im { color: #ff5500; } /* Import */
      code span.in { color: #b08000; } /* Information */
      code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
      code span.op { color: #1f1c1b; } /* Operator */
      code span.ot { color: #006e28; } /* Other */
      code span.pp { color: #006e28; } /* Preprocessor */
      code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
      code span.sc { color: #3daee9; } /* SpecialChar */
      code span.ss { color: #ff5500; } /* SpecialString */
      code span.st { color: #bf0303; } /* String */
      code span.va { color: #0057ae; } /* Variable */
      code span.vs { color: #bf0303; } /* VerbatimString */
      code span.wa { color: #bf0303; } /* Warning */
    </style>
    
        <link rel="stylesheet" href="web_style.css" type="text/css" />
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
        <script>
      $(document).ready(function () {
	  	  	  window.initializeCodeFolding("hide" === "show");
	        });
    </script>
    
    <!-- code download -->
    

    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .pages .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .pages .tabset-dropdown > .nav-tabs > li.active > a {
	  background-color: transparent !important;
	  color: #000000 !important;
      }
      
      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
	  color: #00A698 !important;
	  font-weight: 300 !important;
	  font-size: 14px;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
      }
    </style>
    
</head>

<body>

  <div class="header-panel shadow z-2">
    <div class="container-fluid">
      <div class="row">
        <div class="col-xs-3">
	  	  <div id="header">
	    <h1 class="title">ERP measures</h1>
	    	    	    	  </div>
	  	</div>
      </div>
    </div>
  </div>
  
  <div class="container-fluid main-container">
    <div class="row">

<nav class="col-xs-3 menu">
<div id="toc">
<ul>
<li><a href="#task-description">Task description</a></li>
<li><a href="#erp-results">ERP results</a></li>
<li><a href="#session-info">Session info</a></li>
</ul>
</div>
</nav>
      
<div class="pages col-xs-9">

        
<div class="row">

<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Naumann et al.</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="glyphicon glyphicon-info-sign"></span>
     
    Data description
  </a>
</li>
<li>
  <a href="R_Script_1_Sample_descr.html">
    <span class="glyphicon glyphicon-user"></span>
     
    Sample description
  </a>
</li>
<li>
  <a href="R_Script_2_EEG_task_measures.html">
    <span class="glyphicon glyphicon-hand-up"></span>
     
    Del. match-to-sample task
  </a>
</li>
<li>
  <a href="R_Script_3_ERP_measures.html">
    <span class="glyphicon glyphicon-flash"></span>
     
    ERP measures
  </a>
</li>
<li>
  <a href="R_Script_4_Emotion_empathy_measures.html">
    <span class="glyphicon glyphicon-link"></span>
     
    Emotion &amp; Empathy measures
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://osf.io/nas48/">
    <span class="ai ai ai ai-osf ai-lg"></span>
     
  </a>
</li>
<li>
  <a href="mailto:sandra.naumann@hu-berlin.de">
    <span class="fas fa-envelope fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<link rel="stylesheet" href="https://cdn.rawgit.com/jpswalsh/academicons/master/css/academicons.min.css">
</div>

    
<div class="row">

<div class="col-xs-10">
<!-- Set up workspace -->
<!-- Load and prepare data set -->
<div id="task-description" class="section level1">
<h1>Task description</h1>
<p>We employed a delayed-match-to-sample-task to examine categorical differences in facial expression processing in young children. In particular, EEG was recorded while preschoolers observed pairs of faces presented sequentially. In some trials, the two sequential facial stimuli (hereafter: ‘Face 1’ and ‘Face 2’) were identical, while in other trials they differed with regards to the facial expression displayed (happy, angry, or neutral).</p>
<p>We calculated linear mixed models (LMM) separately for each ERP component. As fixed factors, all models included treatment contrasts for <em>facial expressions</em> (<code>emotional [average of happy/angry] vs. neutral faces (Emo_Neu)</code>, <code>happy vs. angry faces (Hap_Ang)</code>), <em>repetition</em> (<code>novel vs. repeated emotion trials (Rep_Nov)</code>) as well as their interaction (<code>Emo_NeuxRep_Nov, Hap_AngxRep_Nov</code>). Working memory (<code>WM_scal</code>) was entered as a scaled covariate in all LMM analyses to control for cognitive task demands. Additionally, we entered stimulus contrast (<code>contr_F2_scal</code>) as a scaled covariate to control for low-level differences. The random effects structure included random intercepts for participants (<code>(1|ID)</code>), stimulus (<code>(1|Stim_Type)</code>) and electrodes (<code>(1|Elect_site)</code>). Assumptions for multiple regression were checked for all models (normality of the residuals, linearity, multicollinearity, homoscedasticity).</p>
<p>We predicted that amplitudes would be larger for emotional compared to neutral facial expressions. We expected happy facial expressions to elicit the largest amplitudes, followed by angry and neutral facial expressions. Assuming that comprehensive facial expression representations are in place for young children, we expected an amplitude decrease in response to identical facial expressions. Again, we predicted that happy facial expressions would elicit the largest amplitude reduction compared to angry or neutral expressions because they are the most readily processed.</p>
</div>
<div id="erp-results" class="section level1">
<h1>ERP results</h1>
<p><br></p>
<div id="descriptive-statistics" class="section level3">
<h3><strong>Descriptive statistics</strong></h3>
<p><br><br></p>
<p><em>ERP waveforms and mean amplitudes at Face 2.</em> A) Upper left: Grand-averaged P1 and P3 waveforms for repeated happy (black), angry (dark grey) and neutral (light grey) facial expressions (ROI: PO3, PO4, PO7, PO8, O1, O2, Oz). Upper right: Grand-averaged P1 and P3 waveforms for novel facial expressions. Bottom left: Grand-averaged N170 waveforms for repeated happy, angry and neutral facial expressions (ROI: P7, TP7, CP5, P8, TP8, CP6). Bottom right: Grand-averaged N170 waveforms for novel facial expressions. Shadowed areas indicate the time windows used to identify participants’ individual peaks and mean amplitudes.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="co"># P1/P3</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a>Face2_data_rep =<span class="st"> </span><span class="kw">subset</span>(Face2_data_icc, Condition <span class="op">==</span><span class="st"> &quot;rep_happy&quot;</span> <span class="op">|</span><span class="st"> </span>Condition <span class="op">==</span><span class="st"> &quot;rep_angry&quot;</span> <span class="op">|</span><span class="st"> </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a><span class="st">    </span>Condition <span class="op">==</span><span class="st"> &quot;rep_neutral&quot;</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true"></a>Face2_data_cond =<span class="st"> </span><span class="kw">aggregate</span>(Face2_data_rep<span class="op">$</span>data, <span class="dt">FUN =</span> mean, <span class="dt">by =</span> <span class="kw">list</span>(<span class="dt">time =</span> Face2_data_rep<span class="op">$</span>time, </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true"></a>    <span class="dt">Condition =</span> Face2_data_rep<span class="op">$</span>Condition))</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true"></a>P1_rep =<span class="st"> </span><span class="kw">ggplot</span>(Face2_data_cond, <span class="kw">aes</span>(time, x)) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true"></a>    <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="dv">2</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true"></a>        <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true"></a>        <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>), </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true"></a>    <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">legend.title =</span> <span class="kw">element_blank</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true"></a>    <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="fl">0.8</span>, <span class="kw">aes</span>(<span class="dt">colour =</span> Condition)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#43494e&quot;</span>, </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true"></a>    <span class="st">&quot;#000000&quot;</span>, <span class="st">&quot;#aaadb1&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;P1 &amp; P3&#39;) +</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true"></a><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">Time [ms]&quot;</span>, <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude [&quot;</span>, mu, <span class="st">&quot;V]&quot;</span>)), <span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">18</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">500</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>, </span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true"></a>    <span class="dv">18</span>, <span class="dv">4</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">200</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true"></a>    <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true"></a>    <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="dt">xmin =</span> <span class="dv">90</span>, <span class="dt">xmax =</span> <span class="dv">130</span>, <span class="dt">ymin =</span> <span class="fl">-2.5</span>, <span class="dt">ymax =</span> <span class="fl">18.5</span>, </span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true"></a>    <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="dt">xmin =</span> <span class="dv">300</span>, <span class="dt">xmax =</span> <span class="dv">500</span>, <span class="dt">ymin =</span> <span class="fl">-2.5</span>, <span class="dt">ymax =</span> <span class="fl">18.5</span>, </span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true"></a>    <span class="dt">alpha =</span> <span class="fl">0.3</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true"></a>Face2_data_nov =<span class="st"> </span><span class="kw">subset</span>(Face2_data_icc, Condition <span class="op">==</span><span class="st"> &quot;nov_happy&quot;</span> <span class="op">|</span><span class="st"> </span>Condition <span class="op">==</span><span class="st"> &quot;nov_angry&quot;</span> <span class="op">|</span><span class="st"> </span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true"></a><span class="st">    </span>Condition <span class="op">==</span><span class="st"> &quot;nov_neutral&quot;</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true"></a>Face2_data_cond =<span class="st"> </span><span class="kw">aggregate</span>(Face2_data_nov<span class="op">$</span>data, <span class="dt">FUN =</span> mean, <span class="dt">by =</span> <span class="kw">list</span>(<span class="dt">time =</span> Face2_data_nov<span class="op">$</span>time, </span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true"></a>    <span class="dt">Condition =</span> Face2_data_nov<span class="op">$</span>Condition))</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true"></a>P1_nov =<span class="st"> </span><span class="kw">ggplot</span>(Face2_data_cond, <span class="kw">aes</span>(time, x)) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true"></a>    <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="dv">2</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true"></a>        <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true"></a>        <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>), </span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true"></a>    <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">legend.title =</span> <span class="kw">element_blank</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, </span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true"></a>    <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="fl">0.8</span>, <span class="kw">aes</span>(<span class="dt">colour =</span> Condition)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#43494e&quot;</span>, </span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true"></a>    <span class="st">&quot;#000000&quot;</span>, <span class="st">&quot;#aaadb1&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;P1 &amp; P3&#39;) +</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true"></a><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">Time [ms]&quot;</span>, <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude [&quot;</span>, mu, <span class="st">&quot;V]&quot;</span>)), <span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">18</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">500</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>, </span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true"></a>    <span class="dv">18</span>, <span class="dv">4</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">200</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, </span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true"></a>    <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, </span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true"></a>    <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="dt">xmin =</span> <span class="dv">90</span>, <span class="dt">xmax =</span> <span class="dv">130</span>, <span class="dt">ymin =</span> <span class="fl">-2.5</span>, <span class="dt">ymax =</span> <span class="fl">18.5</span>, </span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true"></a>    <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="dt">xmin =</span> <span class="dv">300</span>, <span class="dt">xmax =</span> <span class="dv">500</span>, <span class="dt">ymin =</span> <span class="fl">-2.5</span>, <span class="dt">ymax =</span> <span class="fl">18.5</span>, </span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true"></a>    <span class="dt">alpha =</span> <span class="fl">0.3</span>)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="co"># N170</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a>Face2_data_rep =<span class="st"> </span><span class="kw">subset</span>(Face2_data_icc_N170, Condition <span class="op">==</span><span class="st"> &quot;rep_happy&quot;</span> <span class="op">|</span><span class="st"> </span>Condition <span class="op">==</span><span class="st"> </span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a><span class="st">    &quot;rep_angry&quot;</span> <span class="op">|</span><span class="st"> </span>Condition <span class="op">==</span><span class="st"> &quot;rep_neutral&quot;</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a>Face2_data_cond =<span class="st"> </span><span class="kw">aggregate</span>(Face2_data_rep<span class="op">$</span>data, <span class="dt">FUN =</span> mean, <span class="dt">by =</span> <span class="kw">list</span>(<span class="dt">time =</span> Face2_data_rep<span class="op">$</span>time, </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true"></a>    <span class="dt">Condition =</span> Face2_data_rep<span class="op">$</span>Condition))</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true"></a>N170_rep =<span class="st"> </span><span class="kw">ggplot</span>(Face2_data_cond, <span class="kw">aes</span>(time, x)) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true"></a>    <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="dv">2</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true"></a>        <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true"></a>        <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>), </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true"></a>    <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">legend.title =</span> <span class="kw">element_blank</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true"></a>    <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="fl">0.8</span>, <span class="kw">aes</span>(<span class="dt">colour =</span> Condition)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#43494e&quot;</span>, </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true"></a>    <span class="st">&quot;#000000&quot;</span>, <span class="st">&quot;#aaadb1&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;N170 &amp; P3&#39;) +</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true"></a><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">Time [ms]&quot;</span>, <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude [&quot;</span>, mu, <span class="st">&quot;V]&quot;</span>)), <span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">6</span>, <span class="dv">4</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">500</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">6</span>, </span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true"></a>    <span class="dv">4</span>, <span class="dv">4</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">200</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, </span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true"></a>    <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true"></a>    <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="dt">xmin =</span> <span class="dv">180</span>, <span class="dt">xmax =</span> <span class="dv">220</span>, <span class="dt">ymin =</span> <span class="dv">-8</span>, <span class="dt">ymax =</span> <span class="dv">6</span>, </span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true"></a>    <span class="dt">alpha =</span> <span class="fl">0.3</span>)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true"></a>Face2_data_nov =<span class="st"> </span><span class="kw">subset</span>(Face2_data_icc_N170, Condition <span class="op">==</span><span class="st"> &quot;nov_happy&quot;</span> <span class="op">|</span><span class="st"> </span>Condition <span class="op">==</span><span class="st"> </span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true"></a><span class="st">    &quot;nov_angry&quot;</span> <span class="op">|</span><span class="st"> </span>Condition <span class="op">==</span><span class="st"> &quot;nov_neutral&quot;</span>)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true"></a>Face2_data_cond =<span class="st"> </span><span class="kw">aggregate</span>(Face2_data_nov<span class="op">$</span>data, <span class="dt">FUN =</span> mean, <span class="dt">by =</span> <span class="kw">list</span>(<span class="dt">time =</span> Face2_data_nov<span class="op">$</span>time, </span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true"></a>    <span class="dt">Condition =</span> Face2_data_nov<span class="op">$</span>Condition))</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true"></a></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true"></a>N170_nov =<span class="st"> </span><span class="kw">ggplot</span>(Face2_data_cond, <span class="kw">aes</span>(time, x)) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true"></a>    <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="dv">2</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true"></a>        <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true"></a>        <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>), </span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true"></a>    <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">legend.title =</span> <span class="kw">element_blank</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, </span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true"></a>    <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="fl">0.8</span>, <span class="kw">aes</span>(<span class="dt">colour =</span> Condition)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#43494e&quot;</span>, </span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true"></a>    <span class="st">&quot;#000000&quot;</span>, <span class="st">&quot;#aaadb1&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;N170 &amp; P3&#39;) +</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true"></a><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">Time [ms]&quot;</span>, <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude [&quot;</span>, mu, <span class="st">&quot;V]&quot;</span>)), <span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">6</span>, <span class="dv">4</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">500</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">6</span>, </span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true"></a>    <span class="dv">4</span>, <span class="dv">4</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">200</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, </span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true"></a>    <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, </span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true"></a>    <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="dt">xmin =</span> <span class="dv">180</span>, <span class="dt">xmax =</span> <span class="dv">220</span>, <span class="dt">ymin =</span> <span class="dv">-8</span>, <span class="dt">ymax =</span> <span class="dv">6</span>, </span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true"></a>    <span class="dt">alpha =</span> <span class="fl">0.3</span>)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="co"># Display plot https://wilkelab.org/cowplot/articles/shared_legends.html</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a>fig_rep_ERPs =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(P1_rep, P1_nov, N170_rep, N170_nov, <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="dv">1</span>, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a>    <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a>fig_rep_ERPs</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/present_ERP_traj-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="co"># Save figure for publication ggsave(&#39;Figure_X_DMTST_P1_P3_N170.tiff&#39;, plot =</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a><span class="co"># last_plot(), dpi = 300)</span></span></code></pre></div>
<p><em>ERP waveforms and mean amplitudes at Face 2.</em> B) Mean P1, N170 and P3 amplitudes and standard deviations separately for each condition.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="co">## Select data</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a>ERPs_sel =<span class="st"> </span><span class="kw">subset</span>(ERP_data, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a><span class="co"># Face 2: P1 repeated happy</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true"></a>ERP_hap_Face2_rep =<span class="st"> </span><span class="kw">subset</span>(ERPs_sel, Condition <span class="op">==</span><span class="st"> </span><span class="dv">4</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true"></a>Av_ERP =<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">tapply</span>(ERP_hap_Face2_rep<span class="op">$</span>mean_ROI_P1, ERP_hap_Face2_rep<span class="op">$</span>ID, mean))</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true"></a><span class="kw">names</span>(Av_ERP)[<span class="dv">1</span>] =<span class="st"> &quot;P1_hap_rep&quot;</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true"></a><span class="co"># Face 2: P1 repeated neutral</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true"></a>ERP_neu_Face2_rep =<span class="st"> </span><span class="kw">subset</span>(ERPs_sel, Condition <span class="op">==</span><span class="st"> </span><span class="dv">5</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true"></a>Av_ERP<span class="op">$</span>P1_neu_rep =<span class="st"> </span><span class="kw">tapply</span>(ERP_neu_Face2_rep<span class="op">$</span>mean_ROI_P1, ERP_neu_Face2_rep<span class="op">$</span>ID, mean)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true"></a><span class="co"># Face 2: P1 repeated angry</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true"></a>ERP_ang_Face2_rep =<span class="st"> </span><span class="kw">subset</span>(ERPs_sel, Condition <span class="op">==</span><span class="st"> </span><span class="dv">6</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true"></a>Av_ERP<span class="op">$</span>P1_ang_rep =<span class="st"> </span><span class="kw">tapply</span>(ERP_ang_Face2_rep<span class="op">$</span>mean_ROI_P1, ERP_ang_Face2_rep<span class="op">$</span>ID, mean)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true"></a><span class="co"># Face 2: P1 novel happy</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true"></a>ERP_hap_Face2_nov =<span class="st"> </span><span class="kw">subset</span>(ERPs_sel, Condition <span class="op">==</span><span class="st"> </span><span class="dv">7</span>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true"></a>Av_ERP<span class="op">$</span>P1_hap_nov =<span class="st"> </span><span class="kw">tapply</span>(ERP_hap_Face2_nov<span class="op">$</span>mean_ROI_P1, ERP_hap_Face2_nov<span class="op">$</span>ID, mean)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true"></a><span class="co"># Face 2: P1 novel neutral</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true"></a>ERP_neu_Face2_nov =<span class="st"> </span><span class="kw">subset</span>(ERPs_sel, Condition <span class="op">==</span><span class="st"> </span><span class="dv">8</span>)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true"></a>Av_ERP<span class="op">$</span>P1_neu_nov =<span class="st"> </span><span class="kw">tapply</span>(ERP_neu_Face2_nov<span class="op">$</span>mean_ROI_P1, ERP_neu_Face2_nov<span class="op">$</span>ID, mean)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true"></a><span class="co"># Face 2: P1 novel angry</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true"></a>ERP_ang_Face2_nov =<span class="st"> </span><span class="kw">subset</span>(ERPs_sel, Condition <span class="op">==</span><span class="st"> </span><span class="dv">9</span>)</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true"></a>Av_ERP<span class="op">$</span>P1_ang_nov =<span class="st"> </span><span class="kw">tapply</span>(ERP_ang_Face2_nov<span class="op">$</span>mean_ROI_P1, ERP_ang_Face2_nov<span class="op">$</span>ID, mean)</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true"></a></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true"></a>Av_ERP =<span class="st"> </span>Av_ERP[<span class="op">-</span><span class="kw">c</span>(<span class="dv">4</span>), ]</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true"></a></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true"></a></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true"></a><span class="co"># Calculate means/SEs</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true"></a>P1_stats =<span class="st"> </span>Av_ERP <span class="op">%&gt;%</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true"></a><span class="st">    </span><span class="kw">summarise_each</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> T), <span class="dt">n =</span> <span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(.)), <span class="dt">se =</span> <span class="kw">sd</span>(., <span class="dt">na.rm =</span> T)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(.)))))</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true"></a></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true"></a><span class="co"># Combine data into one data frame</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true"></a>P1_av =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">emot =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;happy&quot;</span>, <span class="st">&quot;neutral&quot;</span>, <span class="st">&quot;angry&quot;</span>, <span class="st">&quot;happy&quot;</span>, <span class="st">&quot;neutral&quot;</span>, </span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true"></a>    <span class="st">&quot;angry&quot;</span>)), <span class="dt">cond =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;rep&quot;</span>, <span class="st">&quot;rep&quot;</span>, <span class="st">&quot;rep&quot;</span>, <span class="st">&quot;nov&quot;</span>, <span class="st">&quot;nov&quot;</span>, <span class="st">&quot;nov&quot;</span>)), <span class="dt">amp =</span> <span class="kw">c</span>(P1_stats<span class="op">$</span>P1_hap_rep_mean, </span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true"></a>    P1_stats<span class="op">$</span>P1_neu_rep_mean, P1_stats<span class="op">$</span>P1_ang_rep_mean, P1_stats<span class="op">$</span>P1_hap_nov_mean, </span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true"></a>    P1_stats<span class="op">$</span>P1_neu_nov_mean, P1_stats<span class="op">$</span>P1_ang_nov_mean), <span class="dt">se =</span> <span class="kw">c</span>(P1_stats<span class="op">$</span>P1_hap_rep_se, </span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true"></a>    P1_stats<span class="op">$</span>P1_neu_rep_se, P1_stats<span class="op">$</span>P1_ang_rep_se, P1_stats<span class="op">$</span>P1_hap_nov_se, P1_stats<span class="op">$</span>P1_neu_nov_se, </span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true"></a>    P1_stats<span class="op">$</span>P1_ang_nov_se))</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true"></a></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true"></a>nov_col =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;#2FA9F5&quot;</span>, <span class="st">&quot;#134462&quot;</span>)  <span class="co"># order: novel, repeated </span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true"></a></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true"></a>P1_lines =<span class="st"> </span><span class="kw">ggplot</span>(P1_av, <span class="kw">aes</span>(<span class="dt">x =</span> emot, <span class="dt">y =</span> amp, <span class="dt">group =</span> cond, <span class="dt">color =</span> cond)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> amp <span class="op">-</span><span class="st"> </span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true"></a><span class="st">    </span>se, <span class="dt">ymax =</span> amp <span class="op">+</span><span class="st"> </span>se), <span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="fl">0.05</span>), <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(nov_col)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude [&quot;</span>, mu, <span class="st">&quot;V]&quot;</span>)), <span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">10</span>, </span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true"></a>    <span class="dv">25</span>, <span class="dv">5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">25</span>)) <span class="op">+</span><span class="st"> </span>theme_SN <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true"></a>    <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="dv">2</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, </span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true"></a>        <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true"></a>    <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>))</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true"></a></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true"></a></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true"></a><span class="co"># Save figure for publication ggsave(&#39;Figure_X_P1_lines.tiff&#39;, plot =</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true"></a><span class="co"># last_plot(), dpi = 300)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="co">## Select data</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a>ERPs_sel =<span class="st"> </span><span class="kw">subset</span>(ERP_data, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a>ERPs_sel<span class="op">$</span>mean_ROI_N170 =<span class="st"> </span><span class="kw">rowMeans</span>(ERPs_sel[, <span class="kw">c</span>(<span class="dv">26</span>, <span class="dv">27</span>)])</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true"></a><span class="co"># Face 2: N170 repeated happy</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true"></a>ERP_hap_Face2_rep =<span class="st"> </span><span class="kw">subset</span>(ERPs_sel, Condition <span class="op">==</span><span class="st"> </span><span class="dv">4</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true"></a>Av_ERP =<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">tapply</span>(ERP_hap_Face2_rep<span class="op">$</span>mean_ROI_N170, ERP_hap_Face2_rep<span class="op">$</span>ID, </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true"></a>    mean))</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true"></a><span class="kw">names</span>(Av_ERP)[<span class="dv">1</span>] =<span class="st"> &quot;N170_hap_rep&quot;</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true"></a><span class="co"># Face 2: N170 repeated neutral</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true"></a>ERP_neu_Face2_rep =<span class="st"> </span><span class="kw">subset</span>(ERPs_sel, Condition <span class="op">==</span><span class="st"> </span><span class="dv">5</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true"></a>Av_ERP<span class="op">$</span>N170_neu_rep =<span class="st"> </span><span class="kw">tapply</span>(ERP_neu_Face2_rep<span class="op">$</span>mean_ROI_N170, ERP_neu_Face2_rep<span class="op">$</span>ID, </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true"></a>    mean)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true"></a><span class="co"># Face 2: N170 repeated angry</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true"></a>ERP_ang_Face2_rep =<span class="st"> </span><span class="kw">subset</span>(ERPs_sel, Condition <span class="op">==</span><span class="st"> </span><span class="dv">6</span>)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true"></a>Av_ERP<span class="op">$</span>N170_ang_rep =<span class="st"> </span><span class="kw">tapply</span>(ERP_ang_Face2_rep<span class="op">$</span>mean_ROI_N170, ERP_ang_Face2_rep<span class="op">$</span>ID, </span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true"></a>    mean)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true"></a><span class="co"># Face 2: N170 novel happy</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true"></a>ERP_hap_Face2_nov =<span class="st"> </span><span class="kw">subset</span>(ERPs_sel, Condition <span class="op">==</span><span class="st"> </span><span class="dv">7</span>)</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true"></a>Av_ERP<span class="op">$</span>N170_hap_nov =<span class="st"> </span><span class="kw">tapply</span>(ERP_hap_Face2_nov<span class="op">$</span>mean_ROI_N170, ERP_hap_Face2_nov<span class="op">$</span>ID, </span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true"></a>    mean)</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true"></a></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true"></a><span class="co"># Face 2: N170 novel neutral</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true"></a>ERP_neu_Face2_nov =<span class="st"> </span><span class="kw">subset</span>(ERPs_sel, Condition <span class="op">==</span><span class="st"> </span><span class="dv">8</span>)</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true"></a>Av_ERP<span class="op">$</span>N170_neu_nov =<span class="st"> </span><span class="kw">tapply</span>(ERP_neu_Face2_nov<span class="op">$</span>mean_ROI_N170, ERP_neu_Face2_nov<span class="op">$</span>ID, </span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true"></a>    mean)</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true"></a></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true"></a><span class="co"># Face 2: N170 novel angry</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true"></a>ERP_ang_Face2_nov =<span class="st"> </span><span class="kw">subset</span>(ERPs_sel, Condition <span class="op">==</span><span class="st"> </span><span class="dv">9</span>)</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true"></a>Av_ERP<span class="op">$</span>N170_ang_nov =<span class="st"> </span><span class="kw">tapply</span>(ERP_ang_Face2_nov<span class="op">$</span>mean_ROI_N170, ERP_ang_Face2_nov<span class="op">$</span>ID, </span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true"></a>    mean)</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true"></a></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true"></a>Av_ERP =<span class="st"> </span>Av_ERP[<span class="op">-</span><span class="kw">c</span>(<span class="dv">4</span>), ]</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true"></a></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true"></a><span class="co"># Calculate means/SEs</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true"></a>N170_stats =<span class="st"> </span>Av_ERP <span class="op">%&gt;%</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true"></a><span class="st">    </span><span class="kw">summarise_each</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> T), <span class="dt">n =</span> <span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(.)), <span class="dt">se =</span> <span class="kw">sd</span>(., <span class="dt">na.rm =</span> T)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(.)))))</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true"></a></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true"></a><span class="co"># Combine data into one data frame</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true"></a>N170_av =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">emot =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;happy&quot;</span>, <span class="st">&quot;neutral&quot;</span>, <span class="st">&quot;angry&quot;</span>, <span class="st">&quot;happy&quot;</span>, <span class="st">&quot;neutral&quot;</span>, </span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true"></a>    <span class="st">&quot;angry&quot;</span>)), <span class="dt">cond =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;rep&quot;</span>, <span class="st">&quot;rep&quot;</span>, <span class="st">&quot;rep&quot;</span>, <span class="st">&quot;nov&quot;</span>, <span class="st">&quot;nov&quot;</span>, <span class="st">&quot;nov&quot;</span>)), <span class="dt">amp =</span> <span class="kw">c</span>(N170_stats<span class="op">$</span>N170_hap_rep_mean, </span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true"></a>    N170_stats<span class="op">$</span>N170_neu_rep_mean, N170_stats<span class="op">$</span>N170_ang_rep_mean, N170_stats<span class="op">$</span>N170_hap_nov_mean, </span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true"></a>    N170_stats<span class="op">$</span>N170_neu_nov_mean, N170_stats<span class="op">$</span>N170_ang_nov_mean), <span class="dt">se =</span> <span class="kw">c</span>(N170_stats<span class="op">$</span>N170_hap_rep_se, </span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true"></a>    N170_stats<span class="op">$</span>N170_neu_rep_se, N170_stats<span class="op">$</span>N170_ang_rep_se, N170_stats<span class="op">$</span>N170_hap_nov_se, </span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true"></a>    N170_stats<span class="op">$</span>N170_neu_nov_se, N170_stats<span class="op">$</span>N170_ang_nov_se))</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true"></a></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true"></a>nov_col =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;#2FA9F5&quot;</span>, <span class="st">&quot;#134462&quot;</span>)  <span class="co"># order: novel, repeated </span></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true"></a></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true"></a>N170_lines =<span class="st"> </span><span class="kw">ggplot</span>(N170_av, <span class="kw">aes</span>(<span class="dt">x =</span> emot, <span class="dt">y =</span> amp, <span class="dt">group =</span> cond, <span class="dt">color =</span> cond)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> amp <span class="op">-</span><span class="st"> </span>se, <span class="dt">ymax =</span> amp <span class="op">+</span><span class="st"> </span>se), <span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="fl">0.05</span>), </span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true"></a>        <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(nov_col)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude [&quot;</span>, mu, <span class="st">&quot;V]&quot;</span>)), <span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">10</span>, </span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true"></a>    <span class="dv">25</span>, <span class="dv">5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">25</span>)) <span class="op">+</span><span class="st"> </span>theme_SN <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true"></a>    <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="dv">2</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, </span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true"></a>        <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true"></a>    <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>))</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true"></a></span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true"></a></span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true"></a><span class="co"># Save figure for publication ggsave(&#39;Figure_X_N170_lines.tiff&#39;, plot =</span></span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true"></a><span class="co"># last_plot(), dpi = 300)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="co">## Select data</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a>ERPs_sel =<span class="st"> </span><span class="kw">subset</span>(ERP_data, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a><span class="co"># Face 2: P3 repeated happy</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true"></a>ERP_hap_Face2_rep =<span class="st"> </span><span class="kw">subset</span>(ERPs_sel, Condition <span class="op">==</span><span class="st"> </span><span class="dv">4</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true"></a>Av_ERP =<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">tapply</span>(ERP_hap_Face2_rep<span class="op">$</span>mean_ROI_P3, ERP_hap_Face2_rep<span class="op">$</span>ID, mean))</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true"></a><span class="kw">names</span>(Av_ERP)[<span class="dv">1</span>] =<span class="st"> &quot;P3_hap_rep&quot;</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true"></a><span class="co"># Face 2: P3 repeated neutral</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true"></a>ERP_neu_Face2_rep =<span class="st"> </span><span class="kw">subset</span>(ERPs_sel, Condition <span class="op">==</span><span class="st"> </span><span class="dv">5</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true"></a>Av_ERP<span class="op">$</span>P3_neu_rep =<span class="st"> </span><span class="kw">tapply</span>(ERP_neu_Face2_rep<span class="op">$</span>mean_ROI_P3, ERP_neu_Face2_rep<span class="op">$</span>ID, mean)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true"></a><span class="co"># Face 2: P3 repeated angry</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true"></a>ERP_ang_Face2_rep =<span class="st"> </span><span class="kw">subset</span>(ERPs_sel, Condition <span class="op">==</span><span class="st"> </span><span class="dv">6</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true"></a>Av_ERP<span class="op">$</span>P3_ang_rep =<span class="st"> </span><span class="kw">tapply</span>(ERP_ang_Face2_rep<span class="op">$</span>mean_ROI_P3, ERP_ang_Face2_rep<span class="op">$</span>ID, mean)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true"></a><span class="co"># Face 2: P3 novel happy</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true"></a>ERP_hap_Face2_nov =<span class="st"> </span><span class="kw">subset</span>(ERPs_sel, Condition <span class="op">==</span><span class="st"> </span><span class="dv">7</span>)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true"></a>Av_ERP<span class="op">$</span>P3_hap_nov =<span class="st"> </span><span class="kw">tapply</span>(ERP_hap_Face2_nov<span class="op">$</span>mean_ROI_P3, ERP_hap_Face2_nov<span class="op">$</span>ID, mean)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true"></a><span class="co"># Face 2: P3 novel neutral</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true"></a>ERP_neu_Face2_nov =<span class="st"> </span><span class="kw">subset</span>(ERPs_sel, Condition <span class="op">==</span><span class="st"> </span><span class="dv">8</span>)</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true"></a>Av_ERP<span class="op">$</span>P3_neu_nov =<span class="st"> </span><span class="kw">tapply</span>(ERP_neu_Face2_nov<span class="op">$</span>mean_ROI_P3, ERP_neu_Face2_nov<span class="op">$</span>ID, mean)</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true"></a></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true"></a><span class="co"># Face 2: P3 novel angry</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true"></a>ERP_ang_Face2_nov =<span class="st"> </span><span class="kw">subset</span>(ERPs_sel, Condition <span class="op">==</span><span class="st"> </span><span class="dv">9</span>)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true"></a>Av_ERP<span class="op">$</span>P3_ang_nov =<span class="st"> </span><span class="kw">tapply</span>(ERP_ang_Face2_nov<span class="op">$</span>mean_ROI_P3, ERP_ang_Face2_nov<span class="op">$</span>ID, mean)</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true"></a></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true"></a>Av_ERP =<span class="st"> </span>Av_ERP[<span class="op">-</span><span class="kw">c</span>(<span class="dv">4</span>), ]</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true"></a></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true"></a><span class="co"># Calculate means/SEs</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true"></a>P3_stats =<span class="st"> </span>Av_ERP <span class="op">%&gt;%</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true"></a><span class="st">    </span><span class="kw">summarise_each</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> T), <span class="dt">n =</span> <span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(.)), <span class="dt">se =</span> <span class="kw">sd</span>(., <span class="dt">na.rm =</span> T)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(.)))))</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true"></a></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true"></a><span class="co"># Combine data into one data frame</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true"></a>P3_av =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">emot =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;happy&quot;</span>, <span class="st">&quot;neutral&quot;</span>, <span class="st">&quot;angry&quot;</span>, <span class="st">&quot;happy&quot;</span>, <span class="st">&quot;neutral&quot;</span>, </span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true"></a>    <span class="st">&quot;angry&quot;</span>)), <span class="dt">cond =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;rep&quot;</span>, <span class="st">&quot;rep&quot;</span>, <span class="st">&quot;rep&quot;</span>, <span class="st">&quot;nov&quot;</span>, <span class="st">&quot;nov&quot;</span>, <span class="st">&quot;nov&quot;</span>)), <span class="dt">amp =</span> <span class="kw">c</span>(P3_stats<span class="op">$</span>P3_hap_rep_mean, </span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true"></a>    P3_stats<span class="op">$</span>P3_neu_rep_mean, P3_stats<span class="op">$</span>P3_ang_rep_mean, P3_stats<span class="op">$</span>P3_hap_nov_mean, </span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true"></a>    P3_stats<span class="op">$</span>P3_neu_nov_mean, P3_stats<span class="op">$</span>P3_ang_nov_mean), <span class="dt">se =</span> <span class="kw">c</span>(P3_stats<span class="op">$</span>P3_hap_rep_se, </span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true"></a>    P3_stats<span class="op">$</span>P3_neu_rep_se, P3_stats<span class="op">$</span>P3_ang_rep_se, P3_stats<span class="op">$</span>P3_hap_nov_se, P3_stats<span class="op">$</span>P3_neu_nov_se, </span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true"></a>    P3_stats<span class="op">$</span>P3_ang_nov_se))</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true"></a></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true"></a>nov_col =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;#2FA9F5&quot;</span>, <span class="st">&quot;#134462&quot;</span>)  <span class="co"># order: novel, repeated </span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true"></a></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true"></a>P3_lines =<span class="st"> </span><span class="kw">ggplot</span>(P3_av, <span class="kw">aes</span>(<span class="dt">x =</span> emot, <span class="dt">y =</span> amp, <span class="dt">group =</span> cond, <span class="dt">color =</span> cond)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> amp <span class="op">-</span><span class="st"> </span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true"></a><span class="st">    </span>se, <span class="dt">ymax =</span> amp <span class="op">+</span><span class="st"> </span>se), <span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="fl">0.05</span>), <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(nov_col)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude [&quot;</span>, mu, <span class="st">&quot;V]&quot;</span>)), <span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">10</span>, </span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true"></a>    <span class="dv">25</span>, <span class="dv">5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">25</span>)) <span class="op">+</span><span class="st"> </span>theme_SN <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true"></a>    <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="dv">2</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, </span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true"></a>        <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true"></a>    <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>))</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true"></a></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true"></a></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true"></a><span class="co"># Save figure for publication ggsave(&#39;Figure_X_P3_lines.tiff&#39;, plot =</span></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true"></a><span class="co"># last_plot(), dpi = 300)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="co"># Display plot https://wilkelab.org/cowplot/articles/shared_legends.html</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a>fig_rep_lines =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(P1_lines, N170_lines, P3_lines, <span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="dv">1</span>, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a>    <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true"></a>fig_rep_lines</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/present_ERP_lines-1.png" width="576" style="display: block; margin: auto;" /></p>
<p><br><br></p>
<hr />
<p><em>Topographies at Face 2.</em> Topographies of the averaged P1 (90-130 ms), N170 (180-220 ms) and P3 (300-500 ms) activity displaying scalp topographies (left to right: happy, angry, neutral) and difference (left to right: hap-neu, ang-neu, hap-ang) topographies (in µV) for the emotion condition.</p>
<p><em>P1</em></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="co"># Get topographies</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a>Topo_Cat =<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file =</span> <span class="st">&quot;./data/ERPs_Topo_Face2.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true"></a><span class="co"># Remove participant 5</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true"></a>Topo_Cat =<span class="st"> </span>Topo_Cat[<span class="kw">with</span>(Topo_Cat, <span class="op">!</span>(Topo_Cat<span class="op">$</span>ID <span class="op">==</span><span class="st"> </span><span class="dv">5</span>)), ]</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true"></a><span class="co"># Re-name to fit topoplot function</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true"></a><span class="kw">names</span>(Topo_Cat)[<span class="kw">names</span>(Topo_Cat) <span class="op">==</span><span class="st"> &quot;Time&quot;</span>] =<span class="st"> &quot;time&quot;</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true"></a>Topo_Cat<span class="op">$</span>A1 =<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true"></a>Topo_Cat<span class="op">$</span>A2 =<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true"></a><span class="co"># Plot topoplots for repeated / novel emotion trials</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true"></a>Topo_hap =<span class="st"> </span><span class="kw">subset</span>(Topo_Cat, Condition <span class="op">==</span><span class="st"> </span><span class="dv">4</span> <span class="op">|</span><span class="st"> </span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">7</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true"></a>Topo_neu =<span class="st"> </span><span class="kw">subset</span>(Topo_Cat, Condition <span class="op">==</span><span class="st"> </span><span class="dv">5</span> <span class="op">|</span><span class="st"> </span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">8</span>)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true"></a>Topo_ang =<span class="st"> </span><span class="kw">subset</span>(Topo_Cat, Condition <span class="op">==</span><span class="st"> </span><span class="dv">6</span> <span class="op">|</span><span class="st"> </span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">9</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true"></a><span class="co">### Difference scores</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true"></a>av_hap_ID =<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">cbind</span>(Fp1, Fp2, AF3, AF4, Fz, F3, F4, F7, F8, FC5, FC6, FT7, </span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true"></a>    FT8, Cz, FC1, FC2, C3, C4, T7, T8, CP1, CP2, CP5, CP6, TP7, TP8, Pz, P3, P4, </span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true"></a>    P7, P8, PO9, PO10, PO3, PO4, PO7, PO8, O1, O2, Oz) <span class="op">~</span><span class="st"> </span>ID <span class="op">+</span><span class="st"> </span>time, <span class="dt">data =</span> Topo_hap, </span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true"></a>    mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true"></a></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true"></a>av_hap_grand =<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">cbind</span>(Fp1, Fp2, AF3, AF4, Fz, F3, F4, F7, F8, FC5, FC6, </span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true"></a>    FT7, FT8, Cz, FC1, FC2, C3, C4, T7, T8, CP1, CP2, CP5, CP6, TP7, TP8, Pz, P3, </span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true"></a>    P4, P7, P8, PO9, PO10, PO3, PO4, PO7, PO8, O1, O2, Oz) <span class="op">~</span><span class="st"> </span>time, <span class="dt">data =</span> av_hap_ID, </span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true"></a>    mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true"></a></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true"></a>av_neu_ID =<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">cbind</span>(Fp1, Fp2, AF3, AF4, Fz, F3, F4, F7, F8, FC5, FC6, FT7, </span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true"></a>    FT8, Cz, FC1, FC2, C3, C4, T7, T8, CP1, CP2, CP5, CP6, TP7, TP8, Pz, P3, P4, </span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true"></a>    P7, P8, PO9, PO10, PO3, PO4, PO7, PO8, O1, O2, Oz) <span class="op">~</span><span class="st"> </span>ID <span class="op">+</span><span class="st"> </span>time, <span class="dt">data =</span> Topo_neu, </span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true"></a>    mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true"></a></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true"></a>av_neu_grand =<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">cbind</span>(Fp1, Fp2, AF3, AF4, Fz, F3, F4, F7, F8, FC5, FC6, </span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true"></a>    FT7, FT8, Cz, FC1, FC2, C3, C4, T7, T8, CP1, CP2, CP5, CP6, TP7, TP8, Pz, P3, </span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true"></a>    P4, P7, P8, PO9, PO10, PO3, PO4, PO7, PO8, O1, O2, Oz) <span class="op">~</span><span class="st"> </span>time, <span class="dt">data =</span> av_neu_ID, </span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true"></a>    mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true"></a></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true"></a></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true"></a>av_ang_ID =<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">cbind</span>(Fp1, Fp2, AF3, AF4, Fz, F3, F4, F7, F8, FC5, FC6, FT7, </span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true"></a>    FT8, Cz, FC1, FC2, C3, C4, T7, T8, CP1, CP2, CP5, CP6, TP7, TP8, Pz, P3, P4, </span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true"></a>    P7, P8, PO9, PO10, PO3, PO4, PO7, PO8, O1, O2, Oz) <span class="op">~</span><span class="st"> </span>ID <span class="op">+</span><span class="st"> </span>time, <span class="dt">data =</span> Topo_ang, </span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true"></a>    mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true"></a></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true"></a>av_ang_grand =<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">cbind</span>(Fp1, Fp2, AF3, AF4, Fz, F3, F4, F7, F8, FC5, FC6, </span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true"></a>    FT7, FT8, Cz, FC1, FC2, C3, C4, T7, T8, CP1, CP2, CP5, CP6, TP7, TP8, Pz, P3, </span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true"></a>    P4, P7, P8, PO9, PO10, PO3, PO4, PO7, PO8, O1, O2, Oz) <span class="op">~</span><span class="st"> </span>time, <span class="dt">data =</span> av_ang_ID, </span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true"></a>    mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true"></a></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true"></a><span class="co"># Change from wide to long format for electrodes</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true"></a>Topo_hap =<span class="st"> </span><span class="kw">gather</span>(Topo_hap, electrode, amplitude, Fp1<span class="op">:</span>Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true"></a>Topo_neu =<span class="st"> </span><span class="kw">gather</span>(Topo_neu, electrode, amplitude, Fp1<span class="op">:</span>Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true"></a>Topo_ang =<span class="st"> </span><span class="kw">gather</span>(Topo_ang, electrode, amplitude, Fp1<span class="op">:</span>Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true"></a>av_hap_grand =<span class="st"> </span><span class="kw">gather</span>(av_hap_grand, electrode, amplitude, Fp1<span class="op">:</span>Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true"></a>av_neu_grand =<span class="st"> </span><span class="kw">gather</span>(av_neu_grand, electrode, amplitude, Fp1<span class="op">:</span>Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true"></a>av_ang_grand =<span class="st"> </span><span class="kw">gather</span>(av_ang_grand, electrode, amplitude, Fp1<span class="op">:</span>Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true"></a></span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true"></a><span class="co"># Calculate difference scores</span></span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true"></a>Topo_hap_neu =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">time =</span> av_hap_grand[, <span class="dv">1</span>], <span class="dt">electrode =</span> av_hap_grand[, <span class="dv">2</span>], </span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true"></a>    <span class="dt">amplitude =</span> av_hap_grand<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span>av_neu_grand<span class="op">$</span>amplitude)</span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true"></a>Topo_ang_neu =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">time =</span> av_ang_grand[, <span class="dv">1</span>], <span class="dt">electrode =</span> av_ang_grand[, <span class="dv">2</span>], </span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true"></a>    <span class="dt">amplitude =</span> av_ang_grand<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span>av_neu_grand<span class="op">$</span>amplitude)</span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true"></a>Topo_hap_ang =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">time =</span> av_hap_grand[, <span class="dv">1</span>], <span class="dt">electrode =</span> av_hap_grand[, <span class="dv">2</span>], </span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true"></a>    <span class="dt">amplitude =</span> av_hap_grand<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span>av_ang_grand<span class="op">$</span>amplitude)</span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true"></a></span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true"></a><span class="co">## P1</span></span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true"></a></span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true"></a><span class="co"># Select time windows</span></span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true"></a>Topo_hap_P1 =<span class="st"> </span><span class="kw">subset</span>(Topo_hap, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">90</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">130</span>)</span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true"></a>Topo_neu_P1 =<span class="st"> </span><span class="kw">subset</span>(Topo_neu, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">90</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">130</span>)</span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true"></a>Topo_ang_P1 =<span class="st"> </span><span class="kw">subset</span>(Topo_ang, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">90</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">130</span>)</span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true"></a>Topo_hap_neu_P1 =<span class="st"> </span><span class="kw">subset</span>(Topo_hap_neu, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">90</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">130</span>)</span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true"></a>Topo_ang_neu_P1 =<span class="st"> </span><span class="kw">subset</span>(Topo_ang_neu, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">90</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">130</span>)</span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true"></a>Topo_hap_ang_P1 =<span class="st"> </span><span class="kw">subset</span>(Topo_hap_ang, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">90</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">130</span>)</span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true"></a></span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true"></a><span class="co"># Add electrode information</span></span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true"></a>Topo_hap_P1 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_hap_P1, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, <span class="dt">drop =</span> <span class="ot">FALSE</span>, </span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true"></a>    <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true"></a>Topo_neu_P1 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_neu_P1, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, <span class="dt">drop =</span> <span class="ot">FALSE</span>, </span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true"></a>    <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true"></a>Topo_ang_P1 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_ang_P1, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, <span class="dt">drop =</span> <span class="ot">FALSE</span>, </span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true"></a>    <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true"></a>Topo_hap_neu_P1 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_hap_neu_P1, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, <span class="dt">drop =</span> <span class="ot">FALSE</span>, </span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true"></a>    <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true"></a>Topo_ang_neu_P1 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_ang_neu_P1, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, <span class="dt">drop =</span> <span class="ot">FALSE</span>, </span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true"></a>    <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true"></a>Topo_hap_ang_P1 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_hap_ang_P1, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, <span class="dt">drop =</span> <span class="ot">FALSE</span>, </span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true"></a>    <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true"></a></span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true"></a><span class="co"># Create topographies</span></span>
<span id="cb9-91"><a href="#cb9-91" aria-hidden="true"></a>hap_P1_topo =<span class="st"> </span><span class="kw">ggplot</span>(Topo_hap_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb9-92"><a href="#cb9-92" aria-hidden="true"></a><span class="st">    </span><span class="co"># ggtitle(&#39;happy&#39;)+</span></span>
<span id="cb9-93"><a href="#cb9-93" aria-hidden="true"></a><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>, </span>
<span id="cb9-94"><a href="#cb9-94" aria-hidden="true"></a>    <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">24</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb9-95"><a href="#cb9-95" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, </span>
<span id="cb9-96"><a href="#cb9-96" aria-hidden="true"></a>    <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
<span id="cb9-97"><a href="#cb9-97" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb9-98"><a href="#cb9-98" aria-hidden="true"></a></span>
<span id="cb9-99"><a href="#cb9-99" aria-hidden="true"></a><span class="co"># Create topographies</span></span>
<span id="cb9-100"><a href="#cb9-100" aria-hidden="true"></a>ang_P1_topo =<span class="st"> </span><span class="kw">ggplot</span>(Topo_ang_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb9-101"><a href="#cb9-101" aria-hidden="true"></a><span class="st">    </span><span class="co"># ggtitle(&#39;angry&#39;)+</span></span>
<span id="cb9-102"><a href="#cb9-102" aria-hidden="true"></a><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>, </span>
<span id="cb9-103"><a href="#cb9-103" aria-hidden="true"></a>    <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">24</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb9-104"><a href="#cb9-104" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, </span>
<span id="cb9-105"><a href="#cb9-105" aria-hidden="true"></a>    <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
<span id="cb9-106"><a href="#cb9-106" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb9-107"><a href="#cb9-107" aria-hidden="true"></a></span>
<span id="cb9-108"><a href="#cb9-108" aria-hidden="true"></a><span class="co"># Create topographies</span></span>
<span id="cb9-109"><a href="#cb9-109" aria-hidden="true"></a>neu_P1_topo =<span class="st"> </span><span class="kw">ggplot</span>(Topo_neu_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb9-110"><a href="#cb9-110" aria-hidden="true"></a><span class="st">    </span><span class="co"># ggtitle(&#39;neutral&#39;)+</span></span>
<span id="cb9-111"><a href="#cb9-111" aria-hidden="true"></a><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>, </span>
<span id="cb9-112"><a href="#cb9-112" aria-hidden="true"></a>    <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">24</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb9-113"><a href="#cb9-113" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, </span>
<span id="cb9-114"><a href="#cb9-114" aria-hidden="true"></a>    <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
<span id="cb9-115"><a href="#cb9-115" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb9-116"><a href="#cb9-116" aria-hidden="true"></a></span>
<span id="cb9-117"><a href="#cb9-117" aria-hidden="true"></a><span class="co"># Create topographies</span></span>
<span id="cb9-118"><a href="#cb9-118" aria-hidden="true"></a>hap_neu_P1_topo =<span class="st"> </span><span class="kw">ggplot</span>(Topo_hap_neu_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb9-119"><a href="#cb9-119" aria-hidden="true"></a><span class="st">    </span><span class="co"># ggtitle(&#39;neutral&#39;)+</span></span>
<span id="cb9-120"><a href="#cb9-120" aria-hidden="true"></a><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>, </span>
<span id="cb9-121"><a href="#cb9-121" aria-hidden="true"></a>    <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">2.5</span>, <span class="fl">1.8</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb9-122"><a href="#cb9-122" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, </span>
<span id="cb9-123"><a href="#cb9-123" aria-hidden="true"></a>    <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
<span id="cb9-124"><a href="#cb9-124" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb9-125"><a href="#cb9-125" aria-hidden="true"></a></span>
<span id="cb9-126"><a href="#cb9-126" aria-hidden="true"></a><span class="co"># Create topographies</span></span>
<span id="cb9-127"><a href="#cb9-127" aria-hidden="true"></a>ang_neu_P1_topo =<span class="st"> </span><span class="kw">ggplot</span>(Topo_ang_neu_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb9-128"><a href="#cb9-128" aria-hidden="true"></a><span class="st">    </span><span class="co"># ggtitle(&#39;neutral&#39;)+</span></span>
<span id="cb9-129"><a href="#cb9-129" aria-hidden="true"></a><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>, </span>
<span id="cb9-130"><a href="#cb9-130" aria-hidden="true"></a>    <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">2.5</span>, <span class="fl">1.8</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb9-131"><a href="#cb9-131" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, </span>
<span id="cb9-132"><a href="#cb9-132" aria-hidden="true"></a>    <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
<span id="cb9-133"><a href="#cb9-133" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb9-134"><a href="#cb9-134" aria-hidden="true"></a></span>
<span id="cb9-135"><a href="#cb9-135" aria-hidden="true"></a><span class="co"># Create topographies</span></span>
<span id="cb9-136"><a href="#cb9-136" aria-hidden="true"></a>hap_ang_P1_topo =<span class="st"> </span><span class="kw">ggplot</span>(Topo_hap_ang_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb9-137"><a href="#cb9-137" aria-hidden="true"></a><span class="st">    </span><span class="co"># ggtitle(&#39;neutral&#39;)+</span></span>
<span id="cb9-138"><a href="#cb9-138" aria-hidden="true"></a><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>, </span>
<span id="cb9-139"><a href="#cb9-139" aria-hidden="true"></a>    <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">2.5</span>, <span class="fl">1.8</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb9-140"><a href="#cb9-140" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, </span>
<span id="cb9-141"><a href="#cb9-141" aria-hidden="true"></a>    <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
<span id="cb9-142"><a href="#cb9-142" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb9-143"><a href="#cb9-143" aria-hidden="true"></a></span>
<span id="cb9-144"><a href="#cb9-144" aria-hidden="true"></a><span class="co"># Plot plots</span></span>
<span id="cb9-145"><a href="#cb9-145" aria-hidden="true"></a>plots_P1_emo_<span class="dv">1</span> =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(hap_P1_topo, ang_P1_topo, neu_P1_topo, <span class="dt">align =</span> <span class="st">&quot;vh&quot;</span>, </span>
<span id="cb9-146"><a href="#cb9-146" aria-hidden="true"></a>    <span class="dt">hjust =</span> <span class="dv">-1</span>, <span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb9-147"><a href="#cb9-147" aria-hidden="true"></a></span>
<span id="cb9-148"><a href="#cb9-148" aria-hidden="true"></a><span class="co"># ggsave(&#39;plots_P1_emo_1.tiff&#39;, plots_P1_emo_1, bg = &#39;transparent&#39;)</span></span>
<span id="cb9-149"><a href="#cb9-149" aria-hidden="true"></a></span>
<span id="cb9-150"><a href="#cb9-150" aria-hidden="true"></a>plots_P1_emo_<span class="dv">2</span> =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(hap_neu_P1_topo, ang_neu_P1_topo, hap_ang_P1_topo, </span>
<span id="cb9-151"><a href="#cb9-151" aria-hidden="true"></a>    <span class="dt">align =</span> <span class="st">&quot;vh&quot;</span>, <span class="dt">hjust =</span> <span class="dv">-1</span>, <span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb9-152"><a href="#cb9-152" aria-hidden="true"></a></span>
<span id="cb9-153"><a href="#cb9-153" aria-hidden="true"></a><span class="co"># ggsave(&#39;plots_P1_emo_2.tiff&#39;, plots_P1_emo_2, bg = &#39;transparent&#39;)</span></span>
<span id="cb9-154"><a href="#cb9-154" aria-hidden="true"></a></span>
<span id="cb9-155"><a href="#cb9-155" aria-hidden="true"></a></span>
<span id="cb9-156"><a href="#cb9-156" aria-hidden="true"></a><span class="co"># Get topography legend</span></span>
<span id="cb9-157"><a href="#cb9-157" aria-hidden="true"></a>P1_emo_leg_<span class="dv">1</span> =<span class="st"> </span><span class="kw">ggplot</span>(Topo_neu_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb9-158"><a href="#cb9-158" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>, </span>
<span id="cb9-159"><a href="#cb9-159" aria-hidden="true"></a>        <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, </span>
<span id="cb9-160"><a href="#cb9-160" aria-hidden="true"></a>    <span class="dv">24</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;&quot;</span>, mu, <span class="st">&quot;V&quot;</span>))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb9-161"><a href="#cb9-161" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>), <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">7</span>), </span>
<span id="cb9-162"><a href="#cb9-162" aria-hidden="true"></a>        <span class="dt">legend.key.size =</span> <span class="kw">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>))</span>
<span id="cb9-163"><a href="#cb9-163" aria-hidden="true"></a></span>
<span id="cb9-164"><a href="#cb9-164" aria-hidden="true"></a>topo_leg_P1_emo_<span class="dv">1</span> =<span class="st"> </span><span class="kw">get_legend</span>(P1_emo_leg_<span class="dv">1</span>)</span>
<span id="cb9-165"><a href="#cb9-165" aria-hidden="true"></a></span>
<span id="cb9-166"><a href="#cb9-166" aria-hidden="true"></a><span class="co"># ggsave(&#39;topo_leg_P1_emo_1.tiff&#39;, topo_leg_P1_emo_1, bg = &#39;transparent&#39;)</span></span>
<span id="cb9-167"><a href="#cb9-167" aria-hidden="true"></a></span>
<span id="cb9-168"><a href="#cb9-168" aria-hidden="true"></a><span class="co"># Get topography legend</span></span>
<span id="cb9-169"><a href="#cb9-169" aria-hidden="true"></a>P1_emo_leg_<span class="dv">2</span> =<span class="st"> </span><span class="kw">ggplot</span>(Topo_hap_ang_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb9-170"><a href="#cb9-170" aria-hidden="true"></a><span class="st">    </span><span class="co"># ggtitle(&#39;neutral&#39;)+</span></span>
<span id="cb9-171"><a href="#cb9-171" aria-hidden="true"></a><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>, </span>
<span id="cb9-172"><a href="#cb9-172" aria-hidden="true"></a>    <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">2.5</span>, <span class="fl">1.8</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb9-173"><a href="#cb9-173" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;&quot;</span>, mu, <span class="st">&quot;V&quot;</span>))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb9-174"><a href="#cb9-174" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>), <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">7</span>), </span>
<span id="cb9-175"><a href="#cb9-175" aria-hidden="true"></a>        <span class="dt">legend.key.size =</span> <span class="kw">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>))</span>
<span id="cb9-176"><a href="#cb9-176" aria-hidden="true"></a></span>
<span id="cb9-177"><a href="#cb9-177" aria-hidden="true"></a>topo_leg_P1_emo_<span class="dv">2</span> =<span class="st"> </span><span class="kw">get_legend</span>(P1_emo_leg_<span class="dv">2</span>)</span>
<span id="cb9-178"><a href="#cb9-178" aria-hidden="true"></a></span>
<span id="cb9-179"><a href="#cb9-179" aria-hidden="true"></a><span class="co"># ggsave(&#39;topo_leg_P1_emo_2.tiff&#39;, topo_leg_P1_emo_2, bg = &#39;transparent&#39;)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a>topo_P1 =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(plots_P1_emo_<span class="dv">1</span>, topo_leg_P1_emo_<span class="dv">1</span>, plots_P1_emo_<span class="dv">2</span>, topo_leg_P1_emo_<span class="dv">2</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true"></a>topo_P1</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/present_P1-1.png" width="576" style="display: block; margin: auto;" /></p>
<p><em>N170</em></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a><span class="co"># Get topographies</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a>Topo_Cat =<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file =</span> <span class="st">&quot;./data/ERPs_Topo_Face2.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true"></a><span class="co"># Remove participant 5</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true"></a>Topo_Cat =<span class="st"> </span>Topo_Cat[<span class="kw">with</span>(Topo_Cat, <span class="op">!</span>(Topo_Cat<span class="op">$</span>ID <span class="op">==</span><span class="st"> </span><span class="dv">5</span>)), ]</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true"></a><span class="co"># Re-name to fit topoplot function</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true"></a><span class="kw">names</span>(Topo_Cat)[<span class="kw">names</span>(Topo_Cat) <span class="op">==</span><span class="st"> &quot;Time&quot;</span>] =<span class="st"> &quot;time&quot;</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true"></a>Topo_Cat<span class="op">$</span>A1 =<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true"></a>Topo_Cat<span class="op">$</span>A2 =<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true"></a><span class="co"># Plot topoplots for repeated / novel emotion trials</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true"></a>Topo_hap =<span class="st"> </span><span class="kw">subset</span>(Topo_Cat, Condition <span class="op">==</span><span class="st"> </span><span class="dv">4</span> <span class="op">|</span><span class="st"> </span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">7</span>)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true"></a>Topo_neu =<span class="st"> </span><span class="kw">subset</span>(Topo_Cat, Condition <span class="op">==</span><span class="st"> </span><span class="dv">5</span> <span class="op">|</span><span class="st"> </span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">8</span>)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true"></a>Topo_ang =<span class="st"> </span><span class="kw">subset</span>(Topo_Cat, Condition <span class="op">==</span><span class="st"> </span><span class="dv">6</span> <span class="op">|</span><span class="st"> </span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">9</span>)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true"></a><span class="co">### Difference scores</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true"></a>av_hap_ID =<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">cbind</span>(Fp1, Fp2, AF3, AF4, Fz, F3, F4, F7, F8, FC5, FC6, FT7, </span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true"></a>    FT8, Cz, FC1, FC2, C3, C4, T7, T8, CP1, CP2, CP5, CP6, TP7, TP8, Pz, P3, P4, </span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true"></a>    P7, P8, PO9, PO10, PO3, PO4, PO7, PO8, O1, O2, Oz) <span class="op">~</span><span class="st"> </span>ID <span class="op">+</span><span class="st"> </span>time, <span class="dt">data =</span> Topo_hap, </span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true"></a>    mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true"></a></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true"></a>av_hap_grand =<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">cbind</span>(Fp1, Fp2, AF3, AF4, Fz, F3, F4, F7, F8, FC5, FC6, </span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true"></a>    FT7, FT8, Cz, FC1, FC2, C3, C4, T7, T8, CP1, CP2, CP5, CP6, TP7, TP8, Pz, P3, </span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true"></a>    P4, P7, P8, PO9, PO10, PO3, PO4, PO7, PO8, O1, O2, Oz) <span class="op">~</span><span class="st"> </span>time, <span class="dt">data =</span> av_hap_ID, </span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true"></a>    mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true"></a></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true"></a>av_neu_ID =<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">cbind</span>(Fp1, Fp2, AF3, AF4, Fz, F3, F4, F7, F8, FC5, FC6, FT7, </span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true"></a>    FT8, Cz, FC1, FC2, C3, C4, T7, T8, CP1, CP2, CP5, CP6, TP7, TP8, Pz, P3, P4, </span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true"></a>    P7, P8, PO9, PO10, PO3, PO4, PO7, PO8, O1, O2, Oz) <span class="op">~</span><span class="st"> </span>ID <span class="op">+</span><span class="st"> </span>time, <span class="dt">data =</span> Topo_neu, </span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true"></a>    mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true"></a></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true"></a>av_neu_grand =<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">cbind</span>(Fp1, Fp2, AF3, AF4, Fz, F3, F4, F7, F8, FC5, FC6, </span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true"></a>    FT7, FT8, Cz, FC1, FC2, C3, C4, T7, T8, CP1, CP2, CP5, CP6, TP7, TP8, Pz, P3, </span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true"></a>    P4, P7, P8, PO9, PO10, PO3, PO4, PO7, PO8, O1, O2, Oz) <span class="op">~</span><span class="st"> </span>time, <span class="dt">data =</span> av_neu_ID, </span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true"></a>    mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true"></a></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true"></a></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true"></a>av_ang_ID =<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">cbind</span>(Fp1, Fp2, AF3, AF4, Fz, F3, F4, F7, F8, FC5, FC6, FT7, </span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true"></a>    FT8, Cz, FC1, FC2, C3, C4, T7, T8, CP1, CP2, CP5, CP6, TP7, TP8, Pz, P3, P4, </span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true"></a>    P7, P8, PO9, PO10, PO3, PO4, PO7, PO8, O1, O2, Oz) <span class="op">~</span><span class="st"> </span>ID <span class="op">+</span><span class="st"> </span>time, <span class="dt">data =</span> Topo_ang, </span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true"></a>    mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true"></a></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true"></a>av_ang_grand =<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">cbind</span>(Fp1, Fp2, AF3, AF4, Fz, F3, F4, F7, F8, FC5, FC6, </span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true"></a>    FT7, FT8, Cz, FC1, FC2, C3, C4, T7, T8, CP1, CP2, CP5, CP6, TP7, TP8, Pz, P3, </span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true"></a>    P4, P7, P8, PO9, PO10, PO3, PO4, PO7, PO8, O1, O2, Oz) <span class="op">~</span><span class="st"> </span>time, <span class="dt">data =</span> av_ang_ID, </span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true"></a>    mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true"></a></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true"></a><span class="co"># Change from wide to long format for electrodes</span></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true"></a>Topo_hap =<span class="st"> </span><span class="kw">gather</span>(Topo_hap, electrode, amplitude, Fp1<span class="op">:</span>Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true"></a>Topo_neu =<span class="st"> </span><span class="kw">gather</span>(Topo_neu, electrode, amplitude, Fp1<span class="op">:</span>Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true"></a>Topo_ang =<span class="st"> </span><span class="kw">gather</span>(Topo_ang, electrode, amplitude, Fp1<span class="op">:</span>Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true"></a>av_hap_grand =<span class="st"> </span><span class="kw">gather</span>(av_hap_grand, electrode, amplitude, Fp1<span class="op">:</span>Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true"></a>av_neu_grand =<span class="st"> </span><span class="kw">gather</span>(av_neu_grand, electrode, amplitude, Fp1<span class="op">:</span>Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true"></a>av_ang_grand =<span class="st"> </span><span class="kw">gather</span>(av_ang_grand, electrode, amplitude, Fp1<span class="op">:</span>Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true"></a></span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true"></a><span class="co"># Calculate difference scores</span></span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true"></a>Topo_hap_neu =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">time =</span> av_hap_grand[, <span class="dv">1</span>], <span class="dt">electrode =</span> av_hap_grand[, <span class="dv">2</span>], </span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true"></a>    <span class="dt">amplitude =</span> av_hap_grand<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span>av_neu_grand<span class="op">$</span>amplitude)</span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true"></a>Topo_ang_neu =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">time =</span> av_ang_grand[, <span class="dv">1</span>], <span class="dt">electrode =</span> av_ang_grand[, <span class="dv">2</span>], </span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true"></a>    <span class="dt">amplitude =</span> av_ang_grand<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span>av_neu_grand<span class="op">$</span>amplitude)</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true"></a>Topo_hap_ang =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">time =</span> av_hap_grand[, <span class="dv">1</span>], <span class="dt">electrode =</span> av_hap_grand[, <span class="dv">2</span>], </span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true"></a>    <span class="dt">amplitude =</span> av_hap_grand<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span>av_ang_grand<span class="op">$</span>amplitude)</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true"></a></span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true"></a><span class="co">## P1</span></span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true"></a></span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true"></a><span class="co"># Select time windows</span></span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true"></a>Topo_hap_N170 =<span class="st"> </span><span class="kw">subset</span>(Topo_hap, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">180</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">220</span>)</span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true"></a>Topo_neu_N170 =<span class="st"> </span><span class="kw">subset</span>(Topo_neu, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">180</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">220</span>)</span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true"></a>Topo_ang_N170 =<span class="st"> </span><span class="kw">subset</span>(Topo_ang, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">180</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">220</span>)</span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true"></a>Topo_hap_neu_N170 =<span class="st"> </span><span class="kw">subset</span>(Topo_hap_neu, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">180</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">220</span>)</span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true"></a>Topo_ang_neu_N170 =<span class="st"> </span><span class="kw">subset</span>(Topo_ang_neu, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">180</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">220</span>)</span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true"></a>Topo_hap_ang_N170 =<span class="st"> </span><span class="kw">subset</span>(Topo_hap_ang, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">180</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">220</span>)</span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true"></a></span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true"></a><span class="co"># Add electrode information</span></span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true"></a>Topo_hap_N170 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_hap_N170, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, <span class="dt">drop =</span> <span class="ot">FALSE</span>, </span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true"></a>    <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true"></a>Topo_neu_N170 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_neu_N170, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, <span class="dt">drop =</span> <span class="ot">FALSE</span>, </span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true"></a>    <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true"></a>Topo_ang_N170 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_ang_N170, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, <span class="dt">drop =</span> <span class="ot">FALSE</span>, </span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true"></a>    <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true"></a>Topo_hap_neu_N170 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_hap_neu_N170, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, </span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true"></a>    <span class="dt">drop =</span> <span class="ot">FALSE</span>, <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true"></a>Topo_ang_neu_N170 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_ang_neu_N170, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, </span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true"></a>    <span class="dt">drop =</span> <span class="ot">FALSE</span>, <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true"></a>Topo_hap_ang_N170 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_hap_ang_N170, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, </span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true"></a>    <span class="dt">drop =</span> <span class="ot">FALSE</span>, <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true"></a></span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true"></a><span class="co"># Create topographies</span></span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true"></a>hap_N170_topo =<span class="st"> </span><span class="kw">ggplot</span>(Topo_hap_N170, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true"></a><span class="st">    </span><span class="co"># ggtitle(&#39;happy&#39;)+</span></span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true"></a><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>, </span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true"></a>    <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">7</span>, <span class="dv">8</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, </span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true"></a>    <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true"></a></span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true"></a><span class="co"># Create topographies</span></span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true"></a>ang_N170_topo =<span class="st"> </span><span class="kw">ggplot</span>(Topo_ang_N170, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-101"><a href="#cb11-101" aria-hidden="true"></a><span class="st">    </span><span class="co"># ggtitle(&#39;angry&#39;)+</span></span>
<span id="cb11-102"><a href="#cb11-102" aria-hidden="true"></a><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>, </span>
<span id="cb11-103"><a href="#cb11-103" aria-hidden="true"></a>    <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">7</span>, <span class="dv">8</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-104"><a href="#cb11-104" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, </span>
<span id="cb11-105"><a href="#cb11-105" aria-hidden="true"></a>    <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
<span id="cb11-106"><a href="#cb11-106" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb11-107"><a href="#cb11-107" aria-hidden="true"></a></span>
<span id="cb11-108"><a href="#cb11-108" aria-hidden="true"></a><span class="co"># Create topographies</span></span>
<span id="cb11-109"><a href="#cb11-109" aria-hidden="true"></a>neu_N170_topo =<span class="st"> </span><span class="kw">ggplot</span>(Topo_neu_N170, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-110"><a href="#cb11-110" aria-hidden="true"></a><span class="st">    </span><span class="co"># ggtitle(&#39;neutral&#39;)+</span></span>
<span id="cb11-111"><a href="#cb11-111" aria-hidden="true"></a><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>, </span>
<span id="cb11-112"><a href="#cb11-112" aria-hidden="true"></a>    <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">7</span>, <span class="dv">8</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-113"><a href="#cb11-113" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, </span>
<span id="cb11-114"><a href="#cb11-114" aria-hidden="true"></a>    <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
<span id="cb11-115"><a href="#cb11-115" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb11-116"><a href="#cb11-116" aria-hidden="true"></a></span>
<span id="cb11-117"><a href="#cb11-117" aria-hidden="true"></a><span class="co"># Create topographies</span></span>
<span id="cb11-118"><a href="#cb11-118" aria-hidden="true"></a>hap_neu_N170_topo =<span class="st"> </span><span class="kw">ggplot</span>(Topo_hap_neu_N170, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, </span>
<span id="cb11-119"><a href="#cb11-119" aria-hidden="true"></a>    <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;neutral&#39;)+</span></span>
<span id="cb11-120"><a href="#cb11-120" aria-hidden="true"></a><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>, </span>
<span id="cb11-121"><a href="#cb11-121" aria-hidden="true"></a>    <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-122"><a href="#cb11-122" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, </span>
<span id="cb11-123"><a href="#cb11-123" aria-hidden="true"></a>    <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
<span id="cb11-124"><a href="#cb11-124" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb11-125"><a href="#cb11-125" aria-hidden="true"></a></span>
<span id="cb11-126"><a href="#cb11-126" aria-hidden="true"></a><span class="co"># Create topographies</span></span>
<span id="cb11-127"><a href="#cb11-127" aria-hidden="true"></a>ang_neu_N170_topo =<span class="st"> </span><span class="kw">ggplot</span>(Topo_ang_neu_N170, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, </span>
<span id="cb11-128"><a href="#cb11-128" aria-hidden="true"></a>    <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;neutral&#39;)+</span></span>
<span id="cb11-129"><a href="#cb11-129" aria-hidden="true"></a><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>, </span>
<span id="cb11-130"><a href="#cb11-130" aria-hidden="true"></a>    <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-131"><a href="#cb11-131" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, </span>
<span id="cb11-132"><a href="#cb11-132" aria-hidden="true"></a>    <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
<span id="cb11-133"><a href="#cb11-133" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb11-134"><a href="#cb11-134" aria-hidden="true"></a></span>
<span id="cb11-135"><a href="#cb11-135" aria-hidden="true"></a><span class="co"># Create topographies</span></span>
<span id="cb11-136"><a href="#cb11-136" aria-hidden="true"></a>hap_ang_N170_topo =<span class="st"> </span><span class="kw">ggplot</span>(Topo_hap_ang_N170, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, </span>
<span id="cb11-137"><a href="#cb11-137" aria-hidden="true"></a>    <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;neutral&#39;)+</span></span>
<span id="cb11-138"><a href="#cb11-138" aria-hidden="true"></a><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>, </span>
<span id="cb11-139"><a href="#cb11-139" aria-hidden="true"></a>    <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-140"><a href="#cb11-140" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, </span>
<span id="cb11-141"><a href="#cb11-141" aria-hidden="true"></a>    <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
<span id="cb11-142"><a href="#cb11-142" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb11-143"><a href="#cb11-143" aria-hidden="true"></a></span>
<span id="cb11-144"><a href="#cb11-144" aria-hidden="true"></a><span class="co"># Plot plots</span></span>
<span id="cb11-145"><a href="#cb11-145" aria-hidden="true"></a>plots_N170_emo_<span class="dv">1</span> =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(hap_N170_topo, ang_N170_topo, neu_N170_topo, </span>
<span id="cb11-146"><a href="#cb11-146" aria-hidden="true"></a>    <span class="dt">align =</span> <span class="st">&quot;vh&quot;</span>, <span class="dt">hjust =</span> <span class="dv">-1</span>, <span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb11-147"><a href="#cb11-147" aria-hidden="true"></a></span>
<span id="cb11-148"><a href="#cb11-148" aria-hidden="true"></a><span class="co"># plots_N170_emo_1</span></span>
<span id="cb11-149"><a href="#cb11-149" aria-hidden="true"></a></span>
<span id="cb11-150"><a href="#cb11-150" aria-hidden="true"></a><span class="co"># ggsave(&#39;plots_N170_emo_1.tiff&#39;, plots_N170_emo_1, bg = &#39;transparent&#39;)</span></span>
<span id="cb11-151"><a href="#cb11-151" aria-hidden="true"></a></span>
<span id="cb11-152"><a href="#cb11-152" aria-hidden="true"></a>plots_N170_emo_<span class="dv">2</span> =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(hap_neu_N170_topo, ang_neu_N170_topo, hap_ang_N170_topo, </span>
<span id="cb11-153"><a href="#cb11-153" aria-hidden="true"></a>    <span class="dt">align =</span> <span class="st">&quot;vh&quot;</span>, <span class="dt">hjust =</span> <span class="dv">-1</span>, <span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb11-154"><a href="#cb11-154" aria-hidden="true"></a></span>
<span id="cb11-155"><a href="#cb11-155" aria-hidden="true"></a><span class="co"># ggsave(&#39;plots_N170_emo_2.tiff&#39;, plots_N170_emo_2, bg = &#39;transparent&#39;)</span></span>
<span id="cb11-156"><a href="#cb11-156" aria-hidden="true"></a></span>
<span id="cb11-157"><a href="#cb11-157" aria-hidden="true"></a></span>
<span id="cb11-158"><a href="#cb11-158" aria-hidden="true"></a><span class="co"># Get topography legend</span></span>
<span id="cb11-159"><a href="#cb11-159" aria-hidden="true"></a>N170_emo_leg_<span class="dv">1</span> =<span class="st"> </span><span class="kw">ggplot</span>(Topo_neu_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-160"><a href="#cb11-160" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>, </span>
<span id="cb11-161"><a href="#cb11-161" aria-hidden="true"></a>        <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">7</span>, </span>
<span id="cb11-162"><a href="#cb11-162" aria-hidden="true"></a>    <span class="dv">8</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;&quot;</span>, mu, <span class="st">&quot;V&quot;</span>))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-163"><a href="#cb11-163" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>), <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">7</span>), </span>
<span id="cb11-164"><a href="#cb11-164" aria-hidden="true"></a>        <span class="dt">legend.key.size =</span> <span class="kw">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>))</span>
<span id="cb11-165"><a href="#cb11-165" aria-hidden="true"></a></span>
<span id="cb11-166"><a href="#cb11-166" aria-hidden="true"></a>topo_leg_N170_emo_<span class="dv">1</span> =<span class="st"> </span><span class="kw">get_legend</span>(N170_emo_leg_<span class="dv">1</span>)</span>
<span id="cb11-167"><a href="#cb11-167" aria-hidden="true"></a></span>
<span id="cb11-168"><a href="#cb11-168" aria-hidden="true"></a><span class="co"># ggsave(&#39;topo_leg_N170_emo_1.tiff&#39;, topo_leg_N170_emo_1, bg = &#39;transparent&#39;)</span></span>
<span id="cb11-169"><a href="#cb11-169" aria-hidden="true"></a></span>
<span id="cb11-170"><a href="#cb11-170" aria-hidden="true"></a><span class="co"># Get topography legend</span></span>
<span id="cb11-171"><a href="#cb11-171" aria-hidden="true"></a>N170_emo_leg_<span class="dv">2</span> =<span class="st"> </span><span class="kw">ggplot</span>(Topo_hap_ang_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-172"><a href="#cb11-172" aria-hidden="true"></a><span class="st">    </span><span class="co"># ggtitle(&#39;neutral&#39;)+</span></span>
<span id="cb11-173"><a href="#cb11-173" aria-hidden="true"></a><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>, </span>
<span id="cb11-174"><a href="#cb11-174" aria-hidden="true"></a>    <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-175"><a href="#cb11-175" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;&quot;</span>, mu, <span class="st">&quot;V&quot;</span>))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-176"><a href="#cb11-176" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>), <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">7</span>), </span>
<span id="cb11-177"><a href="#cb11-177" aria-hidden="true"></a>        <span class="dt">legend.key.size =</span> <span class="kw">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>))</span>
<span id="cb11-178"><a href="#cb11-178" aria-hidden="true"></a></span>
<span id="cb11-179"><a href="#cb11-179" aria-hidden="true"></a>topo_leg_N170_emo_<span class="dv">2</span> =<span class="st"> </span><span class="kw">get_legend</span>(N170_emo_leg_<span class="dv">2</span>)</span>
<span id="cb11-180"><a href="#cb11-180" aria-hidden="true"></a></span>
<span id="cb11-181"><a href="#cb11-181" aria-hidden="true"></a><span class="co"># ggsave(&#39;topo_leg_N170_emo_2.tiff&#39;, topo_leg_N170_emo_2, bg = &#39;transparent&#39;)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a>topo_N170 =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(plots_N170_emo_<span class="dv">1</span>, topo_leg_N170_emo_<span class="dv">1</span>, plots_N170_emo_<span class="dv">2</span>, </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true"></a>    topo_leg_N170_emo_<span class="dv">2</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true"></a>topo_N170</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/present_N170-1.png" width="576" style="display: block; margin: auto;" /></p>
<p><em>P3</em></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a><span class="co"># Get topographies</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true"></a>Topo_Cat =<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file =</span> <span class="st">&quot;./data/ERPs_Topo_Face2.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true"></a><span class="co"># Remove participant 5</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true"></a>Topo_Cat =<span class="st"> </span>Topo_Cat[<span class="kw">with</span>(Topo_Cat, <span class="op">!</span>(Topo_Cat<span class="op">$</span>ID <span class="op">==</span><span class="st"> </span><span class="dv">5</span>)), ]</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true"></a><span class="co"># Re-name to fit topoplot function</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true"></a><span class="kw">names</span>(Topo_Cat)[<span class="kw">names</span>(Topo_Cat) <span class="op">==</span><span class="st"> &quot;Time&quot;</span>] =<span class="st"> &quot;time&quot;</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true"></a>Topo_Cat<span class="op">$</span>A1 =<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true"></a>Topo_Cat<span class="op">$</span>A2 =<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true"></a><span class="co"># Plot topoplots for repeated / novel emotion trials</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true"></a>Topo_hap =<span class="st"> </span><span class="kw">subset</span>(Topo_Cat, Condition <span class="op">==</span><span class="st"> </span><span class="dv">4</span> <span class="op">|</span><span class="st"> </span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">7</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true"></a>Topo_neu =<span class="st"> </span><span class="kw">subset</span>(Topo_Cat, Condition <span class="op">==</span><span class="st"> </span><span class="dv">5</span> <span class="op">|</span><span class="st"> </span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">8</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true"></a>Topo_ang =<span class="st"> </span><span class="kw">subset</span>(Topo_Cat, Condition <span class="op">==</span><span class="st"> </span><span class="dv">6</span> <span class="op">|</span><span class="st"> </span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">9</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true"></a><span class="co">### Difference scores</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true"></a>av_hap_ID =<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">cbind</span>(Fp1, Fp2, AF3, AF4, Fz, F3, F4, F7, F8, FC5, FC6, FT7, </span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true"></a>    FT8, Cz, FC1, FC2, C3, C4, T7, T8, CP1, CP2, CP5, CP6, TP7, TP8, Pz, P3, P4, </span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true"></a>    P7, P8, PO9, PO10, PO3, PO4, PO7, PO8, O1, O2, Oz) <span class="op">~</span><span class="st"> </span>ID <span class="op">+</span><span class="st"> </span>time, <span class="dt">data =</span> Topo_hap, </span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true"></a>    mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true"></a></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true"></a>av_hap_grand =<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">cbind</span>(Fp1, Fp2, AF3, AF4, Fz, F3, F4, F7, F8, FC5, FC6, </span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true"></a>    FT7, FT8, Cz, FC1, FC2, C3, C4, T7, T8, CP1, CP2, CP5, CP6, TP7, TP8, Pz, P3, </span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true"></a>    P4, P7, P8, PO9, PO10, PO3, PO4, PO7, PO8, O1, O2, Oz) <span class="op">~</span><span class="st"> </span>time, <span class="dt">data =</span> av_hap_ID, </span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true"></a>    mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true"></a>av_neu_ID =<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">cbind</span>(Fp1, Fp2, AF3, AF4, Fz, F3, F4, F7, F8, FC5, FC6, FT7, </span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true"></a>    FT8, Cz, FC1, FC2, C3, C4, T7, T8, CP1, CP2, CP5, CP6, TP7, TP8, Pz, P3, P4, </span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true"></a>    P7, P8, PO9, PO10, PO3, PO4, PO7, PO8, O1, O2, Oz) <span class="op">~</span><span class="st"> </span>ID <span class="op">+</span><span class="st"> </span>time, <span class="dt">data =</span> Topo_neu, </span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true"></a>    mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true"></a></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true"></a>av_neu_grand =<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">cbind</span>(Fp1, Fp2, AF3, AF4, Fz, F3, F4, F7, F8, FC5, FC6, </span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true"></a>    FT7, FT8, Cz, FC1, FC2, C3, C4, T7, T8, CP1, CP2, CP5, CP6, TP7, TP8, Pz, P3, </span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true"></a>    P4, P7, P8, PO9, PO10, PO3, PO4, PO7, PO8, O1, O2, Oz) <span class="op">~</span><span class="st"> </span>time, <span class="dt">data =</span> av_neu_ID, </span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true"></a>    mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true"></a></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true"></a></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true"></a>av_ang_ID =<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">cbind</span>(Fp1, Fp2, AF3, AF4, Fz, F3, F4, F7, F8, FC5, FC6, FT7, </span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true"></a>    FT8, Cz, FC1, FC2, C3, C4, T7, T8, CP1, CP2, CP5, CP6, TP7, TP8, Pz, P3, P4, </span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true"></a>    P7, P8, PO9, PO10, PO3, PO4, PO7, PO8, O1, O2, Oz) <span class="op">~</span><span class="st"> </span>ID <span class="op">+</span><span class="st"> </span>time, <span class="dt">data =</span> Topo_ang, </span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true"></a>    mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true"></a></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true"></a>av_ang_grand =<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">cbind</span>(Fp1, Fp2, AF3, AF4, Fz, F3, F4, F7, F8, FC5, FC6, </span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true"></a>    FT7, FT8, Cz, FC1, FC2, C3, C4, T7, T8, CP1, CP2, CP5, CP6, TP7, TP8, Pz, P3, </span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true"></a>    P4, P7, P8, PO9, PO10, PO3, PO4, PO7, PO8, O1, O2, Oz) <span class="op">~</span><span class="st"> </span>time, <span class="dt">data =</span> av_ang_ID, </span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true"></a>    mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true"></a></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true"></a><span class="co"># Change from wide to long format for electrodes</span></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true"></a>Topo_hap =<span class="st"> </span><span class="kw">gather</span>(Topo_hap, electrode, amplitude, Fp1<span class="op">:</span>Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true"></a>Topo_neu =<span class="st"> </span><span class="kw">gather</span>(Topo_neu, electrode, amplitude, Fp1<span class="op">:</span>Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true"></a>Topo_ang =<span class="st"> </span><span class="kw">gather</span>(Topo_ang, electrode, amplitude, Fp1<span class="op">:</span>Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true"></a>av_hap_grand =<span class="st"> </span><span class="kw">gather</span>(av_hap_grand, electrode, amplitude, Fp1<span class="op">:</span>Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true"></a>av_neu_grand =<span class="st"> </span><span class="kw">gather</span>(av_neu_grand, electrode, amplitude, Fp1<span class="op">:</span>Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true"></a>av_ang_grand =<span class="st"> </span><span class="kw">gather</span>(av_ang_grand, electrode, amplitude, Fp1<span class="op">:</span>Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true"></a></span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true"></a><span class="co"># Calculate difference scores</span></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true"></a>Topo_hap_neu =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">time =</span> av_hap_grand[, <span class="dv">1</span>], <span class="dt">electrode =</span> av_hap_grand[, <span class="dv">2</span>], </span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true"></a>    <span class="dt">amplitude =</span> av_hap_grand<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span>av_neu_grand<span class="op">$</span>amplitude)</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true"></a>Topo_ang_neu =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">time =</span> av_ang_grand[, <span class="dv">1</span>], <span class="dt">electrode =</span> av_ang_grand[, <span class="dv">2</span>], </span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true"></a>    <span class="dt">amplitude =</span> av_ang_grand<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span>av_neu_grand<span class="op">$</span>amplitude)</span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true"></a>Topo_hap_ang =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">time =</span> av_hap_grand[, <span class="dv">1</span>], <span class="dt">electrode =</span> av_hap_grand[, <span class="dv">2</span>], </span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true"></a>    <span class="dt">amplitude =</span> av_hap_grand<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span>av_ang_grand<span class="op">$</span>amplitude)</span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true"></a></span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true"></a><span class="co">## P1</span></span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true"></a></span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true"></a><span class="co"># Select time windows</span></span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true"></a>Topo_hap_P3 =<span class="st"> </span><span class="kw">subset</span>(Topo_hap, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">300</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">500</span>)</span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true"></a>Topo_neu_P3 =<span class="st"> </span><span class="kw">subset</span>(Topo_neu, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">300</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">500</span>)</span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true"></a>Topo_ang_P3 =<span class="st"> </span><span class="kw">subset</span>(Topo_ang, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">300</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">500</span>)</span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true"></a>Topo_hap_neu_P3 =<span class="st"> </span><span class="kw">subset</span>(Topo_hap_neu, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">300</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">500</span>)</span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true"></a>Topo_ang_neu_P3 =<span class="st"> </span><span class="kw">subset</span>(Topo_ang_neu, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">300</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">500</span>)</span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true"></a>Topo_hap_ang_P3 =<span class="st"> </span><span class="kw">subset</span>(Topo_hap_ang, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">300</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">500</span>)</span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true"></a></span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true"></a><span class="co"># Add electrode information</span></span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true"></a>Topo_hap_P3 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_hap_P3, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, <span class="dt">drop =</span> <span class="ot">FALSE</span>, </span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true"></a>    <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true"></a>Topo_neu_P3 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_neu_P3, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, <span class="dt">drop =</span> <span class="ot">FALSE</span>, </span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true"></a>    <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true"></a>Topo_ang_P3 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_ang_P3, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, <span class="dt">drop =</span> <span class="ot">FALSE</span>, </span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true"></a>    <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true"></a>Topo_hap_neu_P3 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_hap_neu_P3, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, <span class="dt">drop =</span> <span class="ot">FALSE</span>, </span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true"></a>    <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true"></a>Topo_ang_neu_P3 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_ang_neu_P3, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, <span class="dt">drop =</span> <span class="ot">FALSE</span>, </span>
<span id="cb13-86"><a href="#cb13-86" aria-hidden="true"></a>    <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb13-87"><a href="#cb13-87" aria-hidden="true"></a>Topo_hap_ang_P3 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_hap_ang_P3, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, <span class="dt">drop =</span> <span class="ot">FALSE</span>, </span>
<span id="cb13-88"><a href="#cb13-88" aria-hidden="true"></a>    <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb13-89"><a href="#cb13-89" aria-hidden="true"></a></span>
<span id="cb13-90"><a href="#cb13-90" aria-hidden="true"></a><span class="co"># Create topographies</span></span>
<span id="cb13-91"><a href="#cb13-91" aria-hidden="true"></a>hap_P3_topo =<span class="st"> </span><span class="kw">ggplot</span>(Topo_hap_P3, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-92"><a href="#cb13-92" aria-hidden="true"></a><span class="st">    </span><span class="co"># ggtitle(&#39;happy&#39;)+</span></span>
<span id="cb13-93"><a href="#cb13-93" aria-hidden="true"></a><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>, </span>
<span id="cb13-94"><a href="#cb13-94" aria-hidden="true"></a>    <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">11</span>, <span class="dv">17</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-95"><a href="#cb13-95" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, </span>
<span id="cb13-96"><a href="#cb13-96" aria-hidden="true"></a>    <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
<span id="cb13-97"><a href="#cb13-97" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb13-98"><a href="#cb13-98" aria-hidden="true"></a></span>
<span id="cb13-99"><a href="#cb13-99" aria-hidden="true"></a><span class="co"># Create topographies</span></span>
<span id="cb13-100"><a href="#cb13-100" aria-hidden="true"></a>ang_P3_topo =<span class="st"> </span><span class="kw">ggplot</span>(Topo_ang_P3, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-101"><a href="#cb13-101" aria-hidden="true"></a><span class="st">    </span><span class="co"># ggtitle(&#39;angry&#39;)+</span></span>
<span id="cb13-102"><a href="#cb13-102" aria-hidden="true"></a><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>, </span>
<span id="cb13-103"><a href="#cb13-103" aria-hidden="true"></a>    <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">11</span>, <span class="dv">17</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-104"><a href="#cb13-104" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, </span>
<span id="cb13-105"><a href="#cb13-105" aria-hidden="true"></a>    <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
<span id="cb13-106"><a href="#cb13-106" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb13-107"><a href="#cb13-107" aria-hidden="true"></a></span>
<span id="cb13-108"><a href="#cb13-108" aria-hidden="true"></a><span class="co"># Create topographies</span></span>
<span id="cb13-109"><a href="#cb13-109" aria-hidden="true"></a>neu_P3_topo =<span class="st"> </span><span class="kw">ggplot</span>(Topo_neu_P3, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-110"><a href="#cb13-110" aria-hidden="true"></a><span class="st">    </span><span class="co"># ggtitle(&#39;neutral&#39;)+</span></span>
<span id="cb13-111"><a href="#cb13-111" aria-hidden="true"></a><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>, </span>
<span id="cb13-112"><a href="#cb13-112" aria-hidden="true"></a>    <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">11</span>, <span class="dv">17</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-113"><a href="#cb13-113" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, </span>
<span id="cb13-114"><a href="#cb13-114" aria-hidden="true"></a>    <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
<span id="cb13-115"><a href="#cb13-115" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb13-116"><a href="#cb13-116" aria-hidden="true"></a></span>
<span id="cb13-117"><a href="#cb13-117" aria-hidden="true"></a><span class="co"># Create topographies</span></span>
<span id="cb13-118"><a href="#cb13-118" aria-hidden="true"></a>hap_neu_P3_topo =<span class="st"> </span><span class="kw">ggplot</span>(Topo_hap_neu_P3, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-119"><a href="#cb13-119" aria-hidden="true"></a><span class="st">    </span><span class="co"># ggtitle(&#39;neutral&#39;)+</span></span>
<span id="cb13-120"><a href="#cb13-120" aria-hidden="true"></a><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>, </span>
<span id="cb13-121"><a href="#cb13-121" aria-hidden="true"></a>    <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">2.5</span>, <span class="dv">4</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-122"><a href="#cb13-122" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, </span>
<span id="cb13-123"><a href="#cb13-123" aria-hidden="true"></a>    <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
<span id="cb13-124"><a href="#cb13-124" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb13-125"><a href="#cb13-125" aria-hidden="true"></a></span>
<span id="cb13-126"><a href="#cb13-126" aria-hidden="true"></a><span class="co"># Create topographies</span></span>
<span id="cb13-127"><a href="#cb13-127" aria-hidden="true"></a>ang_neu_P3_topo =<span class="st"> </span><span class="kw">ggplot</span>(Topo_ang_neu_P3, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-128"><a href="#cb13-128" aria-hidden="true"></a><span class="st">    </span><span class="co"># ggtitle(&#39;neutral&#39;)+</span></span>
<span id="cb13-129"><a href="#cb13-129" aria-hidden="true"></a><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>, </span>
<span id="cb13-130"><a href="#cb13-130" aria-hidden="true"></a>    <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">2.5</span>, <span class="dv">4</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-131"><a href="#cb13-131" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, </span>
<span id="cb13-132"><a href="#cb13-132" aria-hidden="true"></a>    <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
<span id="cb13-133"><a href="#cb13-133" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb13-134"><a href="#cb13-134" aria-hidden="true"></a></span>
<span id="cb13-135"><a href="#cb13-135" aria-hidden="true"></a><span class="co"># Create topographies</span></span>
<span id="cb13-136"><a href="#cb13-136" aria-hidden="true"></a>hap_ang_P3_topo =<span class="st"> </span><span class="kw">ggplot</span>(Topo_hap_ang_P3, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-137"><a href="#cb13-137" aria-hidden="true"></a><span class="st">    </span><span class="co"># ggtitle(&#39;neutral&#39;)+</span></span>
<span id="cb13-138"><a href="#cb13-138" aria-hidden="true"></a><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>, </span>
<span id="cb13-139"><a href="#cb13-139" aria-hidden="true"></a>    <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">2.5</span>, <span class="dv">4</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-140"><a href="#cb13-140" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, </span>
<span id="cb13-141"><a href="#cb13-141" aria-hidden="true"></a>    <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
<span id="cb13-142"><a href="#cb13-142" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb13-143"><a href="#cb13-143" aria-hidden="true"></a></span>
<span id="cb13-144"><a href="#cb13-144" aria-hidden="true"></a><span class="co"># Plot plots</span></span>
<span id="cb13-145"><a href="#cb13-145" aria-hidden="true"></a>plots_P3_emo_<span class="dv">1</span> =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(hap_P3_topo, ang_P3_topo, neu_P3_topo, <span class="dt">align =</span> <span class="st">&quot;vh&quot;</span>, </span>
<span id="cb13-146"><a href="#cb13-146" aria-hidden="true"></a>    <span class="dt">hjust =</span> <span class="dv">-1</span>, <span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb13-147"><a href="#cb13-147" aria-hidden="true"></a></span>
<span id="cb13-148"><a href="#cb13-148" aria-hidden="true"></a></span>
<span id="cb13-149"><a href="#cb13-149" aria-hidden="true"></a><span class="co"># plots_P3_emo_1</span></span>
<span id="cb13-150"><a href="#cb13-150" aria-hidden="true"></a></span>
<span id="cb13-151"><a href="#cb13-151" aria-hidden="true"></a><span class="co"># ggsave(&#39;plots_P3_emo_1.tiff&#39;, plots_P3_emo_1, bg = &#39;transparent&#39;)</span></span>
<span id="cb13-152"><a href="#cb13-152" aria-hidden="true"></a></span>
<span id="cb13-153"><a href="#cb13-153" aria-hidden="true"></a>plots_P3_emo_<span class="dv">2</span> =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(hap_neu_P3_topo, ang_neu_P3_topo, hap_ang_P3_topo, </span>
<span id="cb13-154"><a href="#cb13-154" aria-hidden="true"></a>    <span class="dt">align =</span> <span class="st">&quot;vh&quot;</span>, <span class="dt">hjust =</span> <span class="dv">-1</span>, <span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb13-155"><a href="#cb13-155" aria-hidden="true"></a></span>
<span id="cb13-156"><a href="#cb13-156" aria-hidden="true"></a><span class="co"># ggsave(&#39;plots_P3_emo_2.tiff&#39;, plots_P3_emo_2, bg = &#39;transparent&#39;)</span></span>
<span id="cb13-157"><a href="#cb13-157" aria-hidden="true"></a></span>
<span id="cb13-158"><a href="#cb13-158" aria-hidden="true"></a></span>
<span id="cb13-159"><a href="#cb13-159" aria-hidden="true"></a><span class="co"># Get topography legend</span></span>
<span id="cb13-160"><a href="#cb13-160" aria-hidden="true"></a>P3_emo_leg_<span class="dv">1</span> =<span class="st"> </span><span class="kw">ggplot</span>(Topo_neu_P3, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-161"><a href="#cb13-161" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>, </span>
<span id="cb13-162"><a href="#cb13-162" aria-hidden="true"></a>        <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">11</span>, </span>
<span id="cb13-163"><a href="#cb13-163" aria-hidden="true"></a>    <span class="dv">17</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;&quot;</span>, mu, <span class="st">&quot;V&quot;</span>))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-164"><a href="#cb13-164" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>), <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">7</span>), </span>
<span id="cb13-165"><a href="#cb13-165" aria-hidden="true"></a>        <span class="dt">legend.key.size =</span> <span class="kw">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>))</span>
<span id="cb13-166"><a href="#cb13-166" aria-hidden="true"></a></span>
<span id="cb13-167"><a href="#cb13-167" aria-hidden="true"></a>topo_leg_P3_emo_<span class="dv">1</span> =<span class="st"> </span><span class="kw">get_legend</span>(P3_emo_leg_<span class="dv">1</span>)</span>
<span id="cb13-168"><a href="#cb13-168" aria-hidden="true"></a></span>
<span id="cb13-169"><a href="#cb13-169" aria-hidden="true"></a><span class="co"># ggsave(&#39;topo_leg_P3_emo_1.tiff&#39;, topo_leg_P3_emo_1, bg = &#39;transparent&#39;)</span></span>
<span id="cb13-170"><a href="#cb13-170" aria-hidden="true"></a></span>
<span id="cb13-171"><a href="#cb13-171" aria-hidden="true"></a><span class="co"># Get topography legend</span></span>
<span id="cb13-172"><a href="#cb13-172" aria-hidden="true"></a>P3_emo_leg_<span class="dv">2</span> =<span class="st"> </span><span class="kw">ggplot</span>(Topo_hap_ang_P3, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-173"><a href="#cb13-173" aria-hidden="true"></a><span class="st">    </span><span class="co"># ggtitle(&#39;neutral&#39;)+</span></span>
<span id="cb13-174"><a href="#cb13-174" aria-hidden="true"></a><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>, </span>
<span id="cb13-175"><a href="#cb13-175" aria-hidden="true"></a>    <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">2.5</span>, <span class="dv">4</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-176"><a href="#cb13-176" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;&quot;</span>, mu, <span class="st">&quot;V&quot;</span>))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-177"><a href="#cb13-177" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>), <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">7</span>), </span>
<span id="cb13-178"><a href="#cb13-178" aria-hidden="true"></a>        <span class="dt">legend.key.size =</span> <span class="kw">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>))</span>
<span id="cb13-179"><a href="#cb13-179" aria-hidden="true"></a></span>
<span id="cb13-180"><a href="#cb13-180" aria-hidden="true"></a>topo_leg_P3_emo_<span class="dv">2</span> =<span class="st"> </span><span class="kw">get_legend</span>(P3_emo_leg_<span class="dv">2</span>)</span>
<span id="cb13-181"><a href="#cb13-181" aria-hidden="true"></a></span>
<span id="cb13-182"><a href="#cb13-182" aria-hidden="true"></a><span class="co"># ggsave(&#39;topo_leg_P3_emo_2.tiff&#39;, topo_leg_P3_emo_2, bg = &#39;transparent&#39;)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a>topo_P3 =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(plots_P3_emo_<span class="dv">1</span>, topo_leg_P3_emo_<span class="dv">1</span>, plots_P3_emo_<span class="dv">2</span>, topo_leg_P3_emo_<span class="dv">2</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true"></a>topo_P3</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/present_P3-1.png" width="576" style="display: block; margin: auto;" /></p>
<!-- For additional topographies -->
</div>
<div id="model-specification" class="section level3 tabset tabset-pills">
<h3 class="tabset tabset-pills"><strong>Model specification</strong></h3>
<div id="lmm-p1-random-effect-structure" class="section level4">
<h4>LMM P1: Random effect structure</h4>
<p><br></p>
<p>The final model was:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a><span class="co"># Select correct responses and outlier-free data</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true"></a>P1_Rep =<span class="st"> </span><span class="kw">subset</span>(ERP_data, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true"></a><span class="co"># Prepare fixed factors</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true"></a>P1_Rep<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(P1_Rep<span class="op">$</span>ID)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(P1_Rep<span class="op">$</span>Stim_Type)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true"></a><span class="co"># Define novel vs repeated trials</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true"></a>P1_Rep<span class="op">$</span>rep[P1_Rep<span class="op">$</span>Group_cic <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;repeated&quot;</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true"></a>P1_Rep<span class="op">$</span>rep[P1_Rep<span class="op">$</span>Group_cic <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;novel&quot;</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true"></a><span class="co"># Rename variables</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true"></a>P1_Rep<span class="op">$</span>PT[P1_Rep<span class="op">$</span>Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;prime&quot;</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true"></a>P1_Rep<span class="op">$</span>PT[P1_Rep<span class="op">$</span>Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;target&quot;</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true"></a><span class="co"># Rename variables P1_Rep$Response[P1_Rep$Response == 0]=&#39;false&#39;</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true"></a><span class="co"># P1_Rep$Response[P1_Rep$Response == 1]=&#39;correct&#39;</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true"></a><span class="co"># Define emotions</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Condition[P1_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Condition[P1_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Condition[P1_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Condition[P1_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">4</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Condition[P1_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">5</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Condition[P1_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">6</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Condition[P1_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">7</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Condition[P1_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">8</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Condition[P1_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">9</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true"></a></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true"></a><span class="co"># Factor and create contrasts</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true"></a>P1_Rep<span class="op">$</span>rep =<span class="st"> </span><span class="kw">factor</span>(P1_Rep<span class="op">$</span>rep)</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true"></a>P1_Rep<span class="op">$</span>PT =<span class="st"> </span><span class="kw">factor</span>(P1_Rep<span class="op">$</span>PT)</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true"></a><span class="co"># P1_Rep$Response = factor(P1_Rep$Response)</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true"></a></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true"></a><span class="kw">contrasts</span>(P1_Rep<span class="op">$</span>rep) =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>)  <span class="co"># intercept is the mean of repeated / novel</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true"></a></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Condition =<span class="st"> </span><span class="kw">factor</span>(P1_Rep<span class="op">$</span>Condition)</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true"></a><span class="kw">contrasts</span>(P1_Rep<span class="op">$</span>Condition) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>, <span class="dt">base =</span> <span class="dv">3</span>)</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true"></a></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true"></a><span class="co"># A = angry, N = neutral, H = happy</span></span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true"></a>HvsA =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">-0.5</span>, <span class="dv">0</span>)  <span class="co"># compare: happy vs. angry</span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true"></a>EvsN =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.25</span>, <span class="fl">-0.25</span>, <span class="fl">0.5</span>)  <span class="co"># compare happy/angry to neutral</span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true"></a><span class="kw">contrasts</span>(P1_Rep<span class="op">$</span>Condition) =<span class="st"> </span><span class="kw">cbind</span>(EvsN, HvsA)</span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true"></a></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true"></a></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true"></a><span class="co"># Bring electrodes in one variable P1_Rep = gather(P1_Rep, Elect_site,</span></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true"></a><span class="co"># P1_Amplitude, P1_PO3:P1_Oz, factor_key = TRUE)</span></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true"></a>P1_Rep =<span class="st"> </span><span class="kw">gather</span>(P1_Rep, Elect_site, P1_Amplitude, P1_PO7<span class="op">:</span>P1_Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true"></a></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Elect_site =<span class="st"> </span><span class="kw">factor</span>(P1_Rep<span class="op">$</span>Elect_site)</span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true"></a>P1_Rep =<span class="st"> </span><span class="kw">subset</span>(P1_Rep, PT <span class="op">==</span><span class="st"> &quot;target&quot;</span>)</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true"></a></span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true"></a><span class="co"># Build full model</span></span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true"></a>mod_P1_Rep.lmer =<span class="st"> </span><span class="kw">lmer</span>(P1_Amplitude <span class="op">~</span><span class="st"> </span>Condition <span class="op">*</span><span class="st"> </span>rep <span class="op">+</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span></span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true"></a><span class="st">    </span><span class="op">+</span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Elect_site), <span class="dt">data =</span> P1_Rep, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span></code></pre></div>
<p><code>P1_Amplitude ~ Condition * rep + contr_F2_scal + WM_scal + +(1 | ,     ID) + (1 | Stim_Type) + (1 | Elect_site)</code></p>
<hr />
</div>
<div id="lmm_p1-normality-of-residuals" class="section level4">
<h4>LMM_P1: Normality of residuals</h4>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true"></a><span class="co">## Check properties of DV / residuals</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Trans_P1 =<span class="st"> </span>P1_Rep<span class="op">$</span>mean_ROI_P1 <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(P1_Rep<span class="op">$</span>mean_ROI_P1)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true"></a><span class="co"># To make sure residuals follow ND: Calculate box-cox plot</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true"></a><span class="kw">boxcox</span>(P1_Rep<span class="op">$</span>Trans_P1 <span class="op">~</span><span class="st"> </span>P1_Rep<span class="op">$</span>Group_pcic)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P1_val_res_box-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>P1 amplitudes met the assumption of normally distributed residuals.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true"></a><span class="co"># Visualize normality assumption of residuals (without log transform)</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true"></a>mod_P1_Rep =<span class="st"> </span><span class="kw">lm</span>(Trans_P1 <span class="op">~</span><span class="st"> </span>Group_pcic, <span class="dt">data =</span> P1_Rep)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true"></a>res.mod_P1_Rep =<span class="st"> </span><span class="kw">residuals</span>(mod_P1_Rep)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true"></a>qqpl_mod_P1_Rep =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_P1_Rep, <span class="dt">main =</span> <span class="st">&quot;QQplot before transformation&quot;</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true"></a>norm_mod_P1_Rep =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_P1_Rep), <span class="dt">main =</span> <span class="st">&quot;Density plot before transformation&quot;</span>)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P1_rep_res_plot-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<hr />
</div>
<div id="lmm-p1-homoscedasticity" class="section level4">
<h4>LMM P1: Homoscedasticity</h4>
<p>Based on visual inspection, we assumed homoscedasticity.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true"></a><span class="co"># Check homoscedasticity</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">fitted</span>(mod_P1_Rep.lmer), <span class="kw">residuals</span>(mod_P1_Rep.lmer))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P1_rep_homosk-1.png" width="576" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="lmm-n170-random-effect-structure" class="section level4">
<h4>LMM N170: Random effect structure</h4>
<p><br> The final model was:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true"></a><span class="co"># Select correct responses and outlier-free data</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true"></a>N170_Rep =<span class="st"> </span><span class="kw">subset</span>(ERP_data, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true"></a><span class="co"># Prepare fixed factors</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true"></a>N170_Rep<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(N170_Rep<span class="op">$</span>ID)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(N170_Rep<span class="op">$</span>Stim_Type)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true"></a><span class="co"># Single electrodes</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true"></a>N170_Rep =<span class="st"> </span><span class="kw">gather</span>(N170_Rep, Elect_site, N170_Amplitude, N170l_TP7<span class="op">:</span>N170r_P8, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Elect_site =<span class="st"> </span><span class="kw">factor</span>(N170_Rep<span class="op">$</span>Elect_site)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true"></a><span class="co"># Define novel vs repeated trials</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true"></a>N170_Rep<span class="op">$</span>rep[N170_Rep<span class="op">$</span>Group_cic <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;repeated&quot;</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true"></a>N170_Rep<span class="op">$</span>rep[N170_Rep<span class="op">$</span>Group_cic <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;novel&quot;</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true"></a><span class="co"># Rename variables</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true"></a>N170_Rep<span class="op">$</span>PT[N170_Rep<span class="op">$</span>Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;prime&quot;</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true"></a>N170_Rep<span class="op">$</span>PT[N170_Rep<span class="op">$</span>Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;target&quot;</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true"></a></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true"></a><span class="co"># Define emotions</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Condition[N170_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Condition[N170_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Condition[N170_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Condition[N170_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">4</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Condition[N170_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">5</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Condition[N170_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">6</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Condition[N170_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">7</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Condition[N170_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">8</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Condition[N170_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">9</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true"></a></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true"></a><span class="co"># Factor and create contrasts</span></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true"></a>N170_Rep<span class="op">$</span>rep =<span class="st"> </span><span class="kw">factor</span>(N170_Rep<span class="op">$</span>rep)</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true"></a>N170_Rep<span class="op">$</span>PT =<span class="st"> </span><span class="kw">factor</span>(N170_Rep<span class="op">$</span>PT)</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Response =<span class="st"> </span><span class="kw">factor</span>(N170_Rep<span class="op">$</span>Response)</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true"></a></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true"></a><span class="kw">contrasts</span>(N170_Rep<span class="op">$</span>rep) =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>)  <span class="co"># intercept is the mean of repeated / novel</span></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true"></a><span class="kw">contrasts</span>(N170_Rep<span class="op">$</span>PT) =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>)  <span class="co"># intercept is the mean of repeated / novel</span></span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true"></a></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Condition =<span class="st"> </span><span class="kw">factor</span>(N170_Rep<span class="op">$</span>Condition)</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true"></a><span class="kw">contrasts</span>(N170_Rep<span class="op">$</span>Condition) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>, <span class="dt">base =</span> <span class="dv">3</span>)</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true"></a></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true"></a><span class="co"># A = angry, N = neutral, H = happy</span></span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true"></a>HvsA =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">-0.5</span>, <span class="dv">0</span>)  <span class="co"># compare: happy vs. angry</span></span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true"></a>EvsN =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.25</span>, <span class="fl">-0.25</span>, <span class="fl">0.5</span>)  <span class="co"># compare happy/angry to neutral</span></span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true"></a><span class="kw">contrasts</span>(N170_Rep<span class="op">$</span>Condition) =<span class="st"> </span><span class="kw">cbind</span>(EvsN, HvsA)</span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true"></a></span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true"></a>N170_Rep =<span class="st"> </span><span class="kw">subset</span>(N170_Rep, PT <span class="op">==</span><span class="st"> &quot;target&quot;</span>)</span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true"></a></span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true"></a><span class="co"># Build full model</span></span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true"></a>mod_N170_Rep.lmer =<span class="st"> </span><span class="kw">lmer</span>(N170_Amplitude <span class="op">~</span><span class="st"> </span>Condition <span class="op">*</span><span class="st"> </span>rep <span class="op">+</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span></span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true"></a><span class="st">    </span><span class="op">+</span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Elect_site), <span class="dt">data =</span> N170_Rep, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span></code></pre></div>
<p><code>N170_Amplitude ~ Condition * rep + contr_F2_scal + WM_scal + ,     +(1 | ID) + (1 | Stim_Type) + (1 | Elect_site)</code></p>
<hr />
</div>
<div id="lmm_n170-normality-of-residuals" class="section level4">
<h4>LMM_N170: Normality of residuals</h4>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true"></a><span class="co">## Check properties of DV / residuals</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Trans_N170 =<span class="st"> </span>N170_Rep<span class="op">$</span>N170_Amplitude <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(N170_Rep<span class="op">$</span>N170_Amplitude)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true"></a><span class="co"># To make sure residuals follow ND: Calculate box-cox plot</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true"></a><span class="kw">boxcox</span>(N170_Rep<span class="op">$</span>Trans_N170 <span class="op">~</span><span class="st"> </span>N170_Rep<span class="op">$</span>Group_pcic)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/N170_rep_res_box-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>N170 amplitudes met the assumption of normally distributed residuals.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true"></a><span class="co"># Visualize normality assumption of residuals (without log transform)</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true"></a>mod_N170_Rep =<span class="st"> </span><span class="kw">lm</span>(Trans_N170 <span class="op">~</span><span class="st"> </span>Group_pcic, <span class="dt">data =</span> N170_Rep)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true"></a>res.mod_N170_Rep =<span class="st"> </span><span class="kw">residuals</span>(mod_N170_Rep)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true"></a>qqpl_mod_N170_Rep =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_N170_Rep, <span class="dt">main =</span> <span class="st">&quot;QQplot before transformation&quot;</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true"></a>norm_mod_N170_Rep =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_N170_Rep), <span class="dt">main =</span> <span class="st">&quot;Density plot before transformation&quot;</span>)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/N170_rep_res_plot-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<hr />
</div>
<div id="lmm-n170-homoscedasticity" class="section level4">
<h4>LMM N170: Homoscedasticity</h4>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true"></a><span class="co"># Check homoscedasticity</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">fitted</span>(mod_N170_Rep.lmer), <span class="kw">residuals</span>(mod_N170_Rep.lmer))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/N170_val_homosk-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Based on visual inspection, we assumed homoscedasticity.</p>
<hr />
</div>
<div id="lmm_p3-random-effect-structure" class="section level4">
<h4>LMM_P3: Random effect structure</h4>
<p>The final model was:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true"></a><span class="co"># Select correct responses and outlier-free data</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true"></a>P3_Rep =<span class="st"> </span><span class="kw">subset</span>(ERP_data, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true"></a><span class="co"># Prepare fixed factors</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true"></a>P3_Rep<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(P3_Rep<span class="op">$</span>ID)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(P3_Rep<span class="op">$</span>Stim_Type)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true"></a><span class="co"># Define novel vs repeated trials</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true"></a>P3_Rep<span class="op">$</span>rep[P3_Rep<span class="op">$</span>Group_cic <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;repeated&quot;</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true"></a>P3_Rep<span class="op">$</span>rep[P3_Rep<span class="op">$</span>Group_cic <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;novel&quot;</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true"></a><span class="co"># Rename variables</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true"></a>P3_Rep<span class="op">$</span>PT[P3_Rep<span class="op">$</span>Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;prime&quot;</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true"></a>P3_Rep<span class="op">$</span>PT[P3_Rep<span class="op">$</span>Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;target&quot;</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true"></a><span class="co"># Define emotions</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Condition[P3_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Condition[P3_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Condition[P3_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Condition[P3_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">4</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Condition[P3_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">5</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Condition[P3_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">6</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Condition[P3_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">7</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Condition[P3_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">8</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Condition[P3_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">9</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true"></a></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true"></a><span class="co"># Factor and create contrasts</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true"></a>P3_Rep<span class="op">$</span>rep =<span class="st"> </span><span class="kw">factor</span>(P3_Rep<span class="op">$</span>rep)</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true"></a>P3_Rep<span class="op">$</span>PT =<span class="st"> </span><span class="kw">factor</span>(P3_Rep<span class="op">$</span>PT)</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true"></a></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true"></a><span class="kw">contrasts</span>(P3_Rep<span class="op">$</span>rep) =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>)  <span class="co"># intercept is the mean of repeated / novel</span></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true"></a><span class="kw">contrasts</span>(P3_Rep<span class="op">$</span>PT) =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>)  <span class="co"># intercept is the mean of repeated / novel</span></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true"></a></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Condition =<span class="st"> </span><span class="kw">factor</span>(P3_Rep<span class="op">$</span>Condition)</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true"></a><span class="kw">contrasts</span>(P3_Rep<span class="op">$</span>Condition) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>, <span class="dt">base =</span> <span class="dv">3</span>)</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true"></a></span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true"></a><span class="co"># A = angry, N = neutral, H = happy</span></span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true"></a>HvsA =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">-0.5</span>, <span class="dv">0</span>)  <span class="co"># compare: happy vs. angry</span></span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true"></a>EvsN =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.25</span>, <span class="fl">-0.25</span>, <span class="fl">0.5</span>)  <span class="co"># compare happy/angry to neutral</span></span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true"></a><span class="kw">contrasts</span>(P3_Rep<span class="op">$</span>Condition) =<span class="st"> </span><span class="kw">cbind</span>(EvsN, HvsA)</span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true"></a></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true"></a><span class="co"># Bring electrodes in one variable P3_Rep = gather(P3_Rep, Elect_site,</span></span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true"></a><span class="co"># P3_Amplitude, P3_PO3:P3_Oz, factor_key = TRUE)</span></span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true"></a>P3_Rep =<span class="st"> </span><span class="kw">gather</span>(P3_Rep, Elect_site, P3_Amplitude, P3_PO7<span class="op">:</span>P3_Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true"></a></span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true"></a></span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Elect_site =<span class="st"> </span><span class="kw">factor</span>(P3_Rep<span class="op">$</span>Elect_site)</span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true"></a></span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true"></a>P3_Rep =<span class="st"> </span><span class="kw">subset</span>(P3_Rep, PT <span class="op">==</span><span class="st"> &quot;target&quot;</span>)</span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true"></a><span class="co"># P3_Rep = subset(P3_Rep, Response == &#39;false&#39;)</span></span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true"></a></span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true"></a><span class="co"># Build full model</span></span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true"></a>mod_P3_Rep.lmer =<span class="st"> </span><span class="kw">lmer</span>(P3_Amplitude <span class="op">~</span><span class="st"> </span>Condition <span class="op">*</span><span class="st"> </span>rep <span class="op">+</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span></span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true"></a><span class="st">    </span><span class="op">+</span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Elect_site), <span class="dt">data =</span> P3_Rep, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true"></a></span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true"></a><span class="co"># tab_model(mod_P3_Rep.lmer)</span></span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true"></a></span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true"></a><span class="co"># plot_model(mod_P3_Rep.lmer, type = &#39;pred&#39;, terms = c(&#39;rep&#39;))</span></span></code></pre></div>
<p><br></p>
<p><code>P3_Amplitude ~ Condition * rep + contr_F2_scal + WM_scal + +(1 | ,     ID) + (1 | Stim_Type) + (1 | Elect_site)</code></p>
<hr />
</div>
<div id="lmm-p3-normality-of-residuals" class="section level4">
<h4>LMM P3: Normality of residuals</h4>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true"></a><span class="co">## Check properties of DV / residuals</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Trans_P3 =<span class="st"> </span>P3_Rep<span class="op">$</span>mean_ROI_P3 <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(P3_Rep<span class="op">$</span>mean_ROI_P3)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true"></a><span class="co"># To make sure residuals follow ND: Calculate box-cox plot</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true"></a><span class="kw">boxcox</span>(P3_Rep<span class="op">$</span>Trans_P3 <span class="op">~</span><span class="st"> </span>P3_Rep<span class="op">$</span>Group_pcic)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P3_rep_res_box-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>P3 amplitudes met the assumption of normally distributed residuals.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true"></a><span class="co"># Visualize normality assumption of residuals (without log transform)</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true"></a>mod_P3_Rep =<span class="st"> </span><span class="kw">lm</span>(Trans_P3 <span class="op">~</span><span class="st"> </span>Group_pcic, <span class="dt">data =</span> P3_Rep)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true"></a>res.mod_P3_Rep =<span class="st"> </span><span class="kw">residuals</span>(mod_P3_Rep)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true"></a>qqpl_mod_P3_Rep =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_P3_Rep, <span class="dt">main =</span> <span class="st">&quot;QQplot before transformation&quot;</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true"></a>norm_mod_P3_Rep =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_P3_Rep), <span class="dt">main =</span> <span class="st">&quot;Density plot before transformation&quot;</span>)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P3_rep_res_plot-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<hr />
</div>
<div id="lmm-p3-homoscedasticity" class="section level4">
<h4>LMM P3: Homoscedasticity</h4>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true"></a><span class="co"># Check homoscedasticity</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">fitted</span>(mod_P3_Rep.lmer), <span class="kw">residuals</span>(mod_P3_Rep.lmer))</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P3_rep_homosk-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Based on visual inspection, we assumed homoscedasticity.</p>
<hr />
</div>
<div id="supplement-face-1-analysis" class="section level4">
<h4>Supplement: Face 1 analysis</h4>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true"></a><span class="co"># Select correct responses and outlier-free data</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true"></a>P1_Rep =<span class="st"> </span><span class="kw">subset</span>(ERP_data, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true"></a><span class="co"># Prepare fixed factors</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true"></a>P1_Rep<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(P1_Rep<span class="op">$</span>ID)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(P1_Rep<span class="op">$</span>Stim_Type)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true"></a><span class="co"># Define novel vs repeated trials</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true"></a>P1_Rep<span class="op">$</span>rep[P1_Rep<span class="op">$</span>Group_cic <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;repeated&quot;</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true"></a>P1_Rep<span class="op">$</span>rep[P1_Rep<span class="op">$</span>Group_cic <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;novel&quot;</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true"></a><span class="co"># Rename variables</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true"></a>P1_Rep<span class="op">$</span>PT[P1_Rep<span class="op">$</span>Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;prime&quot;</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true"></a>P1_Rep<span class="op">$</span>PT[P1_Rep<span class="op">$</span>Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;target&quot;</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true"></a></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true"></a><span class="co"># Rename variables P1_Rep$Response[P1_Rep$Response == 0]=&#39;false&#39;</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true"></a><span class="co"># P1_Rep$Response[P1_Rep$Response == 1]=&#39;correct&#39;</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true"></a></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true"></a><span class="co"># Define emotions</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Condition[P1_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Condition[P1_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Condition[P1_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Condition[P1_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">4</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Condition[P1_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">5</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Condition[P1_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">6</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Condition[P1_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">7</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Condition[P1_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">8</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Condition[P1_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">9</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true"></a></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true"></a><span class="co"># Factor and create contrasts</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true"></a>P1_Rep<span class="op">$</span>rep =<span class="st"> </span><span class="kw">factor</span>(P1_Rep<span class="op">$</span>rep)</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true"></a>P1_Rep<span class="op">$</span>PT =<span class="st"> </span><span class="kw">factor</span>(P1_Rep<span class="op">$</span>PT)</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true"></a><span class="co"># P1_Rep$Response = factor(P1_Rep$Response)</span></span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true"></a></span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true"></a><span class="kw">contrasts</span>(P1_Rep<span class="op">$</span>rep) =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>)  <span class="co"># intercept is the mean of repeated / novel</span></span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true"></a></span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Condition =<span class="st"> </span><span class="kw">factor</span>(P1_Rep<span class="op">$</span>Condition)</span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true"></a><span class="kw">contrasts</span>(P1_Rep<span class="op">$</span>Condition) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>, <span class="dt">base =</span> <span class="dv">3</span>)</span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true"></a></span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true"></a><span class="co"># A = angry, N = neutral, H = happy</span></span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true"></a>HvsA =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">-0.5</span>, <span class="dv">0</span>)  <span class="co"># compare: happy vs. angry</span></span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true"></a>EvsN =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.25</span>, <span class="fl">-0.25</span>, <span class="fl">0.5</span>)  <span class="co"># compare happy/angry to neutral</span></span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true"></a><span class="kw">contrasts</span>(P1_Rep<span class="op">$</span>Condition) =<span class="st"> </span><span class="kw">cbind</span>(EvsN, HvsA)</span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true"></a></span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true"></a></span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true"></a><span class="co"># Bring electrodes in one variable P1_Rep = gather(P1_Rep, Elect_site,</span></span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true"></a><span class="co"># P1_Amplitude, P1_PO3:P1_Oz, factor_key = TRUE)</span></span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true"></a>P1_Rep =<span class="st"> </span><span class="kw">gather</span>(P1_Rep, Elect_site, P1_Amplitude, P1_PO7<span class="op">:</span>P1_Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true"></a></span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Elect_site =<span class="st"> </span><span class="kw">factor</span>(P1_Rep<span class="op">$</span>Elect_site)</span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true"></a>P1_Rep =<span class="st"> </span><span class="kw">subset</span>(P1_Rep, PT <span class="op">==</span><span class="st"> &quot;prime&quot;</span>)</span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true"></a></span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true"></a><span class="co"># Build full model</span></span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true"></a>mod_P1_emo.lmer =<span class="st"> </span><span class="kw">lmer</span>(P1_Amplitude <span class="op">~</span><span class="st"> </span>Condition <span class="op">+</span><span class="st"> </span>contr_F1_scal <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span><span class="op">+</span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span></span>
<span id="cb30-55"><a href="#cb30-55" aria-hidden="true"></a><span class="st">    </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Elect_site), <span class="dt">data =</span> P1_Rep, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb30-56"><a href="#cb30-56" aria-hidden="true"></a></span>
<span id="cb30-57"><a href="#cb30-57" aria-hidden="true"></a></span>
<span id="cb30-58"><a href="#cb30-58" aria-hidden="true"></a><span class="co"># tab_model(mod_P1_emo.lmer)</span></span>
<span id="cb30-59"><a href="#cb30-59" aria-hidden="true"></a></span>
<span id="cb30-60"><a href="#cb30-60" aria-hidden="true"></a><span class="co"># plot_model(mod_P1_emo.lmer, type = &#39;pred&#39;, terms = c(&#39;Condition&#39;))</span></span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true"></a><span class="co"># Select correct responses and outlier-free data</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true"></a>N170_Rep =<span class="st"> </span><span class="kw">subset</span>(ERP_data, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true"></a><span class="co"># Prepare fixed factors</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true"></a>N170_Rep<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(N170_Rep<span class="op">$</span>ID)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(N170_Rep<span class="op">$</span>Stim_Type)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true"></a><span class="co"># Single electrodes</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true"></a>N170_Rep =<span class="st"> </span><span class="kw">gather</span>(N170_Rep, Elect_site, N170_Amplitude, N170l_TP7<span class="op">:</span>N170r_P8, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Elect_site =<span class="st"> </span><span class="kw">factor</span>(N170_Rep<span class="op">$</span>Elect_site)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true"></a><span class="co"># Define novel vs repeated trials</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true"></a>N170_Rep<span class="op">$</span>rep[N170_Rep<span class="op">$</span>Group_cic <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;repeated&quot;</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true"></a>N170_Rep<span class="op">$</span>rep[N170_Rep<span class="op">$</span>Group_cic <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;novel&quot;</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true"></a></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true"></a><span class="co"># Rename variables</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true"></a>N170_Rep<span class="op">$</span>PT[N170_Rep<span class="op">$</span>Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;prime&quot;</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true"></a>N170_Rep<span class="op">$</span>PT[N170_Rep<span class="op">$</span>Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;target&quot;</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true"></a></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true"></a><span class="co"># Define emotions</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Condition[N170_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Condition[N170_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Condition[N170_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Condition[N170_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">4</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Condition[N170_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">5</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Condition[N170_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">6</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Condition[N170_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">7</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Condition[N170_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">8</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Condition[N170_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">9</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true"></a></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true"></a><span class="co"># Factor and create contrasts</span></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true"></a>N170_Rep<span class="op">$</span>rep =<span class="st"> </span><span class="kw">factor</span>(N170_Rep<span class="op">$</span>rep)</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true"></a>N170_Rep<span class="op">$</span>PT =<span class="st"> </span><span class="kw">factor</span>(N170_Rep<span class="op">$</span>PT)</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Response =<span class="st"> </span><span class="kw">factor</span>(N170_Rep<span class="op">$</span>Response)</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true"></a></span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true"></a><span class="kw">contrasts</span>(N170_Rep<span class="op">$</span>rep) =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>)  <span class="co"># intercept is the mean of repeated / novel</span></span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true"></a><span class="kw">contrasts</span>(N170_Rep<span class="op">$</span>PT) =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>)  <span class="co"># intercept is the mean of repeated / novel</span></span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true"></a></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Condition =<span class="st"> </span><span class="kw">factor</span>(N170_Rep<span class="op">$</span>Condition)</span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true"></a><span class="kw">contrasts</span>(N170_Rep<span class="op">$</span>Condition) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>, <span class="dt">base =</span> <span class="dv">3</span>)</span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true"></a></span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true"></a><span class="co"># A = angry, N = neutral, H = happy</span></span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true"></a>HvsA =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">-0.5</span>, <span class="dv">0</span>)  <span class="co"># compare: happy vs. angry</span></span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true"></a>EvsN =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.25</span>, <span class="fl">-0.25</span>, <span class="fl">0.5</span>)  <span class="co"># compare happy/angry to neutral</span></span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true"></a><span class="kw">contrasts</span>(N170_Rep<span class="op">$</span>Condition) =<span class="st"> </span><span class="kw">cbind</span>(EvsN, HvsA)</span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true"></a></span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true"></a>N170_Rep =<span class="st"> </span><span class="kw">subset</span>(N170_Rep, PT <span class="op">==</span><span class="st"> &quot;prime&quot;</span>)</span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true"></a></span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true"></a><span class="co"># Build full model</span></span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true"></a>mod_N170_emo.lmer =<span class="st"> </span><span class="kw">lmer</span>(N170_Amplitude <span class="op">~</span><span class="st"> </span>Condition <span class="op">+</span><span class="st"> </span>contr_F1_scal <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span><span class="op">+</span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span></span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true"></a><span class="st">    </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Elect_site), <span class="dt">data =</span> N170_Rep, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true"></a></span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true"></a><span class="co"># tab_model(mod_N170_emo.lmer)</span></span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true"></a></span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true"></a><span class="co"># plot_model(mod_N170_emo.lmer, type = &#39;pred&#39;, terms = c(&#39;Condition&#39;))</span></span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true"></a><span class="co"># Select correct responses and outlier-free data</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true"></a>P3_Rep =<span class="st"> </span><span class="kw">subset</span>(ERP_data, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true"></a><span class="co"># Prepare fixed factors</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true"></a>P3_Rep<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(P3_Rep<span class="op">$</span>ID)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(P3_Rep<span class="op">$</span>Stim_Type)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true"></a><span class="co"># Define novel vs repeated trials</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true"></a>P3_Rep<span class="op">$</span>rep[P3_Rep<span class="op">$</span>Group_cic <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;repeated&quot;</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true"></a>P3_Rep<span class="op">$</span>rep[P3_Rep<span class="op">$</span>Group_cic <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;novel&quot;</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true"></a><span class="co"># Rename variables</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true"></a>P3_Rep<span class="op">$</span>PT[P3_Rep<span class="op">$</span>Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;prime&quot;</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true"></a>P3_Rep<span class="op">$</span>PT[P3_Rep<span class="op">$</span>Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;target&quot;</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true"></a></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true"></a><span class="co"># Define emotions</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Condition[P3_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Condition[P3_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Condition[P3_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Condition[P3_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">4</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Condition[P3_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">5</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Condition[P3_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">6</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Condition[P3_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">7</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Condition[P3_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">8</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Condition[P3_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">9</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true"></a></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true"></a><span class="co"># Factor and create contrasts</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true"></a>P3_Rep<span class="op">$</span>rep =<span class="st"> </span><span class="kw">factor</span>(P3_Rep<span class="op">$</span>rep)</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true"></a>P3_Rep<span class="op">$</span>PT =<span class="st"> </span><span class="kw">factor</span>(P3_Rep<span class="op">$</span>PT)</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true"></a></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true"></a><span class="kw">contrasts</span>(P3_Rep<span class="op">$</span>rep) =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>)  <span class="co"># intercept is the mean of repeated / novel</span></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true"></a><span class="kw">contrasts</span>(P3_Rep<span class="op">$</span>PT) =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>)  <span class="co"># intercept is the mean of repeated / novel</span></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true"></a></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Condition =<span class="st"> </span><span class="kw">factor</span>(P3_Rep<span class="op">$</span>Condition)</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true"></a><span class="kw">contrasts</span>(P3_Rep<span class="op">$</span>Condition) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>, <span class="dt">base =</span> <span class="dv">3</span>)</span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true"></a></span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true"></a><span class="co"># A = angry, N = neutral, H = happy</span></span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true"></a>HvsA =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">-0.5</span>, <span class="dv">0</span>)  <span class="co"># compare: happy vs. angry</span></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true"></a>EvsN =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.25</span>, <span class="fl">-0.25</span>, <span class="fl">0.5</span>)  <span class="co"># compare happy/angry to neutral</span></span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true"></a><span class="kw">contrasts</span>(P3_Rep<span class="op">$</span>Condition) =<span class="st"> </span><span class="kw">cbind</span>(EvsN, HvsA)</span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true"></a></span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true"></a><span class="co"># Bring electrodes in one variable P3_Rep = gather(P3_Rep, Elect_site,</span></span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true"></a><span class="co"># P3_Amplitude, P3_PO3:P3_Oz, factor_key = TRUE)</span></span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true"></a>P3_Rep =<span class="st"> </span><span class="kw">gather</span>(P3_Rep, Elect_site, P3_Amplitude, P3_PO7<span class="op">:</span>P3_Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true"></a></span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true"></a></span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Elect_site =<span class="st"> </span><span class="kw">factor</span>(P3_Rep<span class="op">$</span>Elect_site)</span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true"></a></span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true"></a>P3_Rep =<span class="st"> </span><span class="kw">subset</span>(P3_Rep, PT <span class="op">==</span><span class="st"> &quot;prime&quot;</span>)</span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true"></a><span class="co"># P3_Rep = subset(P3_Rep, Response == &#39;false&#39;)</span></span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true"></a></span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true"></a><span class="co"># Build full model</span></span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true"></a>mod_P3_emo.lmer =<span class="st"> </span><span class="kw">lmer</span>(P3_Amplitude <span class="op">~</span><span class="st"> </span>Condition <span class="op">+</span><span class="st"> </span>contr_F1_scal <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span><span class="op">+</span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span></span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true"></a><span class="st">    </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Elect_site), <span class="dt">data =</span> P3_Rep, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true"></a></span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true"></a><span class="co"># tab_model(mod_P3_emo.lmer)</span></span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true"></a></span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true"></a><span class="co"># plot_model(mod_P3_emo.lmer, type = &#39;pred&#39;, terms = c(&#39;Condition&#39;))</span></span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true"></a><span class="co"># Define labels</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true"></a>labels =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Emotion vs. Neutral&quot;</span>, <span class="st">&quot;Happy vs. Angry&quot;</span>, <span class="st">&quot;Stimulus&#39; Contrast&quot;</span>, <span class="st">&quot;Working Memory&quot;</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true"></a><span class="co"># Create table</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true"></a><span class="kw">tab_model</span>(mod_P1_emo.lmer, mod_N170_emo.lmer, mod_P3_emo.lmer, <span class="dt">show.intercept =</span> <span class="ot">FALSE</span>, </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true"></a>    <span class="dt">pred.labels =</span> labels, <span class="dt">string.est =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">show.se =</span> <span class="ot">TRUE</span>, <span class="dt">string.se =</span> <span class="st">&quot;SE&quot;</span>, <span class="dt">show.stat =</span> <span class="ot">TRUE</span>, </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true"></a>    <span class="dt">string.stat =</span> <span class="st">&quot;t&quot;</span>, <span class="dt">show.ci =</span> <span class="ot">FALSE</span>, <span class="dt">show.re.var =</span> <span class="ot">TRUE</span>, <span class="dt">show.obs =</span> <span class="ot">FALSE</span>, <span class="dt">emph.p =</span> <span class="ot">TRUE</span>, </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true"></a>    <span class="dt">dv.labels =</span> <span class="kw">c</span>(<span class="st">&quot;P1 Amplitude&quot;</span>, <span class="st">&quot;N170 Amplitude&quot;</span>, <span class="st">&quot;P3 Amplitude&quot;</span>), <span class="dt">show.icc =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
P1 Amplitude
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
N170 Amplitude
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
P3 Amplitude
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
b
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
b
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col8">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col9">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  0">
b
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  1">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  2">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  3">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Emotion vs. Neutral
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-1.55
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.42
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-3.72
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.79
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.40
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-1.96
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.050
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
-2.18
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
0.49
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
-4.49
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
<strong>&lt;0.001
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Happy vs. Angry
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.34
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.37
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.93
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.352
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.05
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.36
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
2.94
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
<strong>0.003</strong>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
0.96
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
0.43
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
2.23
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
<strong>0.026</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Stimulus’ Contrast
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.28
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.21
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-1.32
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.187
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.11
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.16
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
0.69
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.490
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
-0.20
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
0.26
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
-0.76
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
0.445
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Working Memory
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.51
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.98
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.52
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.601
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.20
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.61
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
0.32
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.747
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
1.18
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
1.11
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
1.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
0.289
</td>
</tr>
<tr>
<td colspan="13" style="font-weight:bold; text-align:left; padding-top:.8em;">
Random Effects
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
σ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
281.10
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
238.02
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
379.72
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
τ<sub>00</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
3.50 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.63 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
6.47 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
26.96 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
10.20 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
34.77 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
6.54 <sub>Elect_site</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
3.52 <sub>Elect_site</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
4.53 <sub>Elect_site</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
ICC
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.12
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.11
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
72 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
72 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
72 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
7 <sub>Elect_site</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
6 <sub>Elect_site</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
7 <sub>Elect_site</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
0.002 / 0.118
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
0.001 / 0.058
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
0.005 / 0.112
</td>
</tr>
</table>
<p><em>Post-hoc tests</em></p>
<p><strong>P1 Emotion vs. Neutral contrast</strong></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true"></a><span class="co">### Calculate post-hoc tests P1 valence</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true"></a>mod_P1_Rep.lmer3 =<span class="st"> </span><span class="kw">lmer</span>(P1_Amplitude <span class="op">~</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>Condition <span class="op">+</span><span class="st"> </span><span class="op">+</span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true"></a><span class="st">    </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Elect_site), <span class="dt">data =</span> P1_Rep, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true"></a>P1_Rep_lmm_model_posthoc =<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(mod_P1_Rep.lmer3, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">Condition =</span> <span class="kw">c</span>(<span class="st">&quot;neutral - happy = 0&quot;</span>, </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true"></a>    <span class="st">&quot;neutral - angry = 0&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="dt">type =</span> <span class="st">&quot;fdr&quot;</span>)))</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true"></a><span class="co"># Get ready for presentation in RMarkdown</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true"></a>tab1 =<span class="st"> </span><span class="kw">merge</span>(<span class="kw">as.data.frame</span>(P1_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>coefficients), <span class="kw">as.data.frame</span>(P1_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>sigma), </span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true"></a>    <span class="dt">by =</span> <span class="dv">0</span>)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true"></a>tab2 =<span class="st"> </span><span class="kw">as.data.frame</span>(P1_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>pvalues)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true"></a><span class="kw">rownames</span>(tab2) =<span class="st"> </span><span class="kw">rownames</span>(<span class="kw">as.data.frame</span>(P1_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>tstat))</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true"></a>tab2 =<span class="st"> </span><span class="kw">merge</span>(<span class="kw">as.data.frame</span>(P1_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>tstat), tab2, <span class="dt">by =</span> <span class="dv">0</span>)</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true"></a>P1_Rep_posthoc2 =<span class="st"> </span><span class="kw">merge</span>(tab1, tab2, <span class="dt">by =</span> <span class="st">&quot;Row.names&quot;</span>)</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true"></a><span class="kw">colnames</span>(P1_Rep_posthoc2) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Contrast&quot;</span>, <span class="st">&quot;Est.&quot;</span>, <span class="st">&quot;Std. Error&quot;</span>, <span class="st">&quot;z value&quot;</span>, <span class="st">&quot;p value&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true"></a><span class="co"># Create table</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true"></a><span class="kw">kable</span>(P1_Rep_posthoc2) <span class="op">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&quot;hover&quot;</span>), <span class="dt">font_size =</span> <span class="dv">14</span>, <span class="dt">fixed_thead =</span> T)</span></code></pre></div>
<table class="table table-hover" style="font-size: 14px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Contrast
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Est.
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Std. Error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
z value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
p value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
neutral - angry
</td>
<td style="text-align:right;">
-1.344
</td>
<td style="text-align:right;">
0.362
</td>
<td style="text-align:right;">
-3.72
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
neutral - happy
</td>
<td style="text-align:right;">
-0.911
</td>
<td style="text-align:right;">
0.362
</td>
<td style="text-align:right;">
-2.52
</td>
<td style="text-align:right;">
0.023
</td>
</tr>
</tbody>
</table>
<p><strong>P3 Emotion vs. Neutral contrast</strong></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true"></a><span class="co">### Calculate post-hoc tests P3 valence</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true"></a>mod_P3_Rep.lmer3 =<span class="st"> </span><span class="kw">lmer</span>(P3_Amplitude <span class="op">~</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>Condition <span class="op">+</span><span class="st"> </span><span class="op">+</span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true"></a><span class="st">    </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Elect_site), <span class="dt">data =</span> P3_Rep, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true"></a>P3_Rep_lmm_model_posthoc =<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(mod_P3_Rep.lmer3, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">Condition =</span> <span class="kw">c</span>(<span class="st">&quot;neutral - happy = 0&quot;</span>, </span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true"></a>    <span class="st">&quot;neutral - angry = 0&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="dt">type =</span> <span class="st">&quot;fdr&quot;</span>)))</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true"></a><span class="co"># Get ready for presentation in RMarkdown</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true"></a>tab1 =<span class="st"> </span><span class="kw">merge</span>(<span class="kw">as.data.frame</span>(P3_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>coefficients), <span class="kw">as.data.frame</span>(P3_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>sigma), </span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true"></a>    <span class="dt">by =</span> <span class="dv">0</span>)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true"></a>tab2 =<span class="st"> </span><span class="kw">as.data.frame</span>(P3_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>pvalues)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true"></a><span class="kw">rownames</span>(tab2) =<span class="st"> </span><span class="kw">rownames</span>(<span class="kw">as.data.frame</span>(P3_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>tstat))</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true"></a>tab2 =<span class="st"> </span><span class="kw">merge</span>(<span class="kw">as.data.frame</span>(P3_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>tstat), tab2, <span class="dt">by =</span> <span class="dv">0</span>)</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true"></a>P3_Rep_posthoc2 =<span class="st"> </span><span class="kw">merge</span>(tab1, tab2, <span class="dt">by =</span> <span class="st">&quot;Row.names&quot;</span>)</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true"></a><span class="kw">colnames</span>(P3_Rep_posthoc2) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Contrast&quot;</span>, <span class="st">&quot;Est.&quot;</span>, <span class="st">&quot;Std. Error&quot;</span>, <span class="st">&quot;z value&quot;</span>, <span class="st">&quot;p value&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true"></a><span class="co"># Create table</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true"></a><span class="kw">kable</span>(P3_Rep_posthoc2) <span class="op">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&quot;hover&quot;</span>), <span class="dt">font_size =</span> <span class="dv">14</span>, <span class="dt">fixed_thead =</span> T)</span></code></pre></div>
<table class="table table-hover" style="font-size: 14px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Contrast
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Est.
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Std. Error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
z value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
p value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
neutral - angry
</td>
<td style="text-align:right;">
-2.12
</td>
<td style="text-align:right;">
0.421
</td>
<td style="text-align:right;">
-5.04
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
neutral - happy
</td>
<td style="text-align:right;">
-1.12
</td>
<td style="text-align:right;">
0.422
</td>
<td style="text-align:right;">
-2.66
</td>
<td style="text-align:right;">
0.015
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="results" class="section level3">
<h3><strong>Results</strong></h3>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true"></a><span class="co">### Calculate post-hoc tests P1 valence</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true"></a>P1_Rep<span class="op">$</span>interaction =<span class="st"> </span><span class="kw">interaction</span>(P1_Rep<span class="op">$</span>rep, P1_Rep<span class="op">$</span>Condition)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true"></a>mod_P1_Rep.lmer2 =<span class="st"> </span><span class="kw">lmer</span>(P1_Amplitude <span class="op">~</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>Condition <span class="op">*</span><span class="st"> </span>rep <span class="op">+</span><span class="st"> </span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true"></a><span class="st">    </span><span class="op">+</span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Elect_site), <span class="dt">data =</span> P1_Rep, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true"></a><span class="co"># Choose contrasts of interest / add fdr-correction</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true"></a>P1_Rep_lmm_model_posthoc =<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(mod_P1_Rep.lmer2, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">Condition =</span> <span class="kw">c</span>(<span class="st">&quot;neutral - happy = 0&quot;</span>, </span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true"></a>    <span class="st">&quot;neutral - angry = 0&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="dt">type =</span> <span class="st">&quot;fdr&quot;</span>)))</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true"></a></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true"></a></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true"></a><span class="co"># Get ready for presentation in RMarkdown</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true"></a>tab1 =<span class="st"> </span><span class="kw">merge</span>(<span class="kw">as.data.frame</span>(P1_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>coefficients), <span class="kw">as.data.frame</span>(P1_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>sigma), </span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true"></a>    <span class="dt">by =</span> <span class="dv">0</span>)</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true"></a>tab2 =<span class="st"> </span><span class="kw">as.data.frame</span>(P1_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>pvalues)</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true"></a><span class="kw">rownames</span>(tab2) =<span class="st"> </span><span class="kw">rownames</span>(<span class="kw">as.data.frame</span>(P1_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>tstat))</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true"></a>tab2 =<span class="st"> </span><span class="kw">merge</span>(<span class="kw">as.data.frame</span>(P1_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>tstat), tab2, <span class="dt">by =</span> <span class="dv">0</span>)</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true"></a>P1_Rep_posthoc1 =<span class="st"> </span><span class="kw">merge</span>(tab1, tab2, <span class="dt">by =</span> <span class="st">&quot;Row.names&quot;</span>)</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true"></a><span class="kw">colnames</span>(P1_Rep_posthoc1) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Contrast&quot;</span>, <span class="st">&quot;Est.&quot;</span>, <span class="st">&quot;Std. Error&quot;</span>, <span class="st">&quot;z value&quot;</span>, <span class="st">&quot;p value&quot;</span>)</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true"></a></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true"></a></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true"></a><span class="co">### Calculate post-hoc tests P1 valence</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true"></a>P1_Rep<span class="op">$</span>interaction =<span class="st"> </span><span class="kw">interaction</span>(P1_Rep<span class="op">$</span>rep, P1_Rep<span class="op">$</span>Condition)</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true"></a></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true"></a></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true"></a>mod_P1_Rep.lmer3 =<span class="st"> </span><span class="kw">lmer</span>(P1_Amplitude <span class="op">~</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>interaction <span class="op">+</span><span class="st"> </span><span class="op">+</span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true"></a><span class="st">    </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Elect_site), <span class="dt">data =</span> P1_Rep, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true"></a></span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true"></a></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true"></a>P1_Rep_lmm_model_posthoc =<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(mod_P1_Rep.lmer3, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">interaction =</span> <span class="kw">c</span>(<span class="st">&quot;novel.happy - novel.angry = 0&quot;</span>, </span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true"></a>    <span class="st">&quot;novel.happy - repeated.angry = 0&quot;</span>, <span class="st">&quot;repeated.angry - novel.angry = 0&quot;</span>, <span class="st">&quot;repeated.happy - novel.angry = 0&quot;</span>, </span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true"></a>    <span class="st">&quot;repeated.happy - novel.happy = 0&quot;</span>, <span class="st">&quot;repeated.happy - repeated.angry</span><span class="ch">\t</span><span class="st">= 0&quot;</span>)), </span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true"></a>    <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="dt">type =</span> <span class="st">&quot;fdr&quot;</span>)))</span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true"></a></span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true"></a></span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true"></a><span class="co"># Get ready for presentation in RMarkdown</span></span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true"></a>tab1 =<span class="st"> </span><span class="kw">merge</span>(<span class="kw">as.data.frame</span>(P1_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>coefficients), <span class="kw">as.data.frame</span>(P1_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>sigma), </span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true"></a>    <span class="dt">by =</span> <span class="dv">0</span>)</span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true"></a>tab2 =<span class="st"> </span><span class="kw">as.data.frame</span>(P1_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>pvalues)</span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true"></a><span class="kw">rownames</span>(tab2) =<span class="st"> </span><span class="kw">rownames</span>(<span class="kw">as.data.frame</span>(P1_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>tstat))</span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true"></a>tab2 =<span class="st"> </span><span class="kw">merge</span>(<span class="kw">as.data.frame</span>(P1_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>tstat), tab2, <span class="dt">by =</span> <span class="dv">0</span>)</span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true"></a>P1_Rep_posthoc2 =<span class="st"> </span><span class="kw">merge</span>(tab1, tab2, <span class="dt">by =</span> <span class="st">&quot;Row.names&quot;</span>)</span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true"></a><span class="kw">colnames</span>(P1_Rep_posthoc2) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Contrast&quot;</span>, <span class="st">&quot;Est.&quot;</span>, <span class="st">&quot;Std. Error&quot;</span>, <span class="st">&quot;z value&quot;</span>, <span class="st">&quot;p value&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true"></a><span class="co"># Define labels</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true"></a>labels =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Emotion vs. Neutral&quot;</span>, <span class="st">&quot;Happy vs. Angry&quot;</span>, <span class="st">&quot;Repetition&quot;</span>, <span class="st">&quot;Stimulus&#39; Contrast&quot;</span>, </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true"></a>    <span class="st">&quot;Working Memory&quot;</span>, <span class="st">&quot;E vs. N x Repetition&quot;</span>, <span class="st">&quot;H vs. A x Repetition&quot;</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true"></a><span class="co"># Create table</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true"></a><span class="kw">tab_model</span>(mod_P1_Rep.lmer, mod_N170_Rep.lmer, mod_P3_Rep.lmer, <span class="dt">show.intercept =</span> <span class="ot">FALSE</span>, </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true"></a>    <span class="dt">pred.labels =</span> labels, <span class="dt">string.est =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">show.se =</span> <span class="ot">TRUE</span>, <span class="dt">string.se =</span> <span class="st">&quot;SE&quot;</span>, <span class="dt">show.stat =</span> <span class="ot">TRUE</span>, </span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true"></a>    <span class="dt">string.stat =</span> <span class="st">&quot;t&quot;</span>, <span class="dt">show.ci =</span> <span class="ot">FALSE</span>, <span class="dt">show.re.var =</span> <span class="ot">TRUE</span>, <span class="dt">show.obs =</span> <span class="ot">FALSE</span>, <span class="dt">emph.p =</span> <span class="ot">TRUE</span>, </span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true"></a>    <span class="dt">dv.labels =</span> <span class="kw">c</span>(<span class="st">&quot;P1 Amplitude&quot;</span>, <span class="st">&quot;N170 Amplitude&quot;</span>, <span class="st">&quot;P3 Amplitude&quot;</span>), <span class="dt">show.icc =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
P1 Amplitude
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
N170 Amplitude
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
P3 Amplitude
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
b
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
b
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col8">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col9">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  0">
b
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  1">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  2">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  3">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Emotion vs. Neutral
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-1.29
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.40
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-3.20
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>0.001</strong>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.08
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.38
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-0.22
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.826
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
-1.05
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
0.45
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
-2.33
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
<strong>0.020</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Happy vs. Angry
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.27
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.35
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.77
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.442
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.11
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.33
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
0.32
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.749
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
1.10
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
0.39
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
2.84
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
<strong>0.004</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Repetition
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.11
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.33
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.34
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.732
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.07
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.28
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
0.26
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.798
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
0.88
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
0.36
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
2.46
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
<strong>0.014</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Stimulus’ Contrast
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.36
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.21
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.67
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.095
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.04
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.14
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
0.30
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.761
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
-0.50
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
0.23
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
-2.19
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
<strong>0.029</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Working Memory
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.05
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.97
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.08
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.278
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.77
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.63
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
1.24
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.217
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
0.38
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
1.23
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
0.31
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
0.760
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
E vs. N x Repetition
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.20
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.81
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.49
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.137
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.87
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.77
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
1.14
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.256
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
0.73
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
0.90
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
0.81
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
0.420
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
H vs. A x Repetition
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
2.75
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.70
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
3.92
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.16
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.66
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
1.76
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.079
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
-0.78
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
0.78
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
-0.99
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
0.321
</td>
</tr>
<tr>
<td colspan="13" style="font-weight:bold; text-align:left; padding-top:.8em;">
Random Effects
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
σ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
269.64
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
222.67
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
337.94
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
τ<sub>00</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
5.99 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.19 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
5.49 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
26.54 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
10.79 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
43.24 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
8.99 <sub>Elect_site</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
1.57 <sub>Elect_site</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
3.46 <sub>Elect_site</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
ICC
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.13
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.05
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.13
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
72 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
72 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
72 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
7 <sub>Elect_site</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
6 <sub>Elect_site</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
7 <sub>Elect_site</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
0.006 / 0.138
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
0.003 / 0.056
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
0.002 / 0.136
</td>
</tr>
</table>
<p><em>Note:</em> p-values for the fixed effects calculated using Wald-statistics approximation, uncorrected. <em>b</em>: unstandardized coefficient; <em>SE</em>: standard error; <em>t</em>: test statistic coefficient; <em>p</em>: p-value; <em>σ2</em>: within-group variance; <em>τ00</em>: between-group variance; <em>ICC</em>: interclass correlation (ratio of between-cluster variance to total variance); <em>N</em>: number of random effects.</p>
<p><br></p>
<p><strong>Post-hoc test P1: Contrast Emotion vs. Neutral</strong></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true"></a><span class="co"># Create table</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true"></a><span class="kw">kable</span>(P1_Rep_posthoc1) <span class="op">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&quot;hover&quot;</span>), <span class="dt">font_size =</span> <span class="dv">14</span>, <span class="dt">fixed_thead =</span> T)</span></code></pre></div>
<table class="table table-hover" style="font-size: 14px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Contrast
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Est.
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Std. Error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
z value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
p value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
neutral - angry
</td>
<td style="text-align:right;">
-1.335
</td>
<td style="text-align:right;">
0.362
</td>
<td style="text-align:right;">
-3.69
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
neutral - happy
</td>
<td style="text-align:right;">
-0.906
</td>
<td style="text-align:right;">
0.363
</td>
<td style="text-align:right;">
-2.50
</td>
<td style="text-align:right;">
0.024
</td>
</tr>
</tbody>
</table>
<p><br></p>
<p><strong>Post-hoc test P1: Contrast Emotion vs. Neutral with Repetition</strong></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true"></a><span class="co"># Create table</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true"></a><span class="kw">kable</span>(P1_Rep_posthoc2) <span class="op">%&gt;%</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&quot;hover&quot;</span>), <span class="dt">font_size =</span> <span class="dv">14</span>, <span class="dt">fixed_thead =</span> T)</span></code></pre></div>
<table class="table table-hover" style="font-size: 14px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Contrast
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Est.
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Std. Error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
z value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
p value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
novel.happy - novel.angry
</td>
<td style="text-align:right;">
-0.220
</td>
<td style="text-align:right;">
0.524
</td>
<td style="text-align:right;">
-0.419
</td>
<td style="text-align:right;">
0.975
</td>
</tr>
<tr>
<td style="text-align:left;">
novel.happy - repeated.angry
</td>
<td style="text-align:right;">
-1.557
</td>
<td style="text-align:right;">
0.541
</td>
<td style="text-align:right;">
-2.876
</td>
<td style="text-align:right;">
0.021
</td>
</tr>
<tr>
<td style="text-align:left;">
repeated.angry - novel.angry
</td>
<td style="text-align:right;">
1.337
</td>
<td style="text-align:right;">
0.536
</td>
<td style="text-align:right;">
2.495
</td>
<td style="text-align:right;">
0.061
</td>
</tr>
<tr>
<td style="text-align:left;">
repeated.happy - novel.angry
</td>
<td style="text-align:right;">
0.697
</td>
<td style="text-align:right;">
0.535
</td>
<td style="text-align:right;">
1.303
</td>
<td style="text-align:right;">
0.561
</td>
</tr>
<tr>
<td style="text-align:left;">
repeated.happy - novel.happy
</td>
<td style="text-align:right;">
0.917
</td>
<td style="text-align:right;">
0.537
</td>
<td style="text-align:right;">
1.708
</td>
<td style="text-align:right;">
0.319
</td>
</tr>
<tr>
<td style="text-align:left;">
repeated.happy - repeated.angry
</td>
<td style="text-align:right;">
-0.640
</td>
<td style="text-align:right;">
0.512
</td>
<td style="text-align:right;">
-1.250
</td>
<td style="text-align:right;">
0.594
</td>
</tr>
</tbody>
</table>
<p><br></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true"></a><span class="co">### Calculate post-hoc tests P1 valence</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true"></a>P3_Rep<span class="op">$</span>interaction =<span class="st"> </span><span class="kw">interaction</span>(P3_Rep<span class="op">$</span>rep, P3_Rep<span class="op">$</span>Condition)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true"></a>mod_P3_Rep.lmer2 =<span class="st"> </span><span class="kw">lmer</span>(P3_Amplitude <span class="op">~</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>Condition <span class="op">*</span><span class="st"> </span>rep <span class="op">+</span><span class="st"> </span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true"></a><span class="st">    </span><span class="op">+</span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Elect_site), <span class="dt">data =</span> P3_Rep, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true"></a><span class="co"># Choose contrasts of interest / add fdr-correction</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true"></a>P3_Rep_lmm_model_posthoc =<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(mod_P3_Rep.lmer2, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">Condition =</span> <span class="kw">c</span>(<span class="st">&quot;neutral - happy = 0&quot;</span>, </span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true"></a>    <span class="st">&quot;neutral - angry = 0&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="dt">type =</span> <span class="st">&quot;fdr&quot;</span>)))</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true"></a></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true"></a><span class="co"># Get ready for presentation in RMarkdown</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true"></a>tab1 =<span class="st"> </span><span class="kw">merge</span>(<span class="kw">as.data.frame</span>(P3_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>coefficients), <span class="kw">as.data.frame</span>(P3_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>sigma), </span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true"></a>    <span class="dt">by =</span> <span class="dv">0</span>)</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true"></a>tab2 =<span class="st"> </span><span class="kw">as.data.frame</span>(P3_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>pvalues)</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true"></a><span class="kw">rownames</span>(tab2) =<span class="st"> </span><span class="kw">rownames</span>(<span class="kw">as.data.frame</span>(P3_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>tstat))</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true"></a>tab2 =<span class="st"> </span><span class="kw">merge</span>(<span class="kw">as.data.frame</span>(P3_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>tstat), tab2, <span class="dt">by =</span> <span class="dv">0</span>)</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true"></a>P3_Rep_posthoc1 =<span class="st"> </span><span class="kw">merge</span>(tab1, tab2, <span class="dt">by =</span> <span class="st">&quot;Row.names&quot;</span>)</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true"></a><span class="kw">colnames</span>(P3_Rep_posthoc1) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Contrast&quot;</span>, <span class="st">&quot;Est.&quot;</span>, <span class="st">&quot;Std. Error&quot;</span>, <span class="st">&quot;z value&quot;</span>, <span class="st">&quot;p value&quot;</span>)</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true"></a></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true"></a></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true"></a><span class="co">### Calculate post-hoc tests P3 valence</span></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true"></a>P3_Rep<span class="op">$</span>interaction =<span class="st"> </span><span class="kw">interaction</span>(P3_Rep<span class="op">$</span>rep, P3_Rep<span class="op">$</span>Condition)</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true"></a></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true"></a></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true"></a>mod_P3_Rep.lmer3 =<span class="st"> </span><span class="kw">lmer</span>(P3_Amplitude <span class="op">~</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>interaction <span class="op">+</span><span class="st"> </span><span class="op">+</span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span></span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true"></a><span class="st">    </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Elect_site), <span class="dt">data =</span> P3_Rep, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true"></a></span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true"></a></span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true"></a>P3_Rep_lmm_model_posthoc =<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(mod_P3_Rep.lmer3, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">interaction =</span> <span class="kw">c</span>(<span class="st">&quot;novel.happy - novel.angry = 0&quot;</span>, </span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true"></a>    <span class="st">&quot;novel.happy - repeated.angry = 0&quot;</span>, <span class="st">&quot;repeated.angry - novel.angry = 0&quot;</span>, <span class="st">&quot;repeated.happy - novel.angry = 0&quot;</span>, </span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true"></a>    <span class="st">&quot;repeated.happy - novel.happy = 0&quot;</span>, <span class="st">&quot;repeated.happy - repeated.angry</span><span class="ch">\t</span><span class="st">= 0&quot;</span>)), </span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true"></a>    <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="dt">type =</span> <span class="st">&quot;fdr&quot;</span>)))</span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true"></a></span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true"></a></span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true"></a><span class="co"># Get ready for presentation in RMarkdown</span></span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true"></a>tab1 =<span class="st"> </span><span class="kw">merge</span>(<span class="kw">as.data.frame</span>(P3_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>coefficients), <span class="kw">as.data.frame</span>(P3_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>sigma), </span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true"></a>    <span class="dt">by =</span> <span class="dv">0</span>)</span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true"></a>tab2 =<span class="st"> </span><span class="kw">as.data.frame</span>(P3_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>pvalues)</span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true"></a><span class="kw">rownames</span>(tab2) =<span class="st"> </span><span class="kw">rownames</span>(<span class="kw">as.data.frame</span>(P3_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>tstat))</span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true"></a>tab2 =<span class="st"> </span><span class="kw">merge</span>(<span class="kw">as.data.frame</span>(P3_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>tstat), tab2, <span class="dt">by =</span> <span class="dv">0</span>)</span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true"></a>P3_Rep_posthoc2 =<span class="st"> </span><span class="kw">merge</span>(tab1, tab2, <span class="dt">by =</span> <span class="st">&quot;Row.names&quot;</span>)</span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true"></a><span class="kw">colnames</span>(P3_Rep_posthoc2) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Contrast&quot;</span>, <span class="st">&quot;Est.&quot;</span>, <span class="st">&quot;Std. Error&quot;</span>, <span class="st">&quot;z value&quot;</span>, <span class="st">&quot;p value&quot;</span>)</span></code></pre></div>
<p><strong>Post-hoc test P3: Contrast Emotion vs. Neutral</strong></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true"></a><span class="co"># Create table</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true"></a><span class="kw">kable</span>(P3_Rep_posthoc1) <span class="op">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&quot;hover&quot;</span>), <span class="dt">font_size =</span> <span class="dv">14</span>, <span class="dt">fixed_thead =</span> T)</span></code></pre></div>
<table class="table table-hover" style="font-size: 14px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Contrast
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Est.
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Std. Error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
z value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
p value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
neutral - angry
</td>
<td style="text-align:right;">
-2.06
</td>
<td style="text-align:right;">
0.421
</td>
<td style="text-align:right;">
-4.90
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
neutral - happy
</td>
<td style="text-align:right;">
-1.03
</td>
<td style="text-align:right;">
0.423
</td>
<td style="text-align:right;">
-2.44
</td>
<td style="text-align:right;">
0.028
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="session-info" class="section level1">
<h1>Session info</h1>
<!-- Provide session info  -->
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true"></a><span class="co"># Get session info</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true"></a><span class="kw">sessionInfo</span>()</span></code></pre></div>
<pre><code>R version 4.0.2 (2020-06-22)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19042)

Matrix products: default

locale:
[1] LC_COLLATE=German_Germany.1252  LC_CTYPE=German_Germany.1252   
[3] LC_MONETARY=German_Germany.1252 LC_NUMERIC=C                   
[5] LC_TIME=German_Germany.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] matrixStats_0.58.0 gvlma_1.0.0.3      eegUtils_0.5.0     forcats_0.5.1     
 [5] stringr_1.4.0      purrr_0.3.4        readr_1.4.0        tidyr_1.1.3       
 [9] tibble_3.1.1       tidyverse_1.3.1    sjlabelled_1.1.7   sjmisc_2.8.6      
[13] sjPlot_2.8.7       Rmisc_1.5          plyr_1.8.6         reshape2_1.4.4    
[17] psych_2.1.3        multcomp_1.4-16    TH.data_1.0-10     mvtnorm_1.1-1     
[21] MASS_7.3-53.1      lmerTest_3.1-3     lme4_1.1-26        Matrix_1.3-2      
[25] Hmisc_4.5-0        Formula_1.2-4      survival_3.2-10    lattice_0.20-41   
[29] ggstatsplot_0.7.2  ggplot2_3.3.3      ez_4.4-0           EnvStats_2.4.0    
[33] dplyr_1.0.5        cowplot_1.1.1      summarytools_0.9.9 miceadds_3.11-6   
[37] mice_3.13.0        rmdformats_1.0.2   XLConnect_1.0.3    kableExtra_1.3.4  

loaded via a namespace (and not attached):
 [1] estimability_1.3       R.methodsS3_1.8.1      coda_0.19-4           
 [4] knitr_1.32             R.utils_2.10.1         data.table_1.14.0     
 [7] rpart_4.1-15           generics_0.1.0         future_1.21.0         
[10] correlation_0.6.1      webshot_0.5.2          xml2_1.3.2            
[13] lubridate_1.7.10       httpuv_1.5.5           assertthat_0.2.1      
[16] viridis_0.6.0          WRS2_1.1-1             xfun_0.22             
[19] hms_1.0.0              jquerylib_0.1.3        rJava_0.9-13          
[22] evaluate_0.14          promises_1.2.0.1       fansi_0.4.2           
[25] dbplyr_2.1.1           readxl_1.3.1           DBI_1.1.1             
[28] tmvnsim_1.0-2          htmlwidgets_1.5.3      reshape_0.8.8         
[31] kSamples_1.2-9         Rmpfr_0.8-4            paletteer_1.3.0       
[34] ellipsis_0.3.1         backports_1.2.1        signal_0.7-6          
[37] bookdown_0.21          insight_0.13.2         ggcorrplot_0.1.3      
[40] rapportools_1.0        vctrs_0.3.7            abind_1.4-5           
[43] cachem_1.0.4           withr_2.4.2            pryr_0.1.4            
[46] checkmate_2.0.0        emmeans_1.5.5-1        mnormt_2.0.2          
[49] svglite_2.0.0          cluster_2.1.2          lazyeval_0.2.2        
[52] crayon_1.4.1           labeling_0.4.2         pkgconfig_2.0.3       
[55] SuppDists_1.1-9.5      nlme_3.1-152           statsExpressions_1.0.1
[58] nnet_7.3-15            rlang_0.4.10           globals_0.14.0        
[61] lifecycle_1.0.0        miniUI_0.1.1.1         MatrixModels_0.5-0    
[64] sandwich_3.0-0         modelr_0.1.8           cellranger_1.1.0      
[67] tcltk_4.0.2            mc2d_0.1-19            carData_3.0-4         
[70] boot_1.3-27            zoo_1.8-9              reprex_2.0.0          
[73] base64enc_0.1-3        png_0.1-7              viridisLite_0.4.0     
 [ reached getOption(&quot;max.print&quot;) -- omitted 91 entries ]</code></pre>
</div>
</div>

<div class="col-xs-2">

<div class = "btn-toolbar">
<div class="btn-group">
<a class="btn btn-raised btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" href="#"><span>Code</span> <span class="caret"></span></a>
<ul class="dropdown-menu" style="min-width: 50px;">

<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>

</ul>
</div>
</div>

</div>
</div>
	


</div>
</div>

 <script>
    $(document).ready(function () {
	// add bootstrap table styles to pandoc tables
	$('tr.header').parent('thead').parent('table').addClass('table table-striped table-hover');
	
	
		$('.pages img').addClass("image-lb");
	$('.pages').magnificPopup({
	    type:'image',
	    closeOnContentClick: false,
	    closeBtnInside: false,
            delegate: '.image-lb',
	    gallery: {enabled: true },
            removalDelay: 500,
            callbacks: {
		beforeOpen: function() {
                    // just a hack that adds mfp-anim class to markup
                    this.st.image.markup = this.st.image.markup.replace('mfp-figure', 'mfp-figure mfp-with-anim');
		}
            },
            mainClass: 'mfp-move-from-top',
	    image: {
	        verticalFit: true,
		titleSrc: 'alt'
	    }
 	});
 	
	  
	$('#toc ul li').first().addClass("active");
	$('#toc ul li').attr("data-target", function() {
            return($(this).children("a").attr("href"));
	})
	$('body .section.level1').first().addClass("active");
	$('body .section.level1').not('.active').hide();
	
	$('#toc a[href*="#"], a[href^="#"]').click(function() {
	    var id = $(this).attr("href");
	    if (id === "#") return;
	    if (id.substring(0, 8) === "#dyntab-") return;
	    // Menu
	    var menu_entry = $(".menu li[data-target='"+id+"']");
	    if (menu_entry.length == 0) {
		window.location.hash = id;
		return;
	    }
	    menu_entry.addClass("active");
	    $(".menu li").not(menu_entry).removeClass("active"); 
	    toggle_page(id);
	});

	function toggle_page(id) {
	    $(".page").not(page).removeClass("active").hide();
	    window.page = id;
	    var page = $(window.page);
	    window.location.hash = window.page;
	    //$(this).addClass("active");
	    page.show();

	    var totop = setInterval(function () {
		$(".pages").animate({scrollTop: 0}, 0);
	    }, 10);

	    setTimeout(function () {
		page.addClass("active");
		setTimeout(function () {
		    clearInterval(totop);
		}, 1000);
	    }, 100);
	    
	    window.dispatchEvent(new Event('resize'));
	}


	$(".menu li").click(function () {
	    toggle_page($(this).data("target"));
	    // Menu
	    if (!$(this).data("target")) return;
	    if ($(this).is(".active")) return;
	    $(".menu li").not($(this)).removeClass("active");
	    $(this).addClass("active");
	});
  
	  
	window.page = window.location.hash;
	if (window.page != "") {
	    $(".menu").find("li[data-target=" + window.page + "]").trigger("click");
	}
	/* init material bootstrap js */
	$.material.init();
    });
 </script>


  <!-- dynamically load mathjax for compatibility with self-contained -->
 <script>
   (function () {
       var script = document.createElement("script");
       script.type = "text/javascript";
       script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
       document.getElementsByTagName("head")[0].appendChild(script);
   })();
 </script>
 
</body>
</html>
