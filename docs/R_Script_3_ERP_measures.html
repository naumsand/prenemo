<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

    
    
    <title>ERP measures</title>
    <!-- Material Design fonts -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/icon?family=Material+Icons">

        <script src="site_libs/header-attrs-2.7/header-attrs.js"></script>
        <script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="site_libs/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="site_libs/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
        <script src="site_libs/navigation-1.1/tabsets.js"></script>
        <script src="site_libs/navigation-1.1/codefolding.js"></script>
        <link href="site_libs/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
        <script src="site_libs/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
        <link href="site_libs/bootstrap_material-0.1/bootstrap-material-design.min.css" rel="stylesheet" />
        <link href="site_libs/bootstrap_material-0.1/ripples.min.css" rel="stylesheet" />
        <script src="site_libs/bootstrap_material-0.1/material.min.js"></script>
        <script src="site_libs/bootstrap_material-0.1/ripples.min.js"></script>
        <link href="site_libs/material-0.1/material.css" rel="stylesheet" />
        <script src="site_libs/material-0.1/material.js"></script>
        <script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
        <link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
        <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
        <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
    
    
        <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          background-color: #ffffff;
          color: #a0a0a0;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
      div.sourceCode
        { color: #1f1c1b; background-color: #ffffff; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span { color: #1f1c1b; } /* Normal */
      code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
      code span.an { color: #ca60ca; } /* Annotation */
      code span.at { color: #0057ae; } /* Attribute */
      code span.bn { color: #b08000; } /* BaseN */
      code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
      code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #924c9d; } /* Char */
      code span.cn { color: #aa5500; } /* Constant */
      code span.co { color: #898887; } /* Comment */
      code span.cv { color: #0095ff; } /* CommentVar */
      code span.do { color: #607880; } /* Documentation */
      code span.dt { color: #0057ae; } /* DataType */
      code span.dv { color: #b08000; } /* DecVal */
      code span.er { color: #bf0303; text-decoration: underline; } /* Error */
      code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
      code span.fl { color: #b08000; } /* Float */
      code span.fu { color: #644a9b; } /* Function */
      code span.im { color: #ff5500; } /* Import */
      code span.in { color: #b08000; } /* Information */
      code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
      code span.op { color: #1f1c1b; } /* Operator */
      code span.ot { color: #006e28; } /* Other */
      code span.pp { color: #006e28; } /* Preprocessor */
      code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
      code span.sc { color: #3daee9; } /* SpecialChar */
      code span.ss { color: #ff5500; } /* SpecialString */
      code span.st { color: #bf0303; } /* String */
      code span.va { color: #0057ae; } /* Variable */
      code span.vs { color: #bf0303; } /* VerbatimString */
      code span.wa { color: #bf0303; } /* Warning */
    </style>
    
        <link rel="stylesheet" href="web_style.css" type="text/css" />
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
        <script>
      $(document).ready(function () {
	  	  	  window.initializeCodeFolding("hide" === "show");
	        });
    </script>
    
    <!-- code download -->
    

    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .pages .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .pages .tabset-dropdown > .nav-tabs > li.active > a {
	  background-color: transparent !important;
	  color: #000000 !important;
      }
      
      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
	  color: #00A698 !important;
	  font-weight: 300 !important;
	  font-size: 14px;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
      }
    </style>
    
</head>

<body>

  <div class="header-panel shadow z-2">
    <div class="container-fluid">
      <div class="row">
        <div class="col-xs-3">
	  	  <div id="header">
	    <h1 class="title">ERP measures</h1>
	    	    	    	  </div>
	  	</div>
      </div>
    </div>
  </div>
  
  <div class="container-fluid main-container">
    <div class="row">

<nav class="col-xs-3 menu">
<div id="toc">
<ul>
<li><a href="#task-description">Task description</a></li>
<li><a href="#erp-results">ERP results</a></li>
<li><a href="#session-info">Session info</a></li>
</ul>
</div>
</nav>
      
<div class="pages col-xs-9">

        
<div class="row">

<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Naumann et al.</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="glyphicon glyphicon-info-sign"></span>
     
    Data description
  </a>
</li>
<li>
  <a href="R_Script_1_Sample_descr.html">
    <span class="glyphicon glyphicon-user"></span>
     
    Sample description
  </a>
</li>
<li>
  <a href="R_Script_2_EEG_task_measures.html">
    <span class="glyphicon glyphicon-hand-up"></span>
     
    Del. match-to-sample task
  </a>
</li>
<li>
  <a href="R_Script_3_ERP_measures.html">
    <span class="glyphicon glyphicon-flash"></span>
     
    ERP measures
  </a>
</li>
<li>
  <a href="R_Script_4_Emotion_empathy_measures.html">
    <span class="glyphicon glyphicon-link"></span>
     
    Emotion &amp; Empathy measures
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://osf.io/nas48/">
    <span class="ai ai ai ai-osf ai-lg"></span>
     
  </a>
</li>
<li>
  <a href="mailto:sandra.naumann@hu-berlin.de">
    <span class="fas fa-envelope fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<link rel="stylesheet" href="https://cdn.rawgit.com/jpswalsh/academicons/master/css/academicons.min.css">
</div>

    
<div class="row">

<div class="col-xs-10">
<!-- Set up workspace -->
<!-- Load and prepare data set -->
<div id="task-description" class="section level1">
<h1>Task description</h1>
<p>We developed an emotion priming paradigm combined with a delayed-match-to-sample-task to examine categorical differences in facial expression processing in young children. In particular, EEG was recorded while preschoolers observed pairs of faces presented sequentially. In some trials, the two sequential facial stimuli (hereafter: ‘Face 1’ and ‘Face 2’) were identical, while in other trials they differed with regards to the facial expression displayed (happy, angry, or neutral).</p>
<p>We calculated linear mixed models (LMM) separately for each ERP component. As fixed factors, all models included treatment contrasts for <em>facial expressions</em> (<code>emotional [average of happy/angry] vs. neutral faces (Emo_Neu)</code>, <code>happy vs. angry faces (Hap_Ang)</code>), <em>repetition</em> (<code>novel vs. repeated emotion trials (Rep_Nov)</code>) as well as their interaction (<code>Emo_NeuxRep_Nov, Hap_AngxRep_Nov</code>). Working memory (<code>WM_scal</code>) was entered as a scaled covariate in all LMM analyses to control for cognitive task demands. Additionally, we entered stimulus contrast (<code>contr_F2_scal</code>) as a scaled covariate to control for low-level differences. The random effects structure included random intercepts for participants (<code>(1|ID)</code>), stimulus (<code>(1|Stim_Type)</code>) and electrodes (<code>(1|Elect_site)</code>). Assumptions for multiple regression were checked for all models (normality of the residuals, linearity, multicollinearity, homoscedasticity).</p>
<p>We predicted that amplitudes would be larger for emotional compared to neutral facial expressions. We expected happy facial expressions to elicit the largest amplitudes, followed by angry and neutral facial expressions. Assuming that comprehensive facial expression representations are in place for young children, we expected an amplitude decrease in response to identical facial expressions. Again, we predicted that happy facial expressions would elicit the largest amplitude reduction compared to angry or neutral expressions because they are the most readily processed.</p>
</div>
<div id="erp-results" class="section level1">
<h1>ERP results</h1>
<p><br></p>
<div id="descriptive-statistics" class="section level3">
<h3><strong>Descriptive statistics</strong></h3>
<p><br><br></p>
<p><em>ERP waveforms and topographies at Face 2.</em> ERP waveforms and topographies at Face 2. Top left: Grand-averaged P1 and P3 waveforms for novel and repeated happy, angry and neutral facial expressions. Shadowed areas indicate the time windows used to identify participants' individual peaks and mean amplitudes. Top right: Grand-averaged P1 amplitudes at Face 2 for repeated andbnovel happy, angry and neutral facial expressions. Error bars indicate standard errors (SE). Bottom: Topographies of the averaged P1 activity (90-130 ms) displaying difference waves for significant contrasts of the Repetition x Facial Expression interaction (from the left): novel happy–repeated happy and novel happy–novel angry.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a>  <span class="co"># Calculate condtional mean </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a>   Face2_data_cond =<span class="st">  </span><span class="kw">aggregate</span>(Face2_data_icc<span class="op">$</span>data, <span class="dt">FUN=</span>mean, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a>          <span class="dt">by=</span><span class="kw">list</span>(<span class="dt">time=</span>Face2_data_icc<span class="op">$</span>time, <span class="dt">Condition=</span>Face2_data_icc<span class="op">$</span>Condition))  </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a>  </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a>  P1_rep_all_traj =<span class="st"> </span><span class="kw">ggplot</span>(Face2_data_cond, <span class="kw">aes</span>(time,x))<span class="op">+</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),<span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill=</span><span class="ot">NA</span>, <span class="dt">size=</span><span class="dv">2</span>),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true"></a>          <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)),</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true"></a>          <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)),</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true"></a>          <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>),</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true"></a>          <span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>,<span class="dt">legend.title=</span><span class="kw">element_blank</span>())<span class="op">+</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true"></a><span class="st">    </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean,<span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="fl">0.4</span>, <span class="kw">aes</span>(<span class="dt">linetype =</span> Condition, <span class="dt">colour =</span> Condition))<span class="op">+</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;dotted&quot;</span>,<span class="st">&quot;longdash&quot;</span>,<span class="st">&quot;solid&quot;</span>,<span class="st">&quot;dotted&quot;</span>,<span class="st">&quot;longdash&quot;</span>,<span class="st">&quot;solid&quot;</span>))<span class="op">+</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span> (<span class="st">&quot;#134462&quot;</span>,<span class="st">&quot;#134462&quot;</span>,<span class="st">&quot;#134462&quot;</span>,<span class="st">&quot;#2FA9F5&quot;</span>,<span class="st">&quot;#2FA9F5&quot;</span>,<span class="st">&quot;#2FA9F5&quot;</span>))<span class="op">+</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true"></a><span class="st">    </span><span class="co">#ggtitle(&quot;P1 &amp; P3&quot;) +</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">Time [ms]&quot;</span>,<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude [&quot;</span>,mu,<span class="st">&quot;V]&quot;</span>)),<span class="dt">colour =</span> <span class="st">&quot;&quot;</span>)<span class="op">+</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">18</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">600</span>)) <span class="op">+</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">18</span>,<span class="dv">4</span>))<span class="op">+</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">600</span>,<span class="dv">200</span>))<span class="op">+</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>,<span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;grey&quot;</span> )<span class="op">+</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>,<span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;grey&quot;</span>)<span class="op">+</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true"></a><span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="dt">xmin =</span> <span class="dv">90</span>, <span class="dt">xmax =</span> <span class="dv">130</span>, <span class="dt">ymin =</span> <span class="fl">-2.5</span>, <span class="dt">ymax =</span> <span class="fl">18.5</span>, <span class="dt">alpha =</span> <span class="fl">.3</span>)<span class="op">+</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true"></a><span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="dt">xmin =</span> <span class="dv">300</span>, <span class="dt">xmax =</span> <span class="dv">500</span>, <span class="dt">ymin =</span> <span class="fl">-2.5</span>, <span class="dt">ymax =</span> <span class="fl">18.5</span>, <span class="dt">alpha =</span> <span class="fl">.3</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true"></a>  </span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true"></a>  <span class="kw">load.Rdata</span>(<span class="dt">filename=</span><span class="st">&quot;./data/ERP_data.Rdata&quot;</span>, <span class="st">&quot;ERPs&quot;</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true"></a><span class="co">## Select data</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true"></a>  ERPs_sel =<span class="st"> </span><span class="kw">subset</span>(ERPs, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true"></a>                             <span class="op">&amp;</span><span class="st"> </span>Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true"></a>                             <span class="op">&amp;</span><span class="st"> </span>Group_pcic <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">|</span><span class="st"> </span>Group_pcic <span class="op">==</span><span class="st"> </span><span class="dv">3</span>)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true"></a><span class="co"># Rename values of Face2 condition</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true"></a>  ERPs_sel<span class="op">$</span>Condition[ERPs_sel<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">4</span>]=<span class="st">&#39;angry&#39;</span>;</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true"></a>  ERPs_sel<span class="op">$</span>Condition[ERPs_sel<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">5</span>]=<span class="st">&#39;happy&#39;</span>;</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true"></a>  ERPs_sel<span class="op">$</span>Condition[ERPs_sel<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">6</span>]=<span class="st">&#39;neutral&#39;</span>;</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true"></a>  ERPs_sel<span class="op">$</span>Condition[ERPs_sel<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">7</span>]=<span class="st">&#39;angry&#39;</span>;</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true"></a>  ERPs_sel<span class="op">$</span>Condition[ERPs_sel<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">8</span>]=<span class="st">&#39;happy&#39;</span>;</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true"></a>  ERPs_sel<span class="op">$</span>Condition[ERPs_sel<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">9</span>]=<span class="st">&#39;neutral&#39;</span>;</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true"></a></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true"></a><span class="co"># Rename variables</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true"></a>  ERPs_sel<span class="op">$</span>Group_pcic[ERPs_sel<span class="op">$</span>Group_pcic <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;novel&quot;</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true"></a>  ERPs_sel<span class="op">$</span>Group_pcic[ERPs_sel<span class="op">$</span>Group_pcic <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] =<span class="st"> &quot;repeated&quot;</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true"></a></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true"></a><span class="co"># Summarize data</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true"></a>  stats_P1_all =<span class="st"> </span><span class="kw">summarySEwithin</span>(ERPs_sel, <span class="dt">measurevar=</span><span class="st">&quot;mean_ROI_P1&quot;</span>, <span class="dt">withinvars=</span><span class="kw">c</span>(<span class="st">&quot;Group_pcic&quot;</span>,<span class="st">&quot;Condition&quot;</span>), <span class="dt">idvar =</span> <span class="st">&quot;ID&quot;</span>)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true"></a></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true"></a><span class="co"># Plot</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true"></a>  P1_plot =<span class="st"> </span><span class="kw">ggplot</span>(stats_P1_all, <span class="kw">aes</span>(<span class="dt">x=</span>Condition, <span class="dt">y=</span>mean_ROI_P1, <span class="dt">fill =</span> Group_pcic)) <span class="op">+</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">position=</span><span class="kw">position_dodge</span>(), <span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="fl">0.5</span>,<span class="dt">width=</span><span class="fl">0.9</span>)<span class="op">+</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>mean_ROI_P1<span class="op">-</span>se, <span class="dt">ymax=</span>mean_ROI_P1<span class="op">+</span>se),</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true"></a>                  <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">width=</span><span class="fl">0.2</span>, <span class="dt">position=</span><span class="kw">position_dodge</span>(.<span class="dv">9</span>)) <span class="op">+</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span> (<span class="dt">x=</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude [&quot;</span>,mu,<span class="st">&quot;V]&quot;</span>)),<span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span>nov_col)<span class="op">+</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">20</span>)) <span class="op">+</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">25</span>,<span class="dv">5</span>))<span class="op">+</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true"></a><span class="st">    </span>theme_SN <span class="op">+</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;left&quot;</span>, <span class="dt">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>,</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true"></a>           <span class="dt">legend.key.size =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true"></a>           <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="fl">0.5</span>,<span class="st">&quot;cm&quot;</span>),</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true"></a>           <span class="dt">legend.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">7</span>), <span class="dt">text=</span><span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>), <span class="dt">legend.title =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true"></a>           <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">20</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)))</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true"></a>  </span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true"></a>  legend_behav =<span class="st"> </span><span class="kw">get_legend</span>(P1_plot)</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true"></a>    </span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true"></a>  </span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true"></a><span class="co"># Put plots together</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true"></a>  plots_EEG_F2 =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true"></a>    P1_rep_all_traj <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>),</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true"></a>    legend_ERP, legend_behav,</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true"></a>    <span class="dt">align =</span> <span class="st">&#39;vh&#39;</span>,</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true"></a>    <span class="dt">hjust =</span> <span class="dv">-1</span>,</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true"></a>    <span class="dt">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true"></a>    <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">.3</span>, <span class="fl">.3</span>))</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true"></a>  </span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true"></a></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true"></a>  plots_EEG_F2_<span class="dv">2</span> =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true"></a>   <span class="co"># legend_behav,</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true"></a>    P1_plot <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>),</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true"></a>    <span class="dt">align =</span> <span class="st">&#39;vh&#39;</span>,</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true"></a>    <span class="dt">hjust =</span> <span class="dv">-1</span>,</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true"></a>    <span class="dt">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true"></a>    <span class="dt">rel_widths =</span> <span class="kw">c</span>(.<span class="dv">4</span>, <span class="dv">1</span>))</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true"></a>  </span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true"></a><span class="co"># Display plot</span></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true"></a><span class="co"># https://wilkelab.org/cowplot/articles/shared_legends.html</span></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true"></a>  fig_rep_ERP =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(plots_EEG_F2, plots_EEG_F2_<span class="dv">2</span>,<span class="dt">rel_widths =</span> <span class="kw">c</span>(.<span class="dv">7</span>,.<span class="dv">6</span>))</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true"></a></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true"></a><span class="co"># Get topographies  </span></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true"></a>  Topo_Cat =<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file=</span><span class="st">&quot;./data/ERPs_Topo_Face2.csv&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">sep=</span><span class="st">&quot;,&quot;</span>)</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true"></a></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true"></a><span class="co"># Remove participant 5</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true"></a>  Topo_Cat =<span class="st"> </span>Topo_Cat[<span class="kw">with</span>(Topo_Cat, <span class="op">!</span>(Topo_Cat<span class="op">$</span>ID<span class="op">==</span><span class="dv">5</span>)), ]</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true"></a></span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true"></a><span class="co"># Re-name to fit topoplot function</span></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true"></a>  <span class="kw">names</span>(Topo_Cat)[<span class="kw">names</span>(Topo_Cat) <span class="op">==</span><span class="st"> &quot;Time&quot;</span>] =<span class="st"> &quot;time&quot;</span></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true"></a></span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true"></a><span class="co"># Change from wide to long format for electrodes</span></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true"></a>  Topo_Cat =<span class="st"> </span><span class="kw">gather</span>(Topo_Cat, electrode, amplitude, Fp1<span class="op">:</span>Oz, <span class="dt">factor_key=</span><span class="ot">TRUE</span>)</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true"></a></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true"></a><span class="co"># Rename A1/A2</span></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true"></a>  <span class="kw">names</span>(Topo_Cat)[<span class="kw">names</span>(Topo_Cat) <span class="op">==</span><span class="st"> &quot;A1&quot;</span>] =<span class="st"> &quot;TP9&quot;</span></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true"></a>  <span class="kw">names</span>(Topo_Cat)[<span class="kw">names</span>(Topo_Cat) <span class="op">==</span><span class="st"> &quot;A2&quot;</span>] =<span class="st"> &quot;TP10&quot;</span></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true"></a></span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true"></a><span class="co"># Plot topoplots for repeated / novel emotion trials</span></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true"></a>  Topo_rep_hap =<span class="st"> </span><span class="kw">subset</span>(Topo_Cat, Condition <span class="op">==</span><span class="st"> </span><span class="dv">4</span>)</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true"></a>  Topo_nov_hap =<span class="st"> </span><span class="kw">subset</span>(Topo_Cat, Condition <span class="op">==</span><span class="st"> </span><span class="dv">7</span>)</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true"></a>  Topo_nov_ang =<span class="st"> </span><span class="kw">subset</span>(Topo_Cat, Condition <span class="op">==</span><span class="st"> </span><span class="dv">9</span>)</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true"></a></span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true"></a></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true"></a><span class="co"># Calculate difference scores for different contrasts</span></span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true"></a>  Topo_Diff_nov_hap_rep_hap =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> Topo_rep_hap[,<span class="dv">1</span>], <span class="dt">time =</span> Topo_rep_hap[,<span class="dv">3</span>],</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true"></a>                                  <span class="dt">electrode =</span> Topo_rep_hap[,<span class="dv">4</span>], <span class="dt">amplitude =</span> Topo_nov_hap<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span>Topo_rep_hap<span class="op">$</span>amplitude)</span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true"></a>  </span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true"></a>  Topo_Diff_nov_hap_nov_ang =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> Topo_nov_hap[,<span class="dv">1</span>], <span class="dt">time =</span> Topo_nov_hap[,<span class="dv">3</span>],</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true"></a>                                  <span class="dt">electrode =</span> Topo_nov_hap[,<span class="dv">4</span>], <span class="dt">amplitude =</span> Topo_nov_hap<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span>Topo_nov_ang<span class="op">$</span>amplitude)</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true"></a>  </span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true"></a>  </span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true"></a></span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true"></a><span class="co">## P1</span></span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true"></a></span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true"></a><span class="co"># Select time windows</span></span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true"></a>  Topo_Diff_nov_hap_rep_hap_P1 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_nov_hap_rep_hap, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">90</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">130</span>)</span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true"></a>  Topo_Diff_nov_hap_nov_ang_P1 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_nov_hap_nov_ang, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">90</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">130</span>)</span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true"></a>  </span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true"></a><span class="co"># Add electrode information  </span></span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true"></a>  Topo_Diff_nov_hap_rep_hap_P1 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_nov_hap_rep_hap_P1, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>,  <span class="dt">drop =</span> <span class="ot">FALSE</span>,<span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true"></a>  Topo_Diff_nov_hap_nov_ang_P1 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_nov_hap_nov_ang_P1, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>,  <span class="dt">drop =</span> <span class="ot">FALSE</span>,<span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true"></a>  </span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true"></a></span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true"></a><span class="co"># Create topographies  </span></span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true"></a>  topo_diff_nov_hap_rep_hap_P1 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_nov_hap_rep_hap_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span></span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true"></a><span class="st">                    </span><span class="kw">ggtitle</span>(<span class="st">&quot;nov. hap. \u2013 rep. hap.&quot;</span>)<span class="op">+</span></span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true"></a><span class="st">                    </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>, <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span></span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true"></a><span class="st">                    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span> , <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">2.5</span>,<span class="fl">3.5</span>)) <span class="op">+</span></span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true"></a><span class="st">                    </span><span class="kw">theme_void</span>() <span class="op">+</span></span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true"></a><span class="st">                    </span><span class="kw">coord_equal</span>() <span class="op">+</span></span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true"></a><span class="st">                    </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu,<span class="st">&quot;V)&quot;</span>)))<span class="op">+</span></span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true"></a><span class="st">                    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true"></a></span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true"></a>  </span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true"></a>  topo_diff_nov_hap_nov_ang_P1 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_nov_hap_nov_ang_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span></span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true"></a><span class="st">                    </span><span class="kw">ggtitle</span>(<span class="st">&quot;nov. hap. \u2013 nov. ang.&quot;</span>)<span class="op">+</span></span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true"></a><span class="st">                    </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>,<span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span></span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true"></a><span class="st">                    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span> , <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">2.5</span>,<span class="fl">3.5</span>)) <span class="op">+</span></span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true"></a><span class="st">                    </span><span class="kw">theme_void</span>() <span class="op">+</span></span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true"></a><span class="st">                    </span><span class="kw">coord_equal</span>() <span class="op">+</span></span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true"></a><span class="st">                    </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu,<span class="st">&quot;V)&quot;</span>)))<span class="op">+</span></span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true"></a><span class="st">                    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true"></a></span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true"></a></span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true"></a><span class="co"># Get topography legend </span></span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true"></a>  topo_diff_nov_hap_P1_leg =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_nov_hap_rep_hap_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span></span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true"></a><span class="st">                    </span><span class="kw">ggtitle</span>(<span class="st">&quot;P1 (90-130 ms)&quot;</span>)<span class="op">+</span></span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true"></a><span class="st">                    </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>,</span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true"></a>                              <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span></span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true"></a><span class="st">                    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span> , <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">2.5</span>,<span class="fl">3.5</span>)) <span class="op">+</span></span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true"></a><span class="st">                    </span><span class="kw">theme_void</span>() <span class="op">+</span></span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true"></a><span class="st">                    </span><span class="kw">coord_equal</span>() <span class="op">+</span></span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true"></a><span class="st">                    </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;&quot;</span>, mu,<span class="st">&quot;V&quot;</span>)))<span class="op">+</span></span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true"></a><span class="st">                    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">legend.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>), <span class="dt">legend.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">7</span>),</span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true"></a>                          <span class="dt">legend.key.size =</span> <span class="kw">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>))  </span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true"></a>     </span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true"></a></span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true"></a><span class="co">## Display plots</span></span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true"></a>  <span class="co"># https://wilkelab.org/cowplot/articles/shared_legends.html</span></span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true"></a>  topo_leg =<span class="st"> </span><span class="kw">get_legend</span>(topo_diff_nov_hap_P1_leg)  </span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true"></a>  </span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true"></a>  fig_Face_<span class="dv">2</span>_topo =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(topo_diff_nov_hap_rep_hap_P1, topo_diff_nov_hap_nov_ang_P1, topo_leg, <span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true"></a>  </span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true"></a>  fig_Face2_cat =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(fig_rep_ERP, fig_Face_<span class="dv">2</span>_topo, <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">rel_heights =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>), <span class="dt">align =</span> <span class="st">&quot;v&quot;</span>)</span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true"></a>  </span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true"></a>  <span class="co">#fig_Face2_cat = cowplot::plot_grid(plots_EEG_F2, fig_Face_2_topo, nrow = 2, rel_heights = c(2, 1), align = &quot;v&quot;)</span></span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true"></a>  </span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true"></a>  fig_Face2_cat</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/ERP_rep_plot-1.png" width="768" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a>  <span class="co"># Save figure for publication   </span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a>  <span class="co">#ggsave(&quot;Figure_X_DMTST_ERPs.tiff&quot;, plot = last_plot(), dpi = 300)</span></span></code></pre></div>
<p><br><br></p>
<hr />
</div>
<div id="model-specification" class="section level3 tabset tabset-pills">
<h3 class="tabset tabset-pills"><strong>Model specification</strong></h3>
<div id="lmm-p1-random-effect-structure" class="section level4">
<h4>LMM P1: Random effect structure</h4>
<p><br></p>
<p>The final model was:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="co"># Select correct responses and outlier-free data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a>P1_Rep =<span class="st"> </span><span class="kw">subset</span>(ERP_data, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a><span class="co"># Prepare fixed factors</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true"></a>P1_Rep<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(P1_Rep<span class="op">$</span>ID)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(P1_Rep<span class="op">$</span>Stim_Type)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true"></a><span class="co"># Define novel vs repeated trials</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true"></a>P1_Rep<span class="op">$</span>rep[P1_Rep<span class="op">$</span>Group_cic <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;repeated&quot;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true"></a>P1_Rep<span class="op">$</span>rep[P1_Rep<span class="op">$</span>Group_cic <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;novel&quot;</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true"></a><span class="co"># Rename variables</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true"></a>P1_Rep<span class="op">$</span>PT[P1_Rep<span class="op">$</span>Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;prime&quot;</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true"></a>P1_Rep<span class="op">$</span>PT[P1_Rep<span class="op">$</span>Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;target&quot;</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true"></a><span class="co"># Rename variables</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Response[P1_Rep<span class="op">$</span>Response <span class="op">==</span><span class="st"> </span><span class="dv">0</span>] =<span class="st"> &quot;false&quot;</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Response[P1_Rep<span class="op">$</span>Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;correct&quot;</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true"></a><span class="co"># Define emotions</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Condition[P1_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Condition[P1_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Condition[P1_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Condition[P1_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">4</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Condition[P1_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">5</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Condition[P1_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">6</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Condition[P1_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">7</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Condition[P1_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">8</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Condition[P1_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">9</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true"></a></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true"></a><span class="co"># Factor and create contrasts</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true"></a>P1_Rep<span class="op">$</span>rep =<span class="st"> </span><span class="kw">factor</span>(P1_Rep<span class="op">$</span>rep)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true"></a>P1_Rep<span class="op">$</span>PT =<span class="st"> </span><span class="kw">factor</span>(P1_Rep<span class="op">$</span>PT)</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Response =<span class="st"> </span><span class="kw">factor</span>(P1_Rep<span class="op">$</span>Response)</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true"></a></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true"></a><span class="kw">contrasts</span>(P1_Rep<span class="op">$</span>rep) =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>)  <span class="co"># intercept is the mean of repeated / novel</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true"></a></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Condition =<span class="st"> </span><span class="kw">factor</span>(P1_Rep<span class="op">$</span>Condition)</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true"></a><span class="kw">contrasts</span>(P1_Rep<span class="op">$</span>Condition) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>, <span class="dt">base =</span> <span class="dv">3</span>)</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true"></a></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true"></a><span class="co"># A = angry, N = neutral, H = happy</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true"></a>HvsA =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">-0.5</span>, <span class="dv">0</span>)  <span class="co"># compare: happy vs. angry</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true"></a>EvsN =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.25</span>, <span class="fl">-0.25</span>, <span class="fl">0.5</span>)  <span class="co"># compare happy/angry to neutral</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true"></a><span class="kw">contrasts</span>(P1_Rep<span class="op">$</span>Condition) =<span class="st"> </span><span class="kw">cbind</span>(EvsN, HvsA)</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true"></a></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true"></a></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true"></a><span class="co"># Bring electrodes in one variable</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true"></a>P1_Rep =<span class="st"> </span><span class="kw">gather</span>(P1_Rep, Elect_site, P1_Amplitude, P1_PO3<span class="op">:</span>P1_Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true"></a></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Elect_site =<span class="st"> </span><span class="kw">factor</span>(P1_Rep<span class="op">$</span>Elect_site)</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true"></a>P1_Rep =<span class="st"> </span><span class="kw">subset</span>(P1_Rep, PT <span class="op">==</span><span class="st"> &quot;target&quot;</span>)</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true"></a></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true"></a><span class="co"># Build full model</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true"></a>mod_P1_Rep.lmer =<span class="st"> </span><span class="kw">lmer</span>(P1_Amplitude <span class="op">~</span><span class="st"> </span>Condition <span class="op">*</span><span class="st"> </span>rep <span class="op">+</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true"></a><span class="st">    </span><span class="op">+</span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Elect_site), <span class="dt">data =</span> P1_Rep, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span></code></pre></div>
<p><code>P1_Amplitude ~ Condition * rep + contr_F2_scal + WM_scal + +(1 | ,     ID) + (1 | Stim_Type) + (1 | Elect_site)</code></p>
<hr />
</div>
<div id="lmm_p1-normality-of-residuals" class="section level4">
<h4>LMM_P1: Normality of residuals</h4>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="co">## Check properties of DV / residuals</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a>P1_Rep<span class="op">$</span>Trans_P1 =<span class="st"> </span>P1_Rep<span class="op">$</span>mean_ROI_P1 <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(P1_Rep<span class="op">$</span>mean_ROI_P1)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a><span class="co"># To make sure residuals follow ND: Calculate box-cox plot</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a><span class="kw">boxcox</span>(P1_Rep<span class="op">$</span>Trans_P1 <span class="op">~</span><span class="st"> </span>P1_Rep<span class="op">$</span>Group_pcic)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P1_val_res_box-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>P1 amplitudes met the assumption of normally distributed residuals.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="co"># Visualize normality assumption of residuals (without log transform)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a>mod_P1_Rep =<span class="st"> </span><span class="kw">lm</span>(Trans_P1 <span class="op">~</span><span class="st"> </span>Group_pcic, <span class="dt">data =</span> P1_Rep)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a>res.mod_P1_Rep =<span class="st"> </span><span class="kw">residuals</span>(mod_P1_Rep)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true"></a>qqpl_mod_P1_Rep =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_P1_Rep, <span class="dt">main =</span> <span class="st">&quot;QQplot before transformation&quot;</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true"></a>norm_mod_P1_Rep =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_P1_Rep), <span class="dt">main =</span> <span class="st">&quot;Density plot before transformation&quot;</span>)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P1_rep_res_plot-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<hr />
</div>
<div id="lmm-p1-homoscedasticity" class="section level4">
<h4>LMM P1: Homoscedasticity</h4>
<p>Based on visual inspection, we assumed homoscedasticity.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="co"># Check homoscedasticity</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">fitted</span>(mod_P1_Rep.lmer), <span class="kw">residuals</span>(mod_P1_Rep.lmer))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P1_rep_homosk-1.png" width="576" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="lmm-n170-random-effect-structure" class="section level4">
<h4>LMM N170: Random effect structure</h4>
<p><br> The final model was:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="co"># Select correct responses and outlier-free data</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a>N170_Rep =<span class="st"> </span><span class="kw">subset</span>(ERP_data, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true"></a><span class="co"># Prepare fixed factors</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true"></a>N170_Rep<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(N170_Rep<span class="op">$</span>ID)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(N170_Rep<span class="op">$</span>Stim_Type)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true"></a><span class="co"># Single electrodes</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true"></a>N170_Rep =<span class="st"> </span><span class="kw">gather</span>(N170_Rep, Elect_site, N170_Amplitude, N170l_TP7<span class="op">:</span>N170r_P8, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Elect_site =<span class="st"> </span><span class="kw">factor</span>(N170_Rep<span class="op">$</span>Elect_site)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true"></a><span class="co"># Define novel vs repeated trials</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true"></a>N170_Rep<span class="op">$</span>rep[N170_Rep<span class="op">$</span>Group_cic <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;repeated&quot;</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true"></a>N170_Rep<span class="op">$</span>rep[N170_Rep<span class="op">$</span>Group_cic <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;novel&quot;</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true"></a><span class="co"># Rename variables</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true"></a>N170_Rep<span class="op">$</span>PT[N170_Rep<span class="op">$</span>Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;prime&quot;</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true"></a>N170_Rep<span class="op">$</span>PT[N170_Rep<span class="op">$</span>Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;target&quot;</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true"></a><span class="co"># Define emotions</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Condition[N170_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Condition[N170_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Condition[N170_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Condition[N170_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">4</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Condition[N170_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">5</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Condition[N170_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">6</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Condition[N170_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">7</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Condition[N170_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">8</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Condition[N170_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">9</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true"></a></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true"></a><span class="co"># Factor and create contrasts</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true"></a>N170_Rep<span class="op">$</span>rep =<span class="st"> </span><span class="kw">factor</span>(N170_Rep<span class="op">$</span>rep)</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true"></a>N170_Rep<span class="op">$</span>PT =<span class="st"> </span><span class="kw">factor</span>(N170_Rep<span class="op">$</span>PT)</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Response =<span class="st"> </span><span class="kw">factor</span>(N170_Rep<span class="op">$</span>Response)</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true"></a></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true"></a><span class="kw">contrasts</span>(N170_Rep<span class="op">$</span>rep) =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>)  <span class="co"># intercept is the mean of repeated / novel</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true"></a><span class="kw">contrasts</span>(N170_Rep<span class="op">$</span>PT) =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>)  <span class="co"># intercept is the mean of repeated / novel</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true"></a></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Condition =<span class="st"> </span><span class="kw">factor</span>(N170_Rep<span class="op">$</span>Condition)</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true"></a><span class="kw">contrasts</span>(N170_Rep<span class="op">$</span>Condition) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>, <span class="dt">base =</span> <span class="dv">3</span>)</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true"></a></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true"></a><span class="co"># A = angry, N = neutral, H = happy</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true"></a>HvsA =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">-0.5</span>, <span class="dv">0</span>)  <span class="co"># compare: happy vs. angry</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true"></a>EvsN =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.25</span>, <span class="fl">-0.25</span>, <span class="fl">0.5</span>)  <span class="co"># compare happy/angry to neutral</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true"></a><span class="kw">contrasts</span>(N170_Rep<span class="op">$</span>Condition) =<span class="st"> </span><span class="kw">cbind</span>(EvsN, HvsA)</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true"></a></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true"></a>N170_Rep =<span class="st"> </span><span class="kw">subset</span>(N170_Rep, PT <span class="op">==</span><span class="st"> &quot;target&quot;</span>)</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true"></a></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true"></a><span class="co"># Build full model</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true"></a>mod_N170_Rep.lmer =<span class="st"> </span><span class="kw">lmer</span>(N170_Amplitude <span class="op">~</span><span class="st"> </span>Condition <span class="op">*</span><span class="st"> </span>rep <span class="op">+</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true"></a><span class="st">    </span><span class="op">+</span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Elect_site), <span class="dt">data =</span> N170_Rep, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span></code></pre></div>
<p><code>N170_Amplitude ~ Condition * rep + contr_F2_scal + WM_scal + ,     +(1 | ID) + (1 | Stim_Type) + (1 | Elect_site)</code></p>
<hr />
</div>
<div id="lmm_n170-normality-of-residuals" class="section level4">
<h4>LMM_N170: Normality of residuals</h4>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="co">## Check properties of DV / residuals</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a>N170_Rep<span class="op">$</span>Trans_N170 =<span class="st"> </span>N170_Rep<span class="op">$</span>N170_Amplitude <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(N170_Rep<span class="op">$</span>N170_Amplitude)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true"></a><span class="co"># To make sure residuals follow ND: Calculate box-cox plot</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true"></a><span class="kw">boxcox</span>(N170_Rep<span class="op">$</span>Trans_N170 <span class="op">~</span><span class="st"> </span>N170_Rep<span class="op">$</span>Group_pcic)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/N170_rep_res_box-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>N170 amplitudes met the assumption of normally distributed residuals.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a><span class="co"># Visualize normality assumption of residuals (without log transform)</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true"></a>mod_N170_Rep =<span class="st"> </span><span class="kw">lm</span>(Trans_N170 <span class="op">~</span><span class="st"> </span>Group_pcic, <span class="dt">data =</span> N170_Rep)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true"></a>res.mod_N170_Rep =<span class="st"> </span><span class="kw">residuals</span>(mod_N170_Rep)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true"></a>qqpl_mod_N170_Rep =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_N170_Rep, <span class="dt">main =</span> <span class="st">&quot;QQplot before transformation&quot;</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true"></a>norm_mod_N170_Rep =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_N170_Rep), <span class="dt">main =</span> <span class="st">&quot;Density plot before transformation&quot;</span>)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/N170_rep_res_plot-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<hr />
</div>
<div id="lmm-n170-homoscedasticity" class="section level4">
<h4>LMM N170: Homoscedasticity</h4>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="co"># Check homoscedasticity</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">fitted</span>(mod_N170_Rep.lmer), <span class="kw">residuals</span>(mod_N170_Rep.lmer))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/N170_val_homosk-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Based on visual inspection, we assumed homoscedasticity.</p>
<hr />
</div>
<div id="lmm-p3-random-effect-structure" class="section level4">
<h4>LMM P3: Random effect structure</h4>
</div>
<div id="lmm_p3-random-effect-structure" class="section level4">
<h4>LMM_P3: Random effect structure</h4>
<p>The final model was:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a><span class="co"># Select correct responses and outlier-free data</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true"></a>P3_Rep =<span class="st"> </span><span class="kw">subset</span>(ERP_data, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true"></a><span class="co"># Prepare fixed factors</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true"></a>P3_Rep<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(P3_Rep<span class="op">$</span>ID)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(P3_Rep<span class="op">$</span>Stim_Type)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true"></a><span class="co"># Define novel vs repeated trials</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true"></a>P3_Rep<span class="op">$</span>rep[P3_Rep<span class="op">$</span>Group_cic <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;repeated&quot;</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true"></a>P3_Rep<span class="op">$</span>rep[P3_Rep<span class="op">$</span>Group_cic <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;novel&quot;</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true"></a><span class="co"># Rename variables</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true"></a>P3_Rep<span class="op">$</span>PT[P3_Rep<span class="op">$</span>Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;prime&quot;</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true"></a>P3_Rep<span class="op">$</span>PT[P3_Rep<span class="op">$</span>Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;target&quot;</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true"></a><span class="co"># Define emotions</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Condition[P3_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Condition[P3_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Condition[P3_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Condition[P3_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">4</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Condition[P3_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">5</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Condition[P3_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">6</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Condition[P3_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">7</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Condition[P3_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">8</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Condition[P3_Rep<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">9</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true"></a></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true"></a><span class="co"># Factor and create contrasts</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true"></a>P3_Rep<span class="op">$</span>rep =<span class="st"> </span><span class="kw">factor</span>(P3_Rep<span class="op">$</span>rep)</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true"></a>P3_Rep<span class="op">$</span>PT =<span class="st"> </span><span class="kw">factor</span>(P3_Rep<span class="op">$</span>PT)</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true"></a></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true"></a><span class="kw">contrasts</span>(P3_Rep<span class="op">$</span>rep) =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>)  <span class="co"># intercept is the mean of repeated / novel</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true"></a><span class="kw">contrasts</span>(P3_Rep<span class="op">$</span>PT) =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>)  <span class="co"># intercept is the mean of repeated / novel</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true"></a></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Condition =<span class="st"> </span><span class="kw">factor</span>(P3_Rep<span class="op">$</span>Condition)</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true"></a><span class="kw">contrasts</span>(P3_Rep<span class="op">$</span>Condition) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>, <span class="dt">base =</span> <span class="dv">3</span>)</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true"></a></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true"></a><span class="co"># A = angry, N = neutral, H = happy</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true"></a>HvsA =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">-0.5</span>, <span class="dv">0</span>)  <span class="co"># compare: happy vs. angry</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true"></a>EvsN =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.25</span>, <span class="fl">-0.25</span>, <span class="fl">0.5</span>)  <span class="co"># compare happy/angry to neutral</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true"></a><span class="kw">contrasts</span>(P3_Rep<span class="op">$</span>Condition) =<span class="st"> </span><span class="kw">cbind</span>(EvsN, HvsA)</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true"></a></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true"></a><span class="co"># Bring electrodes in one variable</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true"></a>P3_Rep =<span class="st"> </span><span class="kw">gather</span>(P3_Rep, Elect_site, P3_Amplitude, P3_PO3<span class="op">:</span>P3_Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true"></a></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Elect_site =<span class="st"> </span><span class="kw">factor</span>(P3_Rep<span class="op">$</span>Elect_site)</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true"></a></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true"></a>P3_Rep =<span class="st"> </span><span class="kw">subset</span>(P3_Rep, PT <span class="op">==</span><span class="st"> &quot;target&quot;</span>)</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true"></a><span class="co"># P3_Rep = subset(P3_Rep, Response == &#39;false&#39;)</span></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true"></a></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true"></a><span class="co"># Build full model</span></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true"></a>mod_P3_Rep.lmer =<span class="st"> </span><span class="kw">lmer</span>(P3_Amplitude <span class="op">~</span><span class="st"> </span>Condition <span class="op">*</span><span class="st"> </span>rep <span class="op">+</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true"></a><span class="st">    </span><span class="op">+</span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Elect_site), <span class="dt">data =</span> P3_Rep, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span></code></pre></div>
<p><br></p>
<p><code>P3_Amplitude ~ Condition * rep + contr_F2_scal + WM_scal + +(1 | ,     ID) + (1 | Stim_Type) + (1 | Elect_site)</code></p>
<hr />
</div>
<div id="lmm-p3-normality-of-residuals" class="section level4">
<h4>LMM P3: Normality of residuals</h4>
<p>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a><span class="co">## Check properties of DV / residuals</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true"></a>P3_Rep<span class="op">$</span>Trans_P3 =<span class="st"> </span>P3_Rep<span class="op">$</span>mean_ROI_P3 <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(P3_Rep<span class="op">$</span>mean_ROI_P3)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true"></a><span class="co"># To make sure residuals follow ND: Calculate box-cox plot</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true"></a><span class="kw">boxcox</span>(P3_Rep<span class="op">$</span>Trans_P3 <span class="op">~</span><span class="st"> </span>P3_Rep<span class="op">$</span>Group_pcic)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P3_rep_res_box-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>P3 amplitudes met the assumption of normally distributed residuals.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a><span class="co"># Visualize normality assumption of residuals (without log transform)</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true"></a>mod_P3_Rep =<span class="st"> </span><span class="kw">lm</span>(Trans_P3 <span class="op">~</span><span class="st"> </span>Group_pcic, <span class="dt">data =</span> P3_Rep)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true"></a>res.mod_P3_Rep =<span class="st"> </span><span class="kw">residuals</span>(mod_P3_Rep)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true"></a>qqpl_mod_P3_Rep =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_P3_Rep, <span class="dt">main =</span> <span class="st">&quot;QQplot before transformation&quot;</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true"></a>norm_mod_P3_Rep =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_P3_Rep), <span class="dt">main =</span> <span class="st">&quot;Density plot before transformation&quot;</span>)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P3_rep_res_plot-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<hr />
</div>
<div id="lmm-p3-homoscedasticity" class="section level4">
<h4>LMM P3: Homoscedasticity</h4>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true"></a><span class="co"># Check homoscedasticity</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">fitted</span>(mod_P3_Rep.lmer), <span class="kw">residuals</span>(mod_P3_Rep.lmer))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P3_rep_homosk-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Based on visual inspection, we assumed homoscedasticity.</p>
<hr />
</div>
</div>
<div id="results" class="section level3">
<h3><strong>Results</strong></h3>
<div id="p1" class="section level4">
<h4><strong>P1</strong></h4>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true"></a><span class="co">### Calculate post-hoc tests P1 valence</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true"></a>P1_Rep<span class="op">$</span>interaction =<span class="st"> </span><span class="kw">interaction</span>(P1_Rep<span class="op">$</span>rep, P1_Rep<span class="op">$</span>Condition)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true"></a>mod_P1_Rep.lmer2 =<span class="st"> </span><span class="kw">lmer</span>(P1_Amplitude <span class="op">~</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>Condition <span class="op">*</span><span class="st"> </span>rep <span class="op">+</span><span class="st"> </span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true"></a><span class="st">    </span><span class="op">+</span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Elect_site), <span class="dt">data =</span> P1_Rep, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true"></a><span class="co"># Choose contrasts of interest / add fdr-correction</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true"></a>P1_Rep_lmm_model_posthoc =<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(mod_P1_Rep.lmer2, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">Condition =</span> <span class="kw">c</span>(<span class="st">&quot;neutral - happy = 0&quot;</span>, </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true"></a>    <span class="st">&quot;neutral - angry = 0&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="dt">type =</span> <span class="st">&quot;fdr&quot;</span>)))</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true"></a><span class="co"># Get ready for presentation in RMarkdown</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true"></a>tab1 =<span class="st"> </span><span class="kw">merge</span>(<span class="kw">as.data.frame</span>(P1_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>coefficients), <span class="kw">as.data.frame</span>(P1_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>sigma), </span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true"></a>    <span class="dt">by =</span> <span class="dv">0</span>)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true"></a>tab2 =<span class="st"> </span><span class="kw">as.data.frame</span>(P1_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>pvalues)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true"></a><span class="kw">rownames</span>(tab2) =<span class="st"> </span><span class="kw">rownames</span>(<span class="kw">as.data.frame</span>(P1_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>tstat))</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true"></a>tab2 =<span class="st"> </span><span class="kw">merge</span>(<span class="kw">as.data.frame</span>(P1_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>tstat), tab2, <span class="dt">by =</span> <span class="dv">0</span>)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true"></a>P1_Rep_posthoc1 =<span class="st"> </span><span class="kw">merge</span>(tab1, tab2, <span class="dt">by =</span> <span class="st">&quot;Row.names&quot;</span>)</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true"></a><span class="kw">colnames</span>(P1_Rep_posthoc1) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Contrast&quot;</span>, <span class="st">&quot;Est.&quot;</span>, <span class="st">&quot;Std. Error&quot;</span>, <span class="st">&quot;z value&quot;</span>, <span class="st">&quot;p value&quot;</span>)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true"></a></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true"></a></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true"></a><span class="co">### Calculate post-hoc tests P1 valence</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true"></a>P1_Rep<span class="op">$</span>interaction =<span class="st"> </span><span class="kw">interaction</span>(P1_Rep<span class="op">$</span>rep, P1_Rep<span class="op">$</span>Condition)</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true"></a></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true"></a></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true"></a>mod_P1_Rep.lmer3 =<span class="st"> </span><span class="kw">lmer</span>(P1_Amplitude <span class="op">~</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>interaction <span class="op">+</span><span class="st"> </span><span class="op">+</span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true"></a><span class="st">    </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Elect_site), <span class="dt">data =</span> P1_Rep, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true"></a></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true"></a></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true"></a>P1_Rep_lmm_model_posthoc =<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(mod_P1_Rep.lmer3, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">interaction =</span> <span class="kw">c</span>(<span class="st">&quot;novel.happy - novel.angry = 0&quot;</span>, </span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true"></a>    <span class="st">&quot;novel.happy - repeated.angry = 0&quot;</span>, <span class="st">&quot;repeated.angry - novel.angry = 0&quot;</span>, <span class="st">&quot;repeated.happy - novel.angry = 0&quot;</span>, </span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true"></a>    <span class="st">&quot;repeated.happy - novel.happy = 0&quot;</span>, <span class="st">&quot;repeated.happy - repeated.angry</span><span class="ch">\t</span><span class="st">= 0&quot;</span>)), </span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true"></a>    <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="dt">type =</span> <span class="st">&quot;fdr&quot;</span>)))</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true"></a></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true"></a></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true"></a><span class="co"># Get ready for presentation in RMarkdown</span></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true"></a>tab1 =<span class="st"> </span><span class="kw">merge</span>(<span class="kw">as.data.frame</span>(P1_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>coefficients), <span class="kw">as.data.frame</span>(P1_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>sigma), </span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true"></a>    <span class="dt">by =</span> <span class="dv">0</span>)</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true"></a>tab2 =<span class="st"> </span><span class="kw">as.data.frame</span>(P1_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>pvalues)</span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true"></a><span class="kw">rownames</span>(tab2) =<span class="st"> </span><span class="kw">rownames</span>(<span class="kw">as.data.frame</span>(P1_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>tstat))</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true"></a>tab2 =<span class="st"> </span><span class="kw">merge</span>(<span class="kw">as.data.frame</span>(P1_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>tstat), tab2, <span class="dt">by =</span> <span class="dv">0</span>)</span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true"></a>P1_Rep_posthoc2 =<span class="st"> </span><span class="kw">merge</span>(tab1, tab2, <span class="dt">by =</span> <span class="st">&quot;Row.names&quot;</span>)</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true"></a><span class="kw">colnames</span>(P1_Rep_posthoc2) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Contrast&quot;</span>, <span class="st">&quot;Est.&quot;</span>, <span class="st">&quot;Std. Error&quot;</span>, <span class="st">&quot;z value&quot;</span>, <span class="st">&quot;p value&quot;</span>)</span></code></pre></div>
<p>In line with our hypothesis, we found larger P1 amplitudes for emotional vs. neutral expressions (<span class="math inline">\(\beta\)</span> = -1.31, <em>p</em> = 0.00). Both happy (<em>p</em> = 0.05) and angry expressions (<em>p</em> = 0.02) elicited larger P1 amplitudes compared to neutral expressions. No amplitude differences were detected between happy and angry expressions (<span class="math inline">\(\beta\)</span> = -0.14, <em>p</em> = 0.72). There was no main effect of repetition (<span class="math inline">\(\beta\)</span> = -0.25, <em>p</em> = 0.49). Similarly, no interaction of emotional vs. neutral expressions with repetition was found (<span class="math inline">\(\beta\)</span> = 0.73, <em>p</em> = 0.43). We did, however, detect a significant interaction of happy vs. angry expressions with repetition (<span class="math inline">\(\beta\)</span> = 2.69, <em>p</em> &lt; 0.001): Post-hoc tests indicated that, in line with our hypothesis, P1 amplitudes for repeated happy expressions were smaller than for novel happy expressions (<em>p</em> = 0.01). Novel happy expressions also elicited larger P1 amplitudes than novel angry expressions (<em>p</em> = 0.04; all other <em>p</em> &gt; 0.15).</p>
</div>
<div id="n170" class="section level4">
<h4><strong>N170</strong></h4>
<p>We did not find significant main effects for facial expression contrasts (emotion vs. neutral expressions: <span class="math inline">\(\beta\)</span> = -0.08, <em>p</em> = 0.83; happy vs. angry expressions: <span class="math inline">\(\beta\)</span> = 0.11, <em>p</em> = 0.75) or repetition (<span class="math inline">\(\beta\)</span> = 0.07, <em>p</em> = 0.80) None of the interactions of facial expressions with repetition were significant (emotion vs. neutral expressions: β = 0.87, p = 0.43; happy vs. angry expressions: β = 1.16, p = 0.08). None of the interactions of facial expressions with repetition were significant (emotion vs. neutral expressions: <span class="math inline">\(\beta\)</span> = 0.87, <em>p</em> = 0.43; happy vs. angry expressions: <span class="math inline">\(\beta\)</span> = 1.16, <em>p</em> &lt; 0.001).</p>
</div>
<div id="p3" class="section level4">
<h4><strong>P3</strong></h4>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true"></a><span class="co">### Calculate post-hoc tests P3 valence</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true"></a>P3_Rep<span class="op">$</span>interaction =<span class="st"> </span><span class="kw">interaction</span>(P3_Rep<span class="op">$</span>rep, P3_Rep<span class="op">$</span>Condition)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true"></a>mod_P3_Rep.lmer2 =<span class="st"> </span><span class="kw">lmer</span>(P3_Amplitude <span class="op">~</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>Condition <span class="op">*</span><span class="st"> </span>rep <span class="op">+</span><span class="st"> </span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true"></a><span class="st">    </span><span class="op">+</span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Elect_site), <span class="dt">data =</span> P3_Rep, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true"></a><span class="co"># Choose contrasts of interest / add fdr-correction</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true"></a>P3_Rep_lmm_model_posthoc =<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(mod_P3_Rep.lmer2, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">Condition =</span> <span class="kw">c</span>(<span class="st">&quot;neutral - happy = 0&quot;</span>, </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true"></a>    <span class="st">&quot;neutral - angry = 0&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="dt">type =</span> <span class="st">&quot;fdr&quot;</span>)))</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true"></a><span class="co"># Get ready for presentation in RMarkdown</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true"></a>tab1 =<span class="st"> </span><span class="kw">merge</span>(<span class="kw">as.data.frame</span>(P3_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>coefficients), <span class="kw">as.data.frame</span>(P3_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>sigma), </span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true"></a>    <span class="dt">by =</span> <span class="dv">0</span>)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true"></a>tab2 =<span class="st"> </span><span class="kw">as.data.frame</span>(P3_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>pvalues)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true"></a><span class="kw">rownames</span>(tab2) =<span class="st"> </span><span class="kw">rownames</span>(<span class="kw">as.data.frame</span>(P3_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>tstat))</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true"></a>tab2 =<span class="st"> </span><span class="kw">merge</span>(<span class="kw">as.data.frame</span>(P3_Rep_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>tstat), tab2, <span class="dt">by =</span> <span class="dv">0</span>)</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true"></a>P3_Rep_posthoc1 =<span class="st"> </span><span class="kw">merge</span>(tab1, tab2, <span class="dt">by =</span> <span class="st">&quot;Row.names&quot;</span>)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true"></a><span class="kw">colnames</span>(P3_Rep_posthoc1) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Contrast&quot;</span>, <span class="st">&quot;Est.&quot;</span>, <span class="st">&quot;Std. Error&quot;</span>, <span class="st">&quot;z value&quot;</span>, <span class="st">&quot;p value&quot;</span>)</span></code></pre></div>
<p>In line with our hypothesis, we detected differences for emotional vs. neutral facial expressions (β = -1.40, p = 0.01). Angry expressions elicited larger P3 amplitudes than neutral expressions (p &lt; 0.001) and happy expressions (β = 1.15, p = 0.01). No significant difference was found for happy vs. neutral expressions (p = 0.47). P3 amplitudes did not show significant modulations by repetition (β = 0.40, p = 0.33). Interactions of facial expression contrasts with repetition were not significant (emotional vs. neutral facial expressions x repetition: β = 1.16, p = 0.27; happy vs. angry facial expressions x repetition: β = -0.59, p = 0.52). Additionally, we detected that stimulus’ contrast was a significant covariate, with larger contrast values eliciting larger P3 amplitudes (β = -0.51, p = 0.04</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true"></a><span class="co"># Define labels</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true"></a>labels =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Emotion vs. Neutral&quot;</span>, <span class="st">&quot;Happy vs. Angry&quot;</span>, <span class="st">&quot;Repetition&quot;</span>, <span class="st">&quot;Stimulus&#39; Contrast&quot;</span>, </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true"></a>    <span class="st">&quot;Working Memory&quot;</span>, <span class="st">&quot;E vs. N x Repetition&quot;</span>, <span class="st">&quot;H vs. A x Repetition&quot;</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true"></a><span class="co"># Create table</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true"></a><span class="kw">tab_model</span>(mod_P1_Rep.lmer, mod_N170_Rep.lmer, mod_P3_Rep.lmer, <span class="dt">show.intercept =</span> <span class="ot">FALSE</span>, </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true"></a>    <span class="dt">pred.labels =</span> labels, <span class="dt">string.est =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">show.se =</span> <span class="ot">TRUE</span>, <span class="dt">string.se =</span> <span class="st">&quot;SE&quot;</span>, <span class="dt">show.stat =</span> <span class="ot">TRUE</span>, </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true"></a>    <span class="dt">string.stat =</span> <span class="st">&quot;t&quot;</span>, <span class="dt">show.ci =</span> <span class="ot">FALSE</span>, <span class="dt">show.re.var =</span> <span class="ot">TRUE</span>, <span class="dt">show.obs =</span> <span class="ot">FALSE</span>, <span class="dt">emph.p =</span> <span class="ot">TRUE</span>, </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true"></a>    <span class="dt">dv.labels =</span> <span class="kw">c</span>(<span class="st">&quot;P1 Amplitude&quot;</span>, <span class="st">&quot;N170 Amplitude&quot;</span>, <span class="st">&quot;P3 Amplitude&quot;</span>), <span class="dt">show.icc =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
P1 Amplitude
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
N170 Amplitude
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
P3 Amplitude
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
b
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
b
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col8">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col9">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  0">
b
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  1">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  2">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  3">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Emotion vs. Neutral
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-1.31
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.47
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-2.82
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>0.005</strong>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.08
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.38
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-0.22
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.826
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
-1.40
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
0.53
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
-2.64
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
<strong>0.008</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Happy vs. Angry
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.14
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.40
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.35
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.724
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.11
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.33
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
0.32
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.749
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
1.15
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
0.46
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
2.51
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
<strong>0.012</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Repetition
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.25
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.37
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.69
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.493
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.07
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.28
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
0.26
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.798
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
0.40
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
0.41
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
0.98
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
0.329
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Stimulus’ Contrast
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.31
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.23
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.30
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.193
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.04
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.14
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
0.30
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.761
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
-0.51
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
0.25
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
-2.02
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
<strong>0.043</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Working Memory
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.72
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.94
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.77
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.440
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.78
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.63
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
1.24
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.217
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
0.33
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
1.27
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
0.26
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
0.794
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
E vs. N x Repetition
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.73
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.93
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.78
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.433
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.87
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.77
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
1.14
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.256
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
1.16
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
1.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
1.09
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
0.275
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
H vs. A x Repetition
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
2.69
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.81
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
3.33
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>0.001</strong>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.16
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.66
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
1.76
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.079
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
-0.59
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
0.92
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
-0.64
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
0.523
</td>
</tr>
<tr>
<td colspan="13" style="font-weight:bold; text-align:left; padding-top:.8em;">
Random Effects
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
σ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
258.83
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
222.67
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
336.85
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
τ<sub>00</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
5.40 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.19 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
4.45 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
24.57 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
10.79 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
45.75 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
12.92 <sub>Elect_site</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
1.57 <sub>Elect_site</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
3.84 <sub>Elect_site</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
ICC
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.14
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.05
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.14
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
72 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
72 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
72 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
5 <sub>Elect_site</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
6 <sub>Elect_site</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
5 <sub>Elect_site</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
0.004 / 0.145
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
0.003 / 0.056
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
0.002 / 0.140
</td>
</tr>
</table>
<p><em>Note:</em> p-values for the fixed effects calculated using Wald-statistics approximation, uncorrected. <em>b</em>: unstandardized coefficient; <em>SE</em>: standard error; <em>t</em>: test statistic coefficient; <em>p</em>: p-value; <em>σ2</em>: within-group variance; <em>τ00</em>: between-group variance; <em>ICC</em>: interclass correlation (ratio of between-cluster variance to total variance); <em>N</em>: number of random effects.</p>
<p><br></p>
<p><strong>Post-hoc test P1: Contrast Emotion vs. Neutral</strong></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true"></a><span class="co"># Create table</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true"></a><span class="kw">kable</span>(P1_Rep_posthoc1) <span class="op">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&quot;hover&quot;</span>), <span class="dt">font_size =</span> <span class="dv">14</span>, <span class="dt">fixed_thead =</span> T)</span></code></pre></div>
<table class="table table-hover" style="font-size: 14px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Contrast
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Est.
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Std. Error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
z value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
p value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
neutral - angry
</td>
<td style="text-align:right;">
-0.912
</td>
<td style="text-align:right;">
0.405
</td>
<td style="text-align:right;">
-2.25
</td>
<td style="text-align:right;">
0.045
</td>
</tr>
<tr>
<td style="text-align:left;">
neutral - happy
</td>
<td style="text-align:right;">
-1.054
</td>
<td style="text-align:right;">
0.400
</td>
<td style="text-align:right;">
-2.63
</td>
<td style="text-align:right;">
0.016
</td>
</tr>
</tbody>
</table>
<p><br></p>
<p><strong>Post-hoc test P1: Contrast Emotion vs. Neutral with Repetition</strong></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true"></a><span class="co"># Create table</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true"></a><span class="kw">kable</span>(P1_Rep_posthoc2) <span class="op">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&quot;hover&quot;</span>), <span class="dt">font_size =</span> <span class="dv">14</span>, <span class="dt">fixed_thead =</span> T)</span></code></pre></div>
<table class="table table-hover" style="font-size: 14px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Contrast
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Est.
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Std. Error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
z value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
p value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
novel.happy - novel.angry
</td>
<td style="text-align:right;">
1.488
</td>
<td style="text-align:right;">
0.568
</td>
<td style="text-align:right;">
2.620
</td>
<td style="text-align:right;">
0.043
</td>
</tr>
<tr>
<td style="text-align:left;">
novel.happy - repeated.angry
</td>
<td style="text-align:right;">
0.579
</td>
<td style="text-align:right;">
0.579
</td>
<td style="text-align:right;">
1.001
</td>
<td style="text-align:right;">
0.749
</td>
</tr>
<tr>
<td style="text-align:left;">
repeated.angry - novel.angry
</td>
<td style="text-align:right;">
0.909
</td>
<td style="text-align:right;">
0.595
</td>
<td style="text-align:right;">
1.527
</td>
<td style="text-align:right;">
0.421
</td>
</tr>
<tr>
<td style="text-align:left;">
repeated.happy - novel.angry
</td>
<td style="text-align:right;">
-0.296
</td>
<td style="text-align:right;">
0.607
</td>
<td style="text-align:right;">
-0.487
</td>
<td style="text-align:right;">
0.962
</td>
</tr>
<tr>
<td style="text-align:left;">
repeated.happy - novel.happy
</td>
<td style="text-align:right;">
-1.784
</td>
<td style="text-align:right;">
0.595
</td>
<td style="text-align:right;">
-2.999
</td>
<td style="text-align:right;">
0.014
</td>
</tr>
<tr>
<td style="text-align:left;">
repeated.happy - repeated.angry
</td>
<td style="text-align:right;">
-1.205
</td>
<td style="text-align:right;">
0.572
</td>
<td style="text-align:right;">
-2.107
</td>
<td style="text-align:right;">
0.150
</td>
</tr>
</tbody>
</table>
<p><br></p>
<p><strong>Post-hoc test P3: Contrast Emotion vs. Neutral</strong></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true"></a><span class="co"># Create table</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true"></a><span class="kw">kable</span>(P3_Rep_posthoc1) <span class="op">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&quot;hover&quot;</span>), <span class="dt">font_size =</span> <span class="dv">14</span>, <span class="dt">fixed_thead =</span> T)</span></code></pre></div>
<table class="table table-hover" style="font-size: 14px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Contrast
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Est.
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Std. Error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
z value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
p value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
neutral - angry
</td>
<td style="text-align:right;">
-1.620
</td>
<td style="text-align:right;">
0.460
</td>
<td style="text-align:right;">
-3.52
</td>
<td style="text-align:right;">
0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
neutral - happy
</td>
<td style="text-align:right;">
-0.474
</td>
<td style="text-align:right;">
0.454
</td>
<td style="text-align:right;">
-1.04
</td>
<td style="text-align:right;">
0.473
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="session-info" class="section level1">
<h1>Session info</h1>
<!-- Provide session info  -->
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true"></a><span class="co"># Get session info</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true"></a><span class="kw">sessionInfo</span>()</span></code></pre></div>
<pre><code>R version 4.0.2 (2020-06-22)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 18362)

Matrix products: default

locale:
[1] LC_COLLATE=German_Germany.1252  LC_CTYPE=German_Germany.1252   
[3] LC_MONETARY=German_Germany.1252 LC_NUMERIC=C                   
[5] LC_TIME=German_Germany.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] gvlma_1.0.0.3      eegUtils_0.5.0     forcats_0.5.1      stringr_1.4.0     
 [5] purrr_0.3.4        readr_1.4.0        tidyr_1.1.3        tibble_3.1.1      
 [9] tidyverse_1.3.1    sjlabelled_1.1.7   sjmisc_2.8.6       sjPlot_2.8.7      
[13] Rmisc_1.5          plyr_1.8.6         reshape2_1.4.4     psych_2.1.3       
[17] multcomp_1.4-16    TH.data_1.0-10     mvtnorm_1.1-1      MASS_7.3-53.1     
[21] lmerTest_3.1-3     lme4_1.1-26        Matrix_1.3-2       Hmisc_4.5-0       
[25] Formula_1.2-4      survival_3.2-10    lattice_0.20-41    ggstatsplot_0.7.2 
[29] ez_4.4-0           EnvStats_2.4.0     eeptools_1.2.4     ggplot2_3.3.3     
[33] dplyr_1.0.5        cowplot_1.1.1      summarytools_0.9.9 miceadds_3.11-6   
[37] mice_3.13.0        rmdformats_1.0.2   XLConnect_1.0.3    kableExtra_1.3.4  

loaded via a namespace (and not attached):
 [1] estimability_1.3       R.methodsS3_1.8.1      coda_0.19-4           
 [4] knitr_1.32             R.utils_2.10.1         data.table_1.14.0     
 [7] rpart_4.1-15           generics_0.1.0         future_1.21.0         
[10] correlation_0.6.1      webshot_0.5.2          xml2_1.3.2            
[13] lubridate_1.7.10       httpuv_1.5.5           assertthat_0.2.1      
[16] viridis_0.6.0          WRS2_1.1-1             xfun_0.22             
[19] hms_1.0.0              jquerylib_0.1.3        rJava_0.9-13          
[22] evaluate_0.14          promises_1.2.0.1       fansi_0.4.2           
[25] dbplyr_2.1.1           readxl_1.3.1           DBI_1.1.1             
[28] tmvnsim_1.0-2          htmlwidgets_1.5.3      reshape_0.8.8         
[31] kSamples_1.2-9         Rmpfr_0.8-4            paletteer_1.3.0       
[34] ellipsis_0.3.1         backports_1.2.1        signal_0.7-6          
[37] bookdown_0.21          insight_0.13.2         ggcorrplot_0.1.3      
[40] rapportools_1.0        vctrs_0.3.7            abind_1.4-5           
[43] cachem_1.0.4           withr_2.4.2            pryr_0.1.4            
[46] checkmate_2.0.0        emmeans_1.5.5-1        vcd_1.4-8             
[49] mnormt_2.0.2           svglite_2.0.0          cluster_2.1.2         
[52] lazyeval_0.2.2         crayon_1.4.1           labeling_0.4.2        
[55] pkgconfig_2.0.3        SuppDists_1.1-9.5      nlme_3.1-152          
[58] statsExpressions_1.0.1 nnet_7.3-15            rlang_0.4.10          
[61] globals_0.14.0         lifecycle_1.0.0        miniUI_0.1.1.1        
[64] MatrixModels_0.5-0     sandwich_3.0-0         modelr_0.1.8          
[67] cellranger_1.1.0       tcltk_4.0.2            matrixStats_0.58.0    
[70] lmtest_0.9-38          mc2d_0.1-19            carData_3.0-4         
[73] boot_1.3-27            zoo_1.8-9              reprex_2.0.0          
 [ reached getOption(&quot;max.print&quot;) -- omitted 97 entries ]</code></pre>
</div>
</div>

<div class="col-xs-2">

<div class = "btn-toolbar">
<div class="btn-group">
<a class="btn btn-raised btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" href="#"><span>Code</span> <span class="caret"></span></a>
<ul class="dropdown-menu" style="min-width: 50px;">

<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>

</ul>
</div>
</div>

</div>
</div>
	


</div>
</div>

 <script>
    $(document).ready(function () {
	// add bootstrap table styles to pandoc tables
	$('tr.header').parent('thead').parent('table').addClass('table table-striped table-hover');
	
	
		$('.pages img').addClass("image-lb");
	$('.pages').magnificPopup({
	    type:'image',
	    closeOnContentClick: false,
	    closeBtnInside: false,
            delegate: '.image-lb',
	    gallery: {enabled: true },
            removalDelay: 500,
            callbacks: {
		beforeOpen: function() {
                    // just a hack that adds mfp-anim class to markup
                    this.st.image.markup = this.st.image.markup.replace('mfp-figure', 'mfp-figure mfp-with-anim');
		}
            },
            mainClass: 'mfp-move-from-top',
	    image: {
	        verticalFit: true,
		titleSrc: 'alt'
	    }
 	});
 	
	  
	$('#toc ul li').first().addClass("active");
	$('#toc ul li').attr("data-target", function() {
            return($(this).children("a").attr("href"));
	})
	$('body .section.level1').first().addClass("active");
	$('body .section.level1').not('.active').hide();
	
	$('#toc a[href*="#"], a[href^="#"]').click(function() {
	    var id = $(this).attr("href");
	    if (id === "#") return;
	    if (id.substring(0, 8) === "#dyntab-") return;
	    // Menu
	    var menu_entry = $(".menu li[data-target='"+id+"']");
	    if (menu_entry.length == 0) {
		window.location.hash = id;
		return;
	    }
	    menu_entry.addClass("active");
	    $(".menu li").not(menu_entry).removeClass("active"); 
	    toggle_page(id);
	});

	function toggle_page(id) {
	    $(".page").not(page).removeClass("active").hide();
	    window.page = id;
	    var page = $(window.page);
	    window.location.hash = window.page;
	    //$(this).addClass("active");
	    page.show();

	    var totop = setInterval(function () {
		$(".pages").animate({scrollTop: 0}, 0);
	    }, 10);

	    setTimeout(function () {
		page.addClass("active");
		setTimeout(function () {
		    clearInterval(totop);
		}, 1000);
	    }, 100);
	    
	    window.dispatchEvent(new Event('resize'));
	}


	$(".menu li").click(function () {
	    toggle_page($(this).data("target"));
	    // Menu
	    if (!$(this).data("target")) return;
	    if ($(this).is(".active")) return;
	    $(".menu li").not($(this)).removeClass("active");
	    $(this).addClass("active");
	});
  
	  
	window.page = window.location.hash;
	if (window.page != "") {
	    $(".menu").find("li[data-target=" + window.page + "]").trigger("click");
	}
	/* init material bootstrap js */
	$.material.init();
    });
 </script>


  <!-- dynamically load mathjax for compatibility with self-contained -->
 <script>
   (function () {
       var script = document.createElement("script");
       script.type = "text/javascript";
       script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
       document.getElementsByTagName("head")[0].appendChild(script);
   })();
 </script>
 
</body>
</html>
