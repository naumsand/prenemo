<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

    
    
    <title>ERP measures</title>
    <!-- Material Design fonts -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/icon?family=Material+Icons">

        <script src="site_libs/header-attrs-2.6/header-attrs.js"></script>
        <script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="site_libs/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="site_libs/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
        <script src="site_libs/navigation-1.1/tabsets.js"></script>
        <script src="site_libs/navigation-1.1/codefolding.js"></script>
        <link href="site_libs/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
        <script src="site_libs/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
        <link href="site_libs/bootstrap_material-0.1/bootstrap-material-design.min.css" rel="stylesheet" />
        <link href="site_libs/bootstrap_material-0.1/ripples.min.css" rel="stylesheet" />
        <script src="site_libs/bootstrap_material-0.1/material.min.js"></script>
        <script src="site_libs/bootstrap_material-0.1/ripples.min.js"></script>
        <link href="site_libs/material-0.1/material.css" rel="stylesheet" />
        <script src="site_libs/material-0.1/material.js"></script>
        <script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
        <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
        <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
    
    
        <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          background-color: #ffffff;
          color: #a0a0a0;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
      div.sourceCode
        { color: #1f1c1b; background-color: #ffffff; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span { color: #1f1c1b; } /* Normal */
      code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
      code span.an { color: #ca60ca; } /* Annotation */
      code span.at { color: #0057ae; } /* Attribute */
      code span.bn { color: #b08000; } /* BaseN */
      code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
      code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #924c9d; } /* Char */
      code span.cn { color: #aa5500; } /* Constant */
      code span.co { color: #898887; } /* Comment */
      code span.cv { color: #0095ff; } /* CommentVar */
      code span.do { color: #607880; } /* Documentation */
      code span.dt { color: #0057ae; } /* DataType */
      code span.dv { color: #b08000; } /* DecVal */
      code span.er { color: #bf0303; text-decoration: underline; } /* Error */
      code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
      code span.fl { color: #b08000; } /* Float */
      code span.fu { color: #644a9b; } /* Function */
      code span.im { color: #ff5500; } /* Import */
      code span.in { color: #b08000; } /* Information */
      code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
      code span.op { color: #1f1c1b; } /* Operator */
      code span.ot { color: #006e28; } /* Other */
      code span.pp { color: #006e28; } /* Preprocessor */
      code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
      code span.sc { color: #3daee9; } /* SpecialChar */
      code span.ss { color: #ff5500; } /* SpecialString */
      code span.st { color: #bf0303; } /* String */
      code span.va { color: #0057ae; } /* Variable */
      code span.vs { color: #bf0303; } /* VerbatimString */
      code span.wa { color: #bf0303; } /* Warning */
    </style>
    
        <link rel="stylesheet" href="web_style.css" type="text/css" />
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
        <script>
      $(document).ready(function () {
	  	  	  window.initializeCodeFolding("hide" === "show");
	        });
    </script>
    
    <!-- code download -->
    

    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .pages .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .pages .tabset-dropdown > .nav-tabs > li.active > a {
	  background-color: transparent !important;
	  color: #000000 !important;
      }
      
      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
	  color: #00A698 !important;
	  font-weight: 300 !important;
	  font-size: 14px;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
      }
    </style>
    
</head>

<body>

  <div class="header-panel shadow z-2">
    <div class="container-fluid">
      <div class="row">
        <div class="col-xs-3">
	  	  <div id="header">
	    <h1 class="title">ERP measures</h1>
	    	    	    	  </div>
	  	</div>
      </div>
    </div>
  </div>
  
  <div class="container-fluid main-container">
    <div class="row">

      <nav class="col-xs-3 menu">
	<div id="toc">
          <ul>
          <li><a href="#task-description">Task description</a></li>
          <li><a href="#erp-results">ERP results</a></li>
          <li><a href="#session-info">Session info</a></li>
          </ul>
	</div>
      </nav>
      
      <div class="pages col-xs-9">

            
    <div class="row">
	    	    
          <div class="navbar navbar-default  navbar-fixed-top" role="navigation">
            <div class="container">
              <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="index.html">Naumann et al.</a>
              </div>
              <div id="navbar" class="navbar-collapse collapse">
                <ul class="nav navbar-nav">
                  <li>
            <a href="index.html">
              <span class="glyphicon glyphicon-info-sign"></span>
               
              Data description
            </a>
          </li>
          <li>
            <a href="R_Script_1_Sample_descr.html">
              <span class="glyphicon glyphicon-user"></span>
               
              Sample description
            </a>
          </li>
          <li>
            <a href="R_Script_2_EEG_task_measures.html">
              <span class="glyphicon glyphicon-hand-up"></span>
               
              Del. match-to-sample task
            </a>
          </li>
          <li>
            <a href="R_Script_3_ERP_measures.html">
              <span class="glyphicon glyphicon-flash"></span>
               
              ERP measures
            </a>
          </li>
          <li>
            <a href="R_Script_4_Emotion_empathy_measures.html">
              <span class="glyphicon glyphicon-link"></span>
               
              Emotion &amp; Empathy measures
            </a>
          </li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                  <li>
            <a href="https://osf.io/nas48/">
              <span class="ai ai ai ai-osf ai-lg"></span>
               
            </a>
          </li>
          <li>
            <a href="mailto:sandra.naumann@hu-berlin.de">
              <span class="fas fa-envelope fa-lg"></span>
               
            </a>
          </li>
                </ul>
              </div><!--/.nav-collapse -->
            </div><!--/.container -->
          </div><!--/.navbar -->
	    	    <link rel="stylesheet" href="https://cdn.rawgit.com/jpswalsh/academicons/master/css/academicons.min.css">
	        </div>
    
    
	<div class="row">

	  <div class="col-xs-10">
	    <!-- Set up workspace -->
     <!-- Load data set -->
     <div id="task-description" class="section level1">
     <h1>Task description</h1>
     <p>We developed an emotion priming paradigm combined with a delayed-match-to-sample-task to examine categorical differences in facial expression processing in young children. In particular, EEG was recorded while preschoolers observed pairs of faces presented sequentially. In some trials, the two sequential facial stimuli (hereafter: ‘Face 1’ and ‘Face 2’) were identical, while in other trials they differed with regards to the facial expression displayed (happy, angry, or neutral).</p>
     <p>We calculated linear mixed models (LMM) separately for each ERP component. As fixed factors, all models included treatment contrasts for <em>facial expressions</em> (<code>emotional [average of happy/angry] vs. neutral faces (Emo_Neu)</code>, <code>happy vs. angry faces (Hap_Ang)</code>), <em>repetition</em> (<code>novel vs. repeated emotion trials (Rep_Nov)</code>) as well as their interaction (<code>Emo_NeuxRep_Nov, Hap_AngxRep_Nov</code>). We analyzed effects for Face 1 and Face 2 separately. For Face 1, we only used the facial expression contrasts. As hemispheric differences were previously reported for the N170 component, we included hemisphere as additional fixed factor for the N170 analysis (treatment contrast: <code>left vs. right ROI</code>). Working memory (<code>WM_scal</code>) was entered as a scaled covariate in all LMM analyses to control for cognitive task demands. Additionally, we entered stimulus contrast (<code>contr_F1_scal</code>,<code>contr_F2_scal</code>) as a scaled covariate to control for low-level differences.</p>
     <p>The random effects structure included random intercepts for participants (<code>(1|ID)</code>) and stimulus (<code>(1|Stim_Type)</code>). For each model, we commenced with the maximal random effect structure. Random intercepts were defined for participants and stimuli. Random slopes were defined for all predictors, but not covariates. We set correlations of random terms to zero and performed a principal component analysis on the random-effects variance-covariance estimates to determine the number of components supported by the data. We removed random effects explaining zero variance, in order to prevent over-parametrization. Afterwards, we checked whether all random intercepts improved the model using likelihood-ratio-testing.</p>
     <p>Assumptions for multiple regression were checked for all models (normality of the residuals, linearity, multicollinearity, homoscedasticity).</p>
     <p>We predicted that amplitudes would be larger for emotional compared to neutral facial expressions. We expected happy facial expressions to elicit the largest amplitudes, followed by angry and neutral facial expressions. Assuming that comprehensive facial expression representations are in place for young children, we expected an amplitude decrease in response to identical facial expressions. Again, we predicted that happy facial expressions would elicit the largest amplitude reduction compared to angry or neutral expressions because they are the most readily processed.</p>
     </div>
     <div id="erp-results" class="section level1">
     <h1>ERP results</h1>
     <p><br></p>
     <div id="descriptive-statistics" class="section level3">
     <h3><strong>Descriptive statistics</strong></h3>
     <p><em>ERP waveforms and topographies at Face 1.</em> Top row: Grand-averaged P1 and P3 (left side) and N170 (right side) waveforms for happy, angry and neutral facial expressions. Shadowed areas indicate the time windows used to identify participants' individual peaks and mean amplitudes. Bottom row: Topographies of the averaged P1 activity (90-130 ms) displaying difference waves for facial expression contrasts (from the left): angry–neutral, happy–neutral and happy–angry.</p>
     <div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="co">## P1/P3 trajectories</span></span>
     <span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a></span>
     <span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a><span class="co"># Load data</span></span>
     <span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a>Face1_data =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/ROI_P1_P3_Face1.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)</span>
     <span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a></span>
     <span id="cb1-6"><a href="#cb1-6" aria-hidden="true"></a><span class="co"># De-select participants</span></span>
     <span id="cb1-7"><a href="#cb1-7" aria-hidden="true"></a>Face1_data =<span class="st"> </span>Face1_data[<span class="kw">with</span>(Face1_data, <span class="op">!</span>(Face1_data<span class="op">$</span>ID <span class="op">==</span><span class="st"> &quot;05&quot;</span>)), ]</span>
     <span id="cb1-8"><a href="#cb1-8" aria-hidden="true"></a></span>
     <span id="cb1-9"><a href="#cb1-9" aria-hidden="true"></a><span class="co"># Select time window</span></span>
     <span id="cb1-10"><a href="#cb1-10" aria-hidden="true"></a>Face1_data =<span class="st"> </span>Face1_data[(Face1_data<span class="op">$</span>Time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-200</span>) <span class="op">&amp;</span><span class="st"> </span>(Face1_data<span class="op">$</span>Time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">600</span>), ]</span>
     <span id="cb1-11"><a href="#cb1-11" aria-hidden="true"></a></span>
     <span id="cb1-12"><a href="#cb1-12" aria-hidden="true"></a><span class="co"># Rename conditions</span></span>
     <span id="cb1-13"><a href="#cb1-13" aria-hidden="true"></a>Face1_data<span class="op">$</span>Condition[Face1_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;happy&quot;</span></span>
     <span id="cb1-14"><a href="#cb1-14" aria-hidden="true"></a>Face1_data<span class="op">$</span>Condition[Face1_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;neutral&quot;</span></span>
     <span id="cb1-15"><a href="#cb1-15" aria-hidden="true"></a>Face1_data<span class="op">$</span>Condition[Face1_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] =<span class="st"> &quot;angry&quot;</span></span>
     <span id="cb1-16"><a href="#cb1-16" aria-hidden="true"></a></span>
     <span id="cb1-17"><a href="#cb1-17" aria-hidden="true"></a><span class="co"># Select conditions of interest</span></span>
     <span id="cb1-18"><a href="#cb1-18" aria-hidden="true"></a>Face1_data_all_emo_sep =<span class="st"> </span>Face1_data[(Face1_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;happy&quot;</span>) <span class="op">|</span><span class="st"> </span>(Face1_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span></span>
     <span id="cb1-19"><a href="#cb1-19" aria-hidden="true"></a><span class="st">    &quot;angry&quot;</span>) <span class="op">|</span><span class="st"> </span>(Face1_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;neutral&quot;</span>), ]</span>
     <span id="cb1-20"><a href="#cb1-20" aria-hidden="true"></a></span>
     <span id="cb1-21"><a href="#cb1-21" aria-hidden="true"></a></span>
     <span id="cb1-22"><a href="#cb1-22" aria-hidden="true"></a><span class="co"># Factor and level emotion</span></span>
     <span id="cb1-23"><a href="#cb1-23" aria-hidden="true"></a>Face1_data_all_emo_sep<span class="op">$</span>Condition =<span class="st"> </span><span class="kw">factor</span>(Face1_data_all_emo_sep<span class="op">$</span>Condition, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>, </span>
     <span id="cb1-24"><a href="#cb1-24" aria-hidden="true"></a>    <span class="st">&quot;happy&quot;</span>, <span class="st">&quot;angry&quot;</span>))</span>
     <span id="cb1-25"><a href="#cb1-25" aria-hidden="true"></a></span>
     <span id="cb1-26"><a href="#cb1-26" aria-hidden="true"></a></span>
     <span id="cb1-27"><a href="#cb1-27" aria-hidden="true"></a><span class="co"># Plot data</span></span>
     <span id="cb1-28"><a href="#cb1-28" aria-hidden="true"></a>P1_P3_val_traj =<span class="st"> </span><span class="kw">ggplot</span>(Face1_data_all_emo_sep, <span class="kw">aes</span>(Time, ROI_Average)) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
     <span id="cb1-29"><a href="#cb1-29" aria-hidden="true"></a>    <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="dv">2</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
     <span id="cb1-30"><a href="#cb1-30" aria-hidden="true"></a>        <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">5</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
     <span id="cb1-31"><a href="#cb1-31" aria-hidden="true"></a>        <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">7</span>), </span>
     <span id="cb1-32"><a href="#cb1-32" aria-hidden="true"></a>    <span class="dt">legend.key =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>), <span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, </span>
     <span id="cb1-33"><a href="#cb1-33" aria-hidden="true"></a>    <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="fl">0.6</span>, <span class="kw">aes</span>(<span class="dt">linetype =</span> Condition)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_linetype_manual</span>(<span class="dt">name =</span> <span class="st">&quot;Emotion&quot;</span>, </span>
     <span id="cb1-34"><a href="#cb1-34" aria-hidden="true"></a>    <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;longdash&quot;</span>, <span class="st">&quot;dotted&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_discrete</span>(<span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>))) <span class="op">+</span><span class="st"> </span></span>
     <span id="cb1-35"><a href="#cb1-35" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">Time [ms]&quot;</span>, <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude [&quot;</span>, mu, <span class="st">&quot;V]&quot;</span>)), <span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
     <span id="cb1-36"><a href="#cb1-36" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">14</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>, </span>
     <span id="cb1-37"><a href="#cb1-37" aria-hidden="true"></a>    <span class="dv">600</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">14</span>, <span class="dv">4</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>, </span>
     <span id="cb1-38"><a href="#cb1-38" aria-hidden="true"></a>    <span class="dv">600</span>, <span class="dv">200</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
     <span id="cb1-39"><a href="#cb1-39" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, </span>
     <span id="cb1-40"><a href="#cb1-40" aria-hidden="true"></a>    <span class="dt">xmin =</span> <span class="dv">90</span>, <span class="dt">xmax =</span> <span class="dv">130</span>, <span class="dt">ymin =</span> <span class="fl">-2.5</span>, <span class="dt">ymax =</span> <span class="fl">14.5</span>, <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, </span>
     <span id="cb1-41"><a href="#cb1-41" aria-hidden="true"></a>    <span class="dt">xmin =</span> <span class="dv">300</span>, <span class="dt">xmax =</span> <span class="dv">500</span>, <span class="dt">ymin =</span> <span class="fl">-2.5</span>, <span class="dt">ymax =</span> <span class="fl">14.5</span>, <span class="dt">alpha =</span> <span class="fl">0.3</span>)</span>
     <span id="cb1-42"><a href="#cb1-42" aria-hidden="true"></a></span>
     <span id="cb1-43"><a href="#cb1-43" aria-hidden="true"></a></span>
     <span id="cb1-44"><a href="#cb1-44" aria-hidden="true"></a><span class="co">## N170 trajectories</span></span>
     <span id="cb1-45"><a href="#cb1-45" aria-hidden="true"></a></span>
     <span id="cb1-46"><a href="#cb1-46" aria-hidden="true"></a><span class="co"># Load data</span></span>
     <span id="cb1-47"><a href="#cb1-47" aria-hidden="true"></a>Face1_data_l =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/left_ROI_N170_Face1.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)</span>
     <span id="cb1-48"><a href="#cb1-48" aria-hidden="true"></a>Face1_data_r =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/right_ROI_N170_Face1.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)</span>
     <span id="cb1-49"><a href="#cb1-49" aria-hidden="true"></a></span>
     <span id="cb1-50"><a href="#cb1-50" aria-hidden="true"></a><span class="co"># Select time windows</span></span>
     <span id="cb1-51"><a href="#cb1-51" aria-hidden="true"></a>Face1_data_l =<span class="st"> </span>Face1_data_l[(Face1_data_l<span class="op">$</span>Time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-200</span>) <span class="op">&amp;</span><span class="st"> </span>(Face1_data_l<span class="op">$</span>Time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">600</span>), </span>
     <span id="cb1-52"><a href="#cb1-52" aria-hidden="true"></a>    ]</span>
     <span id="cb1-53"><a href="#cb1-53" aria-hidden="true"></a>Face1_data_r =<span class="st"> </span>Face1_data_r[(Face1_data_r<span class="op">$</span>Time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-200</span>) <span class="op">&amp;</span><span class="st"> </span>(Face1_data_r<span class="op">$</span>Time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">600</span>), </span>
     <span id="cb1-54"><a href="#cb1-54" aria-hidden="true"></a>    ]</span>
     <span id="cb1-55"><a href="#cb1-55" aria-hidden="true"></a></span>
     <span id="cb1-56"><a href="#cb1-56" aria-hidden="true"></a><span class="co"># De-select participants</span></span>
     <span id="cb1-57"><a href="#cb1-57" aria-hidden="true"></a>Face1_data_l =<span class="st"> </span>Face1_data_l[<span class="kw">with</span>(Face1_data_l, <span class="op">!</span>(Face1_data_l<span class="op">$</span>ID <span class="op">==</span><span class="st"> &quot;05&quot;</span>)), ]</span>
     <span id="cb1-58"><a href="#cb1-58" aria-hidden="true"></a>Face1_data_r =<span class="st"> </span>Face1_data_r[<span class="kw">with</span>(Face1_data_r, <span class="op">!</span>(Face1_data_r<span class="op">$</span>ID <span class="op">==</span><span class="st"> &quot;05&quot;</span>)), ]</span>
     <span id="cb1-59"><a href="#cb1-59" aria-hidden="true"></a></span>
     <span id="cb1-60"><a href="#cb1-60" aria-hidden="true"></a><span class="co"># Rename conditions</span></span>
     <span id="cb1-61"><a href="#cb1-61" aria-hidden="true"></a>Face1_data_l<span class="op">$</span>Condition[Face1_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;happy&quot;</span></span>
     <span id="cb1-62"><a href="#cb1-62" aria-hidden="true"></a>Face1_data_l<span class="op">$</span>Condition[Face1_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;neutral&quot;</span></span>
     <span id="cb1-63"><a href="#cb1-63" aria-hidden="true"></a>Face1_data_l<span class="op">$</span>Condition[Face1_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] =<span class="st"> &quot;angry&quot;</span></span>
     <span id="cb1-64"><a href="#cb1-64" aria-hidden="true"></a></span>
     <span id="cb1-65"><a href="#cb1-65" aria-hidden="true"></a>Face1_data_r<span class="op">$</span>Condition[Face1_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;happy&quot;</span></span>
     <span id="cb1-66"><a href="#cb1-66" aria-hidden="true"></a>Face1_data_r<span class="op">$</span>Condition[Face1_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;neutral&quot;</span></span>
     <span id="cb1-67"><a href="#cb1-67" aria-hidden="true"></a>Face1_data_r<span class="op">$</span>Condition[Face1_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] =<span class="st"> &quot;angry&quot;</span></span>
     <span id="cb1-68"><a href="#cb1-68" aria-hidden="true"></a></span>
     <span id="cb1-69"><a href="#cb1-69" aria-hidden="true"></a><span class="co"># Select conditions of interest</span></span>
     <span id="cb1-70"><a href="#cb1-70" aria-hidden="true"></a>Face1_data_all_emo_sep_l =<span class="st"> </span>Face1_data_l[(Face1_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;happy&quot;</span>) <span class="op">|</span><span class="st"> </span>(Face1_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span></span>
     <span id="cb1-71"><a href="#cb1-71" aria-hidden="true"></a><span class="st">    &quot;angry&quot;</span>) <span class="op">|</span><span class="st"> </span>(Face1_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;neutral&quot;</span>), ]</span>
     <span id="cb1-72"><a href="#cb1-72" aria-hidden="true"></a></span>
     <span id="cb1-73"><a href="#cb1-73" aria-hidden="true"></a>Face1_data_all_emo_sep_r =<span class="st"> </span>Face1_data_r[(Face1_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;happy&quot;</span>) <span class="op">|</span><span class="st"> </span>(Face1_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span></span>
     <span id="cb1-74"><a href="#cb1-74" aria-hidden="true"></a><span class="st">    &quot;angry&quot;</span>) <span class="op">|</span><span class="st"> </span>(Face1_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;neutral&quot;</span>), ]</span>
     <span id="cb1-75"><a href="#cb1-75" aria-hidden="true"></a></span>
     <span id="cb1-76"><a href="#cb1-76" aria-hidden="true"></a><span class="co"># Factor and level emotion</span></span>
     <span id="cb1-77"><a href="#cb1-77" aria-hidden="true"></a>Face1_data_all_emo_sep_l<span class="op">$</span>Condition =<span class="st"> </span><span class="kw">factor</span>(Face1_data_all_emo_sep_l<span class="op">$</span>Condition, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>, </span>
     <span id="cb1-78"><a href="#cb1-78" aria-hidden="true"></a>    <span class="st">&quot;happy&quot;</span>, <span class="st">&quot;angry&quot;</span>))</span>
     <span id="cb1-79"><a href="#cb1-79" aria-hidden="true"></a></span>
     <span id="cb1-80"><a href="#cb1-80" aria-hidden="true"></a>Face1_data_all_emo_sep_r<span class="op">$</span>Condition =<span class="st"> </span><span class="kw">factor</span>(Face1_data_all_emo_sep_r<span class="op">$</span>Condition, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>, </span>
     <span id="cb1-81"><a href="#cb1-81" aria-hidden="true"></a>    <span class="st">&quot;happy&quot;</span>, <span class="st">&quot;angry&quot;</span>))</span>
     <span id="cb1-82"><a href="#cb1-82" aria-hidden="true"></a></span>
     <span id="cb1-83"><a href="#cb1-83" aria-hidden="true"></a><span class="co"># Average N170 trajectories for left and right hemisphere</span></span>
     <span id="cb1-84"><a href="#cb1-84" aria-hidden="true"></a>Face1_N170 =<span class="st"> </span>(Face1_data_all_emo_sep_l <span class="op">+</span><span class="st"> </span>Face1_data_all_emo_sep_r)<span class="op">/</span><span class="dv">2</span></span>
     <span id="cb1-85"><a href="#cb1-85" aria-hidden="true"></a>Face1_N170<span class="op">$</span>Condition =<span class="st"> </span>Face1_data_all_emo_sep_l<span class="op">$</span>Condition</span>
     <span id="cb1-86"><a href="#cb1-86" aria-hidden="true"></a></span>
     <span id="cb1-87"><a href="#cb1-87" aria-hidden="true"></a><span class="co"># Plot N170 trajectory</span></span>
     <span id="cb1-88"><a href="#cb1-88" aria-hidden="true"></a>N170_val_traj =<span class="st"> </span><span class="kw">ggplot</span>(Face1_N170, <span class="kw">aes</span>(Time, ROI_Average)) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
     <span id="cb1-89"><a href="#cb1-89" aria-hidden="true"></a>    <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="dv">2</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
     <span id="cb1-90"><a href="#cb1-90" aria-hidden="true"></a>        <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
     <span id="cb1-91"><a href="#cb1-91" aria-hidden="true"></a>        <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>), </span>
     <span id="cb1-92"><a href="#cb1-92" aria-hidden="true"></a>    <span class="dt">legend.key =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>), <span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, </span>
     <span id="cb1-93"><a href="#cb1-93" aria-hidden="true"></a>    <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="kw">c</span>(<span class="fl">0.6</span>), <span class="kw">aes</span>(<span class="dt">linetype =</span> Condition)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;solid&quot;</span>, </span>
     <span id="cb1-94"><a href="#cb1-94" aria-hidden="true"></a>    <span class="st">&quot;longdash&quot;</span>, <span class="st">&quot;dotted&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">Time [ms]&quot;</span>, </span>
     <span id="cb1-95"><a href="#cb1-95" aria-hidden="true"></a>    <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;&quot;</span>)), <span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">4</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>, </span>
     <span id="cb1-96"><a href="#cb1-96" aria-hidden="true"></a>    <span class="dv">600</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>, </span>
     <span id="cb1-97"><a href="#cb1-97" aria-hidden="true"></a>    <span class="dv">600</span>, <span class="dv">200</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
     <span id="cb1-98"><a href="#cb1-98" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, </span>
     <span id="cb1-99"><a href="#cb1-99" aria-hidden="true"></a>    <span class="dt">xmin =</span> <span class="dv">180</span>, <span class="dt">xmax =</span> <span class="dv">220</span>, <span class="dt">ymin =</span> <span class="fl">-5.5</span>, <span class="dt">ymax =</span> <span class="fl">4.5</span>, <span class="dt">alpha =</span> <span class="fl">0.3</span>)</span>
     <span id="cb1-100"><a href="#cb1-100" aria-hidden="true"></a></span>
     <span id="cb1-101"><a href="#cb1-101" aria-hidden="true"></a><span class="co"># Put plots together</span></span>
     <span id="cb1-102"><a href="#cb1-102" aria-hidden="true"></a>plots_EEG_F1 =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(P1_P3_val_traj <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>), </span>
     <span id="cb1-103"><a href="#cb1-103" aria-hidden="true"></a>    N170_val_traj <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>), <span class="dt">align =</span> <span class="st">&quot;vh&quot;</span>, <span class="dt">hjust =</span> <span class="dv">-1</span>, <span class="dt">nrow =</span> <span class="dv">1</span>)</span>
     <span id="cb1-104"><a href="#cb1-104" aria-hidden="true"></a></span>
     <span id="cb1-105"><a href="#cb1-105" aria-hidden="true"></a><span class="co"># Get legend</span></span>
     <span id="cb1-106"><a href="#cb1-106" aria-hidden="true"></a>legend_ERP =<span class="st"> </span><span class="kw">get_legend</span>(P1_P3_val_traj <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.box.margin =</span> <span class="kw">margin</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, </span>
     <span id="cb1-107"><a href="#cb1-107" aria-hidden="true"></a>    <span class="dv">0</span>)))</span>
     <span id="cb1-108"><a href="#cb1-108" aria-hidden="true"></a></span>
     <span id="cb1-109"><a href="#cb1-109" aria-hidden="true"></a></span>
     <span id="cb1-110"><a href="#cb1-110" aria-hidden="true"></a><span class="co"># Load topography information</span></span>
     <span id="cb1-111"><a href="#cb1-111" aria-hidden="true"></a>Topo_Emo =<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file =</span> <span class="st">&quot;./data/ERPs_Topo_Face1.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
     <span id="cb1-112"><a href="#cb1-112" aria-hidden="true"></a></span>
     <span id="cb1-113"><a href="#cb1-113" aria-hidden="true"></a><span class="co"># Exclude participant</span></span>
     <span id="cb1-114"><a href="#cb1-114" aria-hidden="true"></a>Topo_Emo =<span class="st"> </span>Topo_Emo[<span class="kw">with</span>(Topo_Emo, <span class="op">!</span>(Topo_Emo<span class="op">$</span>ID <span class="op">==</span><span class="st"> </span><span class="dv">5</span>)), ]</span>
     <span id="cb1-115"><a href="#cb1-115" aria-hidden="true"></a></span>
     <span id="cb1-116"><a href="#cb1-116" aria-hidden="true"></a><span class="co"># Re-name to fit topoplot function</span></span>
     <span id="cb1-117"><a href="#cb1-117" aria-hidden="true"></a><span class="kw">names</span>(Topo_Emo)[<span class="kw">names</span>(Topo_Emo) <span class="op">==</span><span class="st"> &quot;Time&quot;</span>] =<span class="st"> &quot;time&quot;</span></span>
     <span id="cb1-118"><a href="#cb1-118" aria-hidden="true"></a></span>
     <span id="cb1-119"><a href="#cb1-119" aria-hidden="true"></a><span class="co"># Change from wide to long format for electrodes</span></span>
     <span id="cb1-120"><a href="#cb1-120" aria-hidden="true"></a>Topo_Emo =<span class="st"> </span><span class="kw">gather</span>(Topo_Emo, electrode, amplitude, Fp1<span class="op">:</span>Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
     <span id="cb1-121"><a href="#cb1-121" aria-hidden="true"></a></span>
     <span id="cb1-122"><a href="#cb1-122" aria-hidden="true"></a><span class="co"># Rename A1/A2</span></span>
     <span id="cb1-123"><a href="#cb1-123" aria-hidden="true"></a><span class="kw">names</span>(Topo_Emo)[<span class="kw">names</span>(Topo_Emo) <span class="op">==</span><span class="st"> &quot;A1&quot;</span>] &lt;-<span class="st"> &quot;TP9&quot;</span></span>
     <span id="cb1-124"><a href="#cb1-124" aria-hidden="true"></a><span class="kw">names</span>(Topo_Emo)[<span class="kw">names</span>(Topo_Emo) <span class="op">==</span><span class="st"> &quot;A2&quot;</span>] &lt;-<span class="st"> &quot;TP10&quot;</span></span>
     <span id="cb1-125"><a href="#cb1-125" aria-hidden="true"></a></span>
     <span id="cb1-126"><a href="#cb1-126" aria-hidden="true"></a><span class="co"># Plot topoplots for happy</span></span>
     <span id="cb1-127"><a href="#cb1-127" aria-hidden="true"></a>Topo_Emo_Hap =<span class="st"> </span><span class="kw">subset</span>(Topo_Emo, Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
     <span id="cb1-128"><a href="#cb1-128" aria-hidden="true"></a></span>
     <span id="cb1-129"><a href="#cb1-129" aria-hidden="true"></a><span class="co"># Plot topoplots for neutral</span></span>
     <span id="cb1-130"><a href="#cb1-130" aria-hidden="true"></a>Topo_Emo_Neu =<span class="st"> </span><span class="kw">subset</span>(Topo_Emo, Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>)</span>
     <span id="cb1-131"><a href="#cb1-131" aria-hidden="true"></a></span>
     <span id="cb1-132"><a href="#cb1-132" aria-hidden="true"></a><span class="co"># Plot topoplots for angry</span></span>
     <span id="cb1-133"><a href="#cb1-133" aria-hidden="true"></a>Topo_Emo_Ang =<span class="st"> </span><span class="kw">subset</span>(Topo_Emo, Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>)</span>
     <span id="cb1-134"><a href="#cb1-134" aria-hidden="true"></a></span>
     <span id="cb1-135"><a href="#cb1-135" aria-hidden="true"></a><span class="co"># Calculate difference score angry-neutral</span></span>
     <span id="cb1-136"><a href="#cb1-136" aria-hidden="true"></a>Topo_Diff_Ang_Neu =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> Topo_Emo_Hap[, <span class="dv">1</span>], <span class="dt">time =</span> Topo_Emo_Hap[, <span class="dv">3</span>], </span>
     <span id="cb1-137"><a href="#cb1-137" aria-hidden="true"></a>    <span class="dt">electrode =</span> Topo_Emo_Hap[, <span class="dv">4</span>], <span class="dt">amplitude =</span> Topo_Emo_Ang<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span>Topo_Emo_Neu<span class="op">$</span>amplitude)</span>
     <span id="cb1-138"><a href="#cb1-138" aria-hidden="true"></a></span>
     <span id="cb1-139"><a href="#cb1-139" aria-hidden="true"></a></span>
     <span id="cb1-140"><a href="#cb1-140" aria-hidden="true"></a><span class="co"># Calculate difference score happy-neutral</span></span>
     <span id="cb1-141"><a href="#cb1-141" aria-hidden="true"></a>Topo_Diff_Hap_Neu =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> Topo_Emo_Hap[, <span class="dv">1</span>], <span class="dt">time =</span> Topo_Emo_Hap[, <span class="dv">3</span>], </span>
     <span id="cb1-142"><a href="#cb1-142" aria-hidden="true"></a>    <span class="dt">electrode =</span> Topo_Emo_Hap[, <span class="dv">4</span>], <span class="dt">amplitude =</span> Topo_Emo_Hap<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span>Topo_Emo_Neu<span class="op">$</span>amplitude)</span>
     <span id="cb1-143"><a href="#cb1-143" aria-hidden="true"></a></span>
     <span id="cb1-144"><a href="#cb1-144" aria-hidden="true"></a></span>
     <span id="cb1-145"><a href="#cb1-145" aria-hidden="true"></a><span class="co"># Calculate difference score happy-angry</span></span>
     <span id="cb1-146"><a href="#cb1-146" aria-hidden="true"></a>Topo_Diff_Hap_Ang =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> Topo_Emo_Hap[, <span class="dv">1</span>], <span class="dt">time =</span> Topo_Emo_Hap[, <span class="dv">3</span>], </span>
     <span id="cb1-147"><a href="#cb1-147" aria-hidden="true"></a>    <span class="dt">electrode =</span> Topo_Emo_Hap[, <span class="dv">4</span>], <span class="dt">amplitude =</span> Topo_Emo_Hap<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span>Topo_Emo_Ang<span class="op">$</span>amplitude)</span>
     <span id="cb1-148"><a href="#cb1-148" aria-hidden="true"></a></span>
     <span id="cb1-149"><a href="#cb1-149" aria-hidden="true"></a><span class="co">## P1s</span></span>
     <span id="cb1-150"><a href="#cb1-150" aria-hidden="true"></a></span>
     <span id="cb1-151"><a href="#cb1-151" aria-hidden="true"></a><span class="co"># Select time windows</span></span>
     <span id="cb1-152"><a href="#cb1-152" aria-hidden="true"></a>Topo_Diff_Ang_Neu_P1 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_Ang_Neu, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">90</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">130</span>)</span>
     <span id="cb1-153"><a href="#cb1-153" aria-hidden="true"></a>Topo_Diff_Hap_Neu_P1 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_Hap_Neu, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">90</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">130</span>)</span>
     <span id="cb1-154"><a href="#cb1-154" aria-hidden="true"></a>Topo_Diff_Hap_Ang_P1 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_Hap_Ang, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">90</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">130</span>)</span>
     <span id="cb1-155"><a href="#cb1-155" aria-hidden="true"></a></span>
     <span id="cb1-156"><a href="#cb1-156" aria-hidden="true"></a><span class="co"># Add electrode information</span></span>
     <span id="cb1-157"><a href="#cb1-157" aria-hidden="true"></a>Topo_Diff_Ang_Neu_P1 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_Ang_Neu_P1, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, </span>
     <span id="cb1-158"><a href="#cb1-158" aria-hidden="true"></a>    <span class="dt">drop =</span> <span class="ot">FALSE</span>, <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
     <span id="cb1-159"><a href="#cb1-159" aria-hidden="true"></a>Topo_Diff_Hap_Neu_P1 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_Hap_Neu_P1, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, </span>
     <span id="cb1-160"><a href="#cb1-160" aria-hidden="true"></a>    <span class="dt">drop =</span> <span class="ot">FALSE</span>, <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
     <span id="cb1-161"><a href="#cb1-161" aria-hidden="true"></a>Topo_Diff_Hap_Ang_P1 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_Hap_Ang_P1, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, </span>
     <span id="cb1-162"><a href="#cb1-162" aria-hidden="true"></a>    <span class="dt">drop =</span> <span class="ot">FALSE</span>, <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
     <span id="cb1-163"><a href="#cb1-163" aria-hidden="true"></a></span>
     <span id="cb1-164"><a href="#cb1-164" aria-hidden="true"></a><span class="co"># Draw topographies</span></span>
     <span id="cb1-165"><a href="#cb1-165" aria-hidden="true"></a>topo_diff_ang_neu_P1 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Ang_Neu_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, </span>
     <span id="cb1-166"><a href="#cb1-166" aria-hidden="true"></a>    <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;angry – neutral&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, </span>
     <span id="cb1-167"><a href="#cb1-167" aria-hidden="true"></a>    <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.5</span>, <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span></span>
     <span id="cb1-168"><a href="#cb1-168" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span></span>
     <span id="cb1-169"><a href="#cb1-169" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </span>
     <span id="cb1-170"><a href="#cb1-170" aria-hidden="true"></a>    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
     <span id="cb1-171"><a href="#cb1-171" aria-hidden="true"></a></span>
     <span id="cb1-172"><a href="#cb1-172" aria-hidden="true"></a></span>
     <span id="cb1-173"><a href="#cb1-173" aria-hidden="true"></a><span class="co"># Draw topographies</span></span>
     <span id="cb1-174"><a href="#cb1-174" aria-hidden="true"></a>topo_diff_hap_neu_P1 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Hap_Neu_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, </span>
     <span id="cb1-175"><a href="#cb1-175" aria-hidden="true"></a>    <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;  happy – neutral&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, </span>
     <span id="cb1-176"><a href="#cb1-176" aria-hidden="true"></a>    <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.5</span>, <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span></span>
     <span id="cb1-177"><a href="#cb1-177" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span></span>
     <span id="cb1-178"><a href="#cb1-178" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </span>
     <span id="cb1-179"><a href="#cb1-179" aria-hidden="true"></a>    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
     <span id="cb1-180"><a href="#cb1-180" aria-hidden="true"></a></span>
     <span id="cb1-181"><a href="#cb1-181" aria-hidden="true"></a></span>
     <span id="cb1-182"><a href="#cb1-182" aria-hidden="true"></a><span class="co"># Draw topographies</span></span>
     <span id="cb1-183"><a href="#cb1-183" aria-hidden="true"></a>topo_diff_hap_ang_P1 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Hap_Ang_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, </span>
     <span id="cb1-184"><a href="#cb1-184" aria-hidden="true"></a>    <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;  happy – angry&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, </span>
     <span id="cb1-185"><a href="#cb1-185" aria-hidden="true"></a>    <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.5</span>, <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span></span>
     <span id="cb1-186"><a href="#cb1-186" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span></span>
     <span id="cb1-187"><a href="#cb1-187" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </span>
     <span id="cb1-188"><a href="#cb1-188" aria-hidden="true"></a>    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
     <span id="cb1-189"><a href="#cb1-189" aria-hidden="true"></a></span>
     <span id="cb1-190"><a href="#cb1-190" aria-hidden="true"></a><span class="co"># Get topo legend</span></span>
     <span id="cb1-191"><a href="#cb1-191" aria-hidden="true"></a>topo_diff_hap_ang_P1_leg =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Hap_Ang_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, </span>
     <span id="cb1-192"><a href="#cb1-192" aria-hidden="true"></a>    <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;  happy – angry&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, </span>
     <span id="cb1-193"><a href="#cb1-193" aria-hidden="true"></a>    <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.5</span>, <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span></span>
     <span id="cb1-194"><a href="#cb1-194" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span></span>
     <span id="cb1-195"><a href="#cb1-195" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;&quot;</span>, mu, <span class="st">&quot;V&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>, </span>
     <span id="cb1-196"><a href="#cb1-196" aria-hidden="true"></a>    <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>), <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">7</span>), </span>
     <span id="cb1-197"><a href="#cb1-197" aria-hidden="true"></a>    <span class="dt">legend.key.size =</span> <span class="kw">unit</span>(<span class="fl">0.5</span>, <span class="st">&quot;cm&quot;</span>))</span>
     <span id="cb1-198"><a href="#cb1-198" aria-hidden="true"></a></span>
     <span id="cb1-199"><a href="#cb1-199" aria-hidden="true"></a></span>
     <span id="cb1-200"><a href="#cb1-200" aria-hidden="true"></a><span class="co">## Display plots https://wilkelab.org/cowplot/articles/shared_legends.html</span></span>
     <span id="cb1-201"><a href="#cb1-201" aria-hidden="true"></a>fig_Face1_ERP =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(plots_EEG_F1, legend_ERP, <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="fl">0.5</span>))</span>
     <span id="cb1-202"><a href="#cb1-202" aria-hidden="true"></a></span>
     <span id="cb1-203"><a href="#cb1-203" aria-hidden="true"></a>topo_leg =<span class="st"> </span><span class="kw">get_legend</span>(topo_diff_hap_ang_P1_leg)</span>
     <span id="cb1-204"><a href="#cb1-204" aria-hidden="true"></a>fig_Face_<span class="dv">1</span>_topo =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(topo_diff_ang_neu_P1, topo_diff_hap_neu_P1, </span>
     <span id="cb1-205"><a href="#cb1-205" aria-hidden="true"></a>    topo_diff_hap_ang_P1, topo_leg, <span class="dt">ncol =</span> <span class="dv">4</span>, <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.8</span>), <span class="dt">rel_heights =</span> <span class="kw">c</span>(<span class="dv">1</span>, </span>
     <span id="cb1-206"><a href="#cb1-206" aria-hidden="true"></a>        <span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.2</span>))</span>
     <span id="cb1-207"><a href="#cb1-207" aria-hidden="true"></a></span>
     <span id="cb1-208"><a href="#cb1-208" aria-hidden="true"></a>fig_Face1_val =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(fig_Face1_ERP, fig_Face_<span class="dv">1</span>_topo, <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">rel_heights =</span> <span class="kw">c</span>(<span class="dv">2</span>, </span>
     <span id="cb1-209"><a href="#cb1-209" aria-hidden="true"></a>    <span class="dv">1</span>), <span class="dt">align =</span> <span class="st">&quot;v&quot;</span>)</span>
     <span id="cb1-210"><a href="#cb1-210" aria-hidden="true"></a></span>
     <span id="cb1-211"><a href="#cb1-211" aria-hidden="true"></a>fig_Face1_val</span></code></pre></div>
     <p><img src="R_Script_3_ERP_measures_files/figure-html/ERP_val_plot-1.png" width="576" style="display: block; margin: auto;" /></p>
     <p><br><br></p>
     <p><em>ERP waveforms and topographies at Face 2.</em> Top left: Grand-averaged P1 and P3 waveforms for novel and repeated happy, angry and neutral facial expressions. Shadowed areas indicate the time windows used to identify participants' individual peaks and mean amplitudes. Top right: Grand-averaged P1 amplitudes at Face 2 for repeated and novel happy, angry and neutral facial expressions. Error bars indicate standard errors (SE). Bottom: Topographies of the averaged P1 activity (90-130 ms) displaying difference waves for significant contrasts of the interaction of repetition and facial expression (from the left): novel happy–novel neutral, repeated happy–novel neutral, repeated angry–novel neutral, repeated neutral–novel neutral.</p>
     <div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="co"># Load Face 2 data</span></span>
     <span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a>Face2_data =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/ROI_P1_P3_Face2.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)</span>
     <span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a></span>
     <span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a><span class="co"># De-select participants</span></span>
     <span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a>Face2_data =<span class="st"> </span>Face2_data[<span class="kw">with</span>(Face2_data, <span class="op">!</span>(Face2_data<span class="op">$</span>ID <span class="op">==</span><span class="st"> &quot;05&quot;</span>)), ]</span>
     <span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a></span>
     <span id="cb2-7"><a href="#cb2-7" aria-hidden="true"></a><span class="co"># Select time window of interest</span></span>
     <span id="cb2-8"><a href="#cb2-8" aria-hidden="true"></a>Face2_data =<span class="st"> </span>Face2_data[(Face2_data<span class="op">$</span>Time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-200</span>) <span class="op">&amp;</span><span class="st"> </span>(Face2_data<span class="op">$</span>Time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">600</span>), ]</span>
     <span id="cb2-9"><a href="#cb2-9" aria-hidden="true"></a></span>
     <span id="cb2-10"><a href="#cb2-10" aria-hidden="true"></a><span class="co"># Rename values of Face2 condition</span></span>
     <span id="cb2-11"><a href="#cb2-11" aria-hidden="true"></a>Face2_data<span class="op">$</span>Condition[Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">4</span>] =<span class="st"> &quot;rep_happy&quot;</span></span>
     <span id="cb2-12"><a href="#cb2-12" aria-hidden="true"></a>Face2_data<span class="op">$</span>Condition[Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">5</span>] =<span class="st"> &quot;rep_neutral&quot;</span></span>
     <span id="cb2-13"><a href="#cb2-13" aria-hidden="true"></a>Face2_data<span class="op">$</span>Condition[Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">6</span>] =<span class="st"> &quot;rep_angry&quot;</span></span>
     <span id="cb2-14"><a href="#cb2-14" aria-hidden="true"></a>Face2_data<span class="op">$</span>Condition[Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">7</span>] =<span class="st"> &quot;nov_happy&quot;</span></span>
     <span id="cb2-15"><a href="#cb2-15" aria-hidden="true"></a>Face2_data<span class="op">$</span>Condition[Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">8</span>] =<span class="st"> &quot;nov_neutral&quot;</span></span>
     <span id="cb2-16"><a href="#cb2-16" aria-hidden="true"></a>Face2_data<span class="op">$</span>Condition[Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">9</span>] =<span class="st"> &quot;nov_angry&quot;</span></span>
     <span id="cb2-17"><a href="#cb2-17" aria-hidden="true"></a></span>
     <span id="cb2-18"><a href="#cb2-18" aria-hidden="true"></a><span class="co"># Plot ERP trajectory for P1/P3</span></span>
     <span id="cb2-19"><a href="#cb2-19" aria-hidden="true"></a>Face2_data_icc =<span class="st"> </span>Face2_data[(Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;rep_happy&quot;</span>) <span class="op">|</span><span class="st"> </span>(Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span></span>
     <span id="cb2-20"><a href="#cb2-20" aria-hidden="true"></a><span class="st">    &quot;rep_neutral&quot;</span>) <span class="op">|</span><span class="st"> </span>(Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;rep_angry&quot;</span>) <span class="op">|</span><span class="st"> </span>(Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span></span>
     <span id="cb2-21"><a href="#cb2-21" aria-hidden="true"></a><span class="st">    &quot;nov_happy&quot;</span>) <span class="op">|</span><span class="st"> </span>(Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;nov_angry&quot;</span>) <span class="op">|</span><span class="st"> </span>(Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span></span>
     <span id="cb2-22"><a href="#cb2-22" aria-hidden="true"></a><span class="st">    &quot;nov_neutral&quot;</span>), ]</span>
     <span id="cb2-23"><a href="#cb2-23" aria-hidden="true"></a></span>
     <span id="cb2-24"><a href="#cb2-24" aria-hidden="true"></a>P1_cat_all_traj =<span class="st"> </span><span class="kw">ggplot</span>(Face2_data_icc, <span class="kw">aes</span>(Time, ROI_Average)) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
     <span id="cb2-25"><a href="#cb2-25" aria-hidden="true"></a>    <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="dv">2</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
     <span id="cb2-26"><a href="#cb2-26" aria-hidden="true"></a>        <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
     <span id="cb2-27"><a href="#cb2-27" aria-hidden="true"></a>        <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>), </span>
     <span id="cb2-28"><a href="#cb2-28" aria-hidden="true"></a>    <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">legend.title =</span> <span class="kw">element_blank</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, </span>
     <span id="cb2-29"><a href="#cb2-29" aria-hidden="true"></a>    <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="fl">0.4</span>, <span class="kw">aes</span>(<span class="dt">linetype =</span> Condition, <span class="dt">colour =</span> Condition)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;dotted&quot;</span>, </span>
     <span id="cb2-30"><a href="#cb2-30" aria-hidden="true"></a>    <span class="st">&quot;longdash&quot;</span>, <span class="st">&quot;solid&quot;</span>, <span class="st">&quot;dotted&quot;</span>, <span class="st">&quot;longdash&quot;</span>, <span class="st">&quot;solid&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#2FA9F5&quot;</span>, </span>
     <span id="cb2-31"><a href="#cb2-31" aria-hidden="true"></a>    <span class="st">&quot;#2FA9F5&quot;</span>, <span class="st">&quot;#2FA9F5&quot;</span>, <span class="st">&quot;#134462&quot;</span>, <span class="st">&quot;#134462&quot;</span>, <span class="st">&quot;#134462&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;P1 &amp; P3&#39;) +</span></span>
     <span id="cb2-32"><a href="#cb2-32" aria-hidden="true"></a><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">Time [ms]&quot;</span>, <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude [&quot;</span>, mu, <span class="st">&quot;V]&quot;</span>)), <span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
     <span id="cb2-33"><a href="#cb2-33" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">18</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">600</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>, </span>
     <span id="cb2-34"><a href="#cb2-34" aria-hidden="true"></a>    <span class="dv">18</span>, <span class="dv">4</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">600</span>, <span class="dv">200</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, </span>
     <span id="cb2-35"><a href="#cb2-35" aria-hidden="true"></a>    <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, </span>
     <span id="cb2-36"><a href="#cb2-36" aria-hidden="true"></a>    <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="dt">xmin =</span> <span class="dv">90</span>, <span class="dt">xmax =</span> <span class="dv">130</span>, <span class="dt">ymin =</span> <span class="fl">-2.5</span>, <span class="dt">ymax =</span> <span class="fl">18.5</span>, </span>
     <span id="cb2-37"><a href="#cb2-37" aria-hidden="true"></a>    <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="dt">xmin =</span> <span class="dv">300</span>, <span class="dt">xmax =</span> <span class="dv">500</span>, <span class="dt">ymin =</span> <span class="fl">-2.5</span>, <span class="dt">ymax =</span> <span class="fl">18.5</span>, </span>
     <span id="cb2-38"><a href="#cb2-38" aria-hidden="true"></a>    <span class="dt">alpha =</span> <span class="fl">0.3</span>)</span>
     <span id="cb2-39"><a href="#cb2-39" aria-hidden="true"></a></span>
     <span id="cb2-40"><a href="#cb2-40" aria-hidden="true"></a><span class="kw">load.Rdata</span>(<span class="dt">filename =</span> <span class="st">&quot;./data/ERP_data.Rdata&quot;</span>, <span class="st">&quot;ERPs&quot;</span>)</span>
     <span id="cb2-41"><a href="#cb2-41" aria-hidden="true"></a></span>
     <span id="cb2-42"><a href="#cb2-42" aria-hidden="true"></a></span>
     <span id="cb2-43"><a href="#cb2-43" aria-hidden="true"></a><span class="co">## Select data</span></span>
     <span id="cb2-44"><a href="#cb2-44" aria-hidden="true"></a>ERPs_sel =<span class="st"> </span><span class="kw">subset</span>(ERPs, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_larger_7s <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span></span>
     <span id="cb2-45"><a href="#cb2-45" aria-hidden="true"></a><span class="st">    </span>Exclude_MAD <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>Group_pcic <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">|</span><span class="st"> </span>Group_pcic <span class="op">==</span><span class="st"> </span><span class="dv">3</span>)</span>
     <span id="cb2-46"><a href="#cb2-46" aria-hidden="true"></a></span>
     <span id="cb2-47"><a href="#cb2-47" aria-hidden="true"></a><span class="co"># Rename values of Face2 condition</span></span>
     <span id="cb2-48"><a href="#cb2-48" aria-hidden="true"></a>ERPs_sel<span class="op">$</span>Condition[ERPs_sel<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">4</span>] =<span class="st"> &quot;happy&quot;</span></span>
     <span id="cb2-49"><a href="#cb2-49" aria-hidden="true"></a>ERPs_sel<span class="op">$</span>Condition[ERPs_sel<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">5</span>] =<span class="st"> &quot;neutral&quot;</span></span>
     <span id="cb2-50"><a href="#cb2-50" aria-hidden="true"></a>ERPs_sel<span class="op">$</span>Condition[ERPs_sel<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">6</span>] =<span class="st"> &quot;angry&quot;</span></span>
     <span id="cb2-51"><a href="#cb2-51" aria-hidden="true"></a>ERPs_sel<span class="op">$</span>Condition[ERPs_sel<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">7</span>] =<span class="st"> &quot;happy&quot;</span></span>
     <span id="cb2-52"><a href="#cb2-52" aria-hidden="true"></a>ERPs_sel<span class="op">$</span>Condition[ERPs_sel<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">8</span>] =<span class="st"> &quot;neutral&quot;</span></span>
     <span id="cb2-53"><a href="#cb2-53" aria-hidden="true"></a>ERPs_sel<span class="op">$</span>Condition[ERPs_sel<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">9</span>] =<span class="st"> &quot;angry&quot;</span></span>
     <span id="cb2-54"><a href="#cb2-54" aria-hidden="true"></a></span>
     <span id="cb2-55"><a href="#cb2-55" aria-hidden="true"></a><span class="co"># Rename variables</span></span>
     <span id="cb2-56"><a href="#cb2-56" aria-hidden="true"></a>ERPs_sel<span class="op">$</span>Group_pcic[ERPs_sel<span class="op">$</span>Group_pcic <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;repeated&quot;</span></span>
     <span id="cb2-57"><a href="#cb2-57" aria-hidden="true"></a>ERPs_sel<span class="op">$</span>Group_pcic[ERPs_sel<span class="op">$</span>Group_pcic <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] =<span class="st"> &quot;novel&quot;</span></span>
     <span id="cb2-58"><a href="#cb2-58" aria-hidden="true"></a></span>
     <span id="cb2-59"><a href="#cb2-59" aria-hidden="true"></a></span>
     <span id="cb2-60"><a href="#cb2-60" aria-hidden="true"></a><span class="co"># Summarize data</span></span>
     <span id="cb2-61"><a href="#cb2-61" aria-hidden="true"></a>stats_P1_all =<span class="st"> </span><span class="kw">summarySEwithin</span>(ERPs_sel, <span class="dt">measurevar =</span> <span class="st">&quot;mean_ROI_P1&quot;</span>, <span class="dt">withinvars =</span> <span class="kw">c</span>(<span class="st">&quot;Group_pcic&quot;</span>, </span>
     <span id="cb2-62"><a href="#cb2-62" aria-hidden="true"></a>    <span class="st">&quot;Condition&quot;</span>), <span class="dt">idvar =</span> <span class="st">&quot;ID&quot;</span>)</span>
     <span id="cb2-63"><a href="#cb2-63" aria-hidden="true"></a></span>
     <span id="cb2-64"><a href="#cb2-64" aria-hidden="true"></a></span>
     <span id="cb2-65"><a href="#cb2-65" aria-hidden="true"></a><span class="co"># Plot</span></span>
     <span id="cb2-66"><a href="#cb2-66" aria-hidden="true"></a>P1_plot =<span class="st"> </span><span class="kw">ggplot</span>(stats_P1_all, <span class="kw">aes</span>(<span class="dt">x =</span> Condition, <span class="dt">y =</span> mean_ROI_P1, <span class="dt">fill =</span> Group_pcic)) <span class="op">+</span><span class="st"> </span></span>
     <span id="cb2-67"><a href="#cb2-67" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>(), <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="fl">0.5</span>, </span>
     <span id="cb2-68"><a href="#cb2-68" aria-hidden="true"></a>        <span class="dt">width =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> mean_ROI_P1 <span class="op">-</span><span class="st"> </span>se, <span class="dt">ymax =</span> mean_ROI_P1 <span class="op">+</span><span class="st"> </span></span>
     <span id="cb2-69"><a href="#cb2-69" aria-hidden="true"></a><span class="st">    </span>se), <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="fl">0.9</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, </span>
     <span id="cb2-70"><a href="#cb2-70" aria-hidden="true"></a>    <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude [&quot;</span>, mu, <span class="st">&quot;V]&quot;</span>)), <span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> nov_col) <span class="op">+</span><span class="st"> </span></span>
     <span id="cb2-71"><a href="#cb2-71" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">20</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">25</span>, <span class="dv">5</span>)) <span class="op">+</span><span class="st"> </span></span>
     <span id="cb2-72"><a href="#cb2-72" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span>theme_SN <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;left&quot;</span>, <span class="dt">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
     <span id="cb2-73"><a href="#cb2-73" aria-hidden="true"></a>    <span class="dt">legend.key.size =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>), <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="fl">0.5</span>, <span class="st">&quot;cm&quot;</span>), <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">7</span>), </span>
     <span id="cb2-74"><a href="#cb2-74" aria-hidden="true"></a>    <span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>), <span class="dt">legend.title =</span> <span class="kw">element_blank</span>(), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
     <span id="cb2-75"><a href="#cb2-75" aria-hidden="true"></a>        <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">20</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)))</span>
     <span id="cb2-76"><a href="#cb2-76" aria-hidden="true"></a></span>
     <span id="cb2-77"><a href="#cb2-77" aria-hidden="true"></a><span class="co"># Put plots together</span></span>
     <span id="cb2-78"><a href="#cb2-78" aria-hidden="true"></a>plots_EEG_F2 =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(P1_cat_all_traj <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>), </span>
     <span id="cb2-79"><a href="#cb2-79" aria-hidden="true"></a>    legend_ERP, <span class="dt">align =</span> <span class="st">&quot;vh&quot;</span>, <span class="dt">hjust =</span> <span class="dv">-1</span>, <span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">0.3</span>))</span>
     <span id="cb2-80"><a href="#cb2-80" aria-hidden="true"></a></span>
     <span id="cb2-81"><a href="#cb2-81" aria-hidden="true"></a>legend_behav =<span class="st"> </span><span class="kw">get_legend</span>(P1_plot)</span>
     <span id="cb2-82"><a href="#cb2-82" aria-hidden="true"></a></span>
     <span id="cb2-83"><a href="#cb2-83" aria-hidden="true"></a>plots_EEG_F2_<span class="dv">2</span> =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(legend_behav, P1_plot <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>), </span>
     <span id="cb2-84"><a href="#cb2-84" aria-hidden="true"></a>    <span class="dt">align =</span> <span class="st">&quot;vh&quot;</span>, <span class="dt">hjust =</span> <span class="dv">-1</span>, <span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="fl">0.4</span>, <span class="dv">1</span>))</span>
     <span id="cb2-85"><a href="#cb2-85" aria-hidden="true"></a></span>
     <span id="cb2-86"><a href="#cb2-86" aria-hidden="true"></a><span class="co"># Display plot https://wilkelab.org/cowplot/articles/shared_legends.html</span></span>
     <span id="cb2-87"><a href="#cb2-87" aria-hidden="true"></a>fig_rep_ERP =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(plots_EEG_F2, plots_EEG_F2_<span class="dv">2</span>, <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="fl">0.7</span>, </span>
     <span id="cb2-88"><a href="#cb2-88" aria-hidden="true"></a>    <span class="fl">0.6</span>))</span>
     <span id="cb2-89"><a href="#cb2-89" aria-hidden="true"></a></span>
     <span id="cb2-90"><a href="#cb2-90" aria-hidden="true"></a><span class="co"># Get topographies</span></span>
     <span id="cb2-91"><a href="#cb2-91" aria-hidden="true"></a>Topo_Cat =<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file =</span> <span class="st">&quot;./data/ERPs_Topo_Face2.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
     <span id="cb2-92"><a href="#cb2-92" aria-hidden="true"></a></span>
     <span id="cb2-93"><a href="#cb2-93" aria-hidden="true"></a><span class="co"># Remove participant 5</span></span>
     <span id="cb2-94"><a href="#cb2-94" aria-hidden="true"></a>Topo_Cat =<span class="st"> </span>Topo_Cat[<span class="kw">with</span>(Topo_Cat, <span class="op">!</span>(Topo_Cat<span class="op">$</span>ID <span class="op">==</span><span class="st"> </span><span class="dv">5</span>)), ]</span>
     <span id="cb2-95"><a href="#cb2-95" aria-hidden="true"></a></span>
     <span id="cb2-96"><a href="#cb2-96" aria-hidden="true"></a><span class="co"># Re-name to fit topoplot function</span></span>
     <span id="cb2-97"><a href="#cb2-97" aria-hidden="true"></a><span class="kw">names</span>(Topo_Cat)[<span class="kw">names</span>(Topo_Cat) <span class="op">==</span><span class="st"> &quot;Time&quot;</span>] =<span class="st"> &quot;time&quot;</span></span>
     <span id="cb2-98"><a href="#cb2-98" aria-hidden="true"></a></span>
     <span id="cb2-99"><a href="#cb2-99" aria-hidden="true"></a><span class="co"># Change from wide to long format for electrodes</span></span>
     <span id="cb2-100"><a href="#cb2-100" aria-hidden="true"></a>Topo_Cat =<span class="st"> </span><span class="kw">gather</span>(Topo_Cat, electrode, amplitude, Fp1<span class="op">:</span>Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
     <span id="cb2-101"><a href="#cb2-101" aria-hidden="true"></a></span>
     <span id="cb2-102"><a href="#cb2-102" aria-hidden="true"></a><span class="co"># Rename A1/A2</span></span>
     <span id="cb2-103"><a href="#cb2-103" aria-hidden="true"></a><span class="kw">names</span>(Topo_Cat)[<span class="kw">names</span>(Topo_Cat) <span class="op">==</span><span class="st"> &quot;A1&quot;</span>] =<span class="st"> &quot;TP9&quot;</span></span>
     <span id="cb2-104"><a href="#cb2-104" aria-hidden="true"></a><span class="kw">names</span>(Topo_Cat)[<span class="kw">names</span>(Topo_Cat) <span class="op">==</span><span class="st"> &quot;A2&quot;</span>] =<span class="st"> &quot;TP10&quot;</span></span>
     <span id="cb2-105"><a href="#cb2-105" aria-hidden="true"></a></span>
     <span id="cb2-106"><a href="#cb2-106" aria-hidden="true"></a><span class="co"># Plot topoplots for repeated / novel emotion trials</span></span>
     <span id="cb2-107"><a href="#cb2-107" aria-hidden="true"></a>Topo_Cat_rep_hap =<span class="st"> </span><span class="kw">subset</span>(Topo_Cat, Condition <span class="op">==</span><span class="st"> </span><span class="dv">4</span>)</span>
     <span id="cb2-108"><a href="#cb2-108" aria-hidden="true"></a>Topo_Cat_rep_neu =<span class="st"> </span><span class="kw">subset</span>(Topo_Cat, Condition <span class="op">==</span><span class="st"> </span><span class="dv">5</span>)</span>
     <span id="cb2-109"><a href="#cb2-109" aria-hidden="true"></a>Topo_Cat_rep_ang =<span class="st"> </span><span class="kw">subset</span>(Topo_Cat, Condition <span class="op">==</span><span class="st"> </span><span class="dv">6</span>)</span>
     <span id="cb2-110"><a href="#cb2-110" aria-hidden="true"></a>Topo_Cat_nov_hap =<span class="st"> </span><span class="kw">subset</span>(Topo_Cat, Condition <span class="op">==</span><span class="st"> </span><span class="dv">7</span>)</span>
     <span id="cb2-111"><a href="#cb2-111" aria-hidden="true"></a>Topo_Cat_nov_neu =<span class="st"> </span><span class="kw">subset</span>(Topo_Cat, Condition <span class="op">==</span><span class="st"> </span><span class="dv">8</span>)</span>
     <span id="cb2-112"><a href="#cb2-112" aria-hidden="true"></a></span>
     <span id="cb2-113"><a href="#cb2-113" aria-hidden="true"></a><span class="co"># Calculate difference scores for different contrasts</span></span>
     <span id="cb2-114"><a href="#cb2-114" aria-hidden="true"></a>Topo_Diff_nov_hap_neu =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> Topo_Cat_rep_hap[, <span class="dv">1</span>], <span class="dt">time =</span> Topo_Cat_rep_hap[, </span>
     <span id="cb2-115"><a href="#cb2-115" aria-hidden="true"></a>    <span class="dv">3</span>], <span class="dt">electrode =</span> Topo_Cat_rep_hap[, <span class="dv">4</span>], <span class="dt">amplitude =</span> Topo_Cat_nov_hap<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span></span>
     <span id="cb2-116"><a href="#cb2-116" aria-hidden="true"></a><span class="st">    </span>Topo_Cat_nov_neu<span class="op">$</span>amplitude)</span>
     <span id="cb2-117"><a href="#cb2-117" aria-hidden="true"></a></span>
     <span id="cb2-118"><a href="#cb2-118" aria-hidden="true"></a>Topo_Diff_rep_hap_nov_neu =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> Topo_Cat_rep_hap[, <span class="dv">1</span>], <span class="dt">time =</span> Topo_Cat_rep_hap[, </span>
     <span id="cb2-119"><a href="#cb2-119" aria-hidden="true"></a>    <span class="dv">3</span>], <span class="dt">electrode =</span> Topo_Cat_rep_hap[, <span class="dv">4</span>], <span class="dt">amplitude =</span> Topo_Cat_rep_hap<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span></span>
     <span id="cb2-120"><a href="#cb2-120" aria-hidden="true"></a><span class="st">    </span>Topo_Cat_nov_neu<span class="op">$</span>amplitude)</span>
     <span id="cb2-121"><a href="#cb2-121" aria-hidden="true"></a></span>
     <span id="cb2-122"><a href="#cb2-122" aria-hidden="true"></a>Topo_Diff_rep_ang_nov_neu =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> Topo_Cat_rep_hap[, <span class="dv">1</span>], <span class="dt">time =</span> Topo_Cat_rep_hap[, </span>
     <span id="cb2-123"><a href="#cb2-123" aria-hidden="true"></a>    <span class="dv">3</span>], <span class="dt">electrode =</span> Topo_Cat_rep_hap[, <span class="dv">4</span>], <span class="dt">amplitude =</span> Topo_Cat_rep_ang<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span></span>
     <span id="cb2-124"><a href="#cb2-124" aria-hidden="true"></a><span class="st">    </span>Topo_Cat_nov_neu<span class="op">$</span>amplitude)</span>
     <span id="cb2-125"><a href="#cb2-125" aria-hidden="true"></a></span>
     <span id="cb2-126"><a href="#cb2-126" aria-hidden="true"></a>Topo_Diff_rep_neu_nov_neu =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> Topo_Cat_rep_hap[, <span class="dv">1</span>], <span class="dt">time =</span> Topo_Cat_rep_hap[, </span>
     <span id="cb2-127"><a href="#cb2-127" aria-hidden="true"></a>    <span class="dv">3</span>], <span class="dt">electrode =</span> Topo_Cat_rep_hap[, <span class="dv">4</span>], <span class="dt">amplitude =</span> Topo_Cat_rep_neu<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span></span>
     <span id="cb2-128"><a href="#cb2-128" aria-hidden="true"></a><span class="st">    </span>Topo_Cat_nov_neu<span class="op">$</span>amplitude)</span>
     <span id="cb2-129"><a href="#cb2-129" aria-hidden="true"></a></span>
     <span id="cb2-130"><a href="#cb2-130" aria-hidden="true"></a><span class="co">## P1</span></span>
     <span id="cb2-131"><a href="#cb2-131" aria-hidden="true"></a></span>
     <span id="cb2-132"><a href="#cb2-132" aria-hidden="true"></a><span class="co"># Select time windows</span></span>
     <span id="cb2-133"><a href="#cb2-133" aria-hidden="true"></a>Topo_Diff_nov_hap_neu_P1 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_nov_hap_neu, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">90</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">130</span>)</span>
     <span id="cb2-134"><a href="#cb2-134" aria-hidden="true"></a>Topo_Diff_rep_hap_nov_neu_P1 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_rep_hap_nov_neu, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">90</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span></span>
     <span id="cb2-135"><a href="#cb2-135" aria-hidden="true"></a><span class="st">    </span><span class="dv">130</span>)</span>
     <span id="cb2-136"><a href="#cb2-136" aria-hidden="true"></a>Topo_Diff_rep_ang_nov_neu_P1 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_rep_ang_nov_neu, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">90</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span></span>
     <span id="cb2-137"><a href="#cb2-137" aria-hidden="true"></a><span class="st">    </span><span class="dv">130</span>)</span>
     <span id="cb2-138"><a href="#cb2-138" aria-hidden="true"></a>Topo_Diff_rep_neu_nov_neu_P1 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_rep_neu_nov_neu, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">90</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span></span>
     <span id="cb2-139"><a href="#cb2-139" aria-hidden="true"></a><span class="st">    </span><span class="dv">130</span>)</span>
     <span id="cb2-140"><a href="#cb2-140" aria-hidden="true"></a></span>
     <span id="cb2-141"><a href="#cb2-141" aria-hidden="true"></a><span class="co"># Add electrode information</span></span>
     <span id="cb2-142"><a href="#cb2-142" aria-hidden="true"></a>Topo_Diff_nov_hap_neu_P1 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_nov_hap_neu_P1, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, </span>
     <span id="cb2-143"><a href="#cb2-143" aria-hidden="true"></a>    <span class="dt">drop =</span> <span class="ot">FALSE</span>, <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
     <span id="cb2-144"><a href="#cb2-144" aria-hidden="true"></a>Topo_Diff_rep_hap_nov_neu_P1 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_rep_hap_nov_neu_P1, </span>
     <span id="cb2-145"><a href="#cb2-145" aria-hidden="true"></a>    <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, <span class="dt">drop =</span> <span class="ot">FALSE</span>, <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
     <span id="cb2-146"><a href="#cb2-146" aria-hidden="true"></a>Topo_Diff_rep_ang_nov_neu_P1 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_rep_ang_nov_neu_P1, </span>
     <span id="cb2-147"><a href="#cb2-147" aria-hidden="true"></a>    <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, <span class="dt">drop =</span> <span class="ot">FALSE</span>, <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
     <span id="cb2-148"><a href="#cb2-148" aria-hidden="true"></a>Topo_Diff_rep_neu_nov_neu_P1 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_rep_neu_nov_neu_P1, </span>
     <span id="cb2-149"><a href="#cb2-149" aria-hidden="true"></a>    <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, <span class="dt">drop =</span> <span class="ot">FALSE</span>, <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
     <span id="cb2-150"><a href="#cb2-150" aria-hidden="true"></a></span>
     <span id="cb2-151"><a href="#cb2-151" aria-hidden="true"></a></span>
     <span id="cb2-152"><a href="#cb2-152" aria-hidden="true"></a><span class="co"># Create topographies</span></span>
     <span id="cb2-153"><a href="#cb2-153" aria-hidden="true"></a>topo_diff_nov_hap_neu_P1 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_nov_hap_neu_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, </span>
     <span id="cb2-154"><a href="#cb2-154" aria-hidden="true"></a>    <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;nov. hap. – nov. neu.&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, </span>
     <span id="cb2-155"><a href="#cb2-155" aria-hidden="true"></a>    <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>, <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span></span>
     <span id="cb2-156"><a href="#cb2-156" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">2.5</span>, <span class="fl">3.5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span></span>
     <span id="cb2-157"><a href="#cb2-157" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </span>
     <span id="cb2-158"><a href="#cb2-158" aria-hidden="true"></a>    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
     <span id="cb2-159"><a href="#cb2-159" aria-hidden="true"></a></span>
     <span id="cb2-160"><a href="#cb2-160" aria-hidden="true"></a></span>
     <span id="cb2-161"><a href="#cb2-161" aria-hidden="true"></a>topo_diff_rep_hap_nov_neu_P1 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_rep_hap_nov_neu_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, </span>
     <span id="cb2-162"><a href="#cb2-162" aria-hidden="true"></a>    <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;rep. hap. – nov. neu.&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, </span>
     <span id="cb2-163"><a href="#cb2-163" aria-hidden="true"></a>    <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>, <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span></span>
     <span id="cb2-164"><a href="#cb2-164" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">2.5</span>, <span class="fl">3.5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span></span>
     <span id="cb2-165"><a href="#cb2-165" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </span>
     <span id="cb2-166"><a href="#cb2-166" aria-hidden="true"></a>    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
     <span id="cb2-167"><a href="#cb2-167" aria-hidden="true"></a></span>
     <span id="cb2-168"><a href="#cb2-168" aria-hidden="true"></a>topo_diff_rep_ang_nov_neu_P1 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_rep_ang_nov_neu_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, </span>
     <span id="cb2-169"><a href="#cb2-169" aria-hidden="true"></a>    <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;rep. ang. – nov. neu.&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, </span>
     <span id="cb2-170"><a href="#cb2-170" aria-hidden="true"></a>    <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>, <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span></span>
     <span id="cb2-171"><a href="#cb2-171" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">2.5</span>, <span class="fl">3.5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span></span>
     <span id="cb2-172"><a href="#cb2-172" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </span>
     <span id="cb2-173"><a href="#cb2-173" aria-hidden="true"></a>    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
     <span id="cb2-174"><a href="#cb2-174" aria-hidden="true"></a></span>
     <span id="cb2-175"><a href="#cb2-175" aria-hidden="true"></a></span>
     <span id="cb2-176"><a href="#cb2-176" aria-hidden="true"></a>topo_diff_rep_neu_nov_neu_P1 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_rep_neu_nov_neu_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, </span>
     <span id="cb2-177"><a href="#cb2-177" aria-hidden="true"></a>    <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;rep. neu. – nov. neu.&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, </span>
     <span id="cb2-178"><a href="#cb2-178" aria-hidden="true"></a>    <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>, <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span></span>
     <span id="cb2-179"><a href="#cb2-179" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">2.5</span>, <span class="fl">3.5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span></span>
     <span id="cb2-180"><a href="#cb2-180" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </span>
     <span id="cb2-181"><a href="#cb2-181" aria-hidden="true"></a>    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>))</span>
     <span id="cb2-182"><a href="#cb2-182" aria-hidden="true"></a></span>
     <span id="cb2-183"><a href="#cb2-183" aria-hidden="true"></a><span class="co"># Get topography legend</span></span>
     <span id="cb2-184"><a href="#cb2-184" aria-hidden="true"></a>topo_diff_nov_hap_neu_P1_leg =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_nov_hap_neu_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, </span>
     <span id="cb2-185"><a href="#cb2-185" aria-hidden="true"></a>    <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;P1 (90-130 ms)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, </span>
     <span id="cb2-186"><a href="#cb2-186" aria-hidden="true"></a>    <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>, <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span></span>
     <span id="cb2-187"><a href="#cb2-187" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">2.5</span>, <span class="fl">3.5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span></span>
     <span id="cb2-188"><a href="#cb2-188" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;&quot;</span>, mu, <span class="st">&quot;V&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>, </span>
     <span id="cb2-189"><a href="#cb2-189" aria-hidden="true"></a>    <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>), <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">7</span>), </span>
     <span id="cb2-190"><a href="#cb2-190" aria-hidden="true"></a>    <span class="dt">legend.key.size =</span> <span class="kw">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>))</span>
     <span id="cb2-191"><a href="#cb2-191" aria-hidden="true"></a></span>
     <span id="cb2-192"><a href="#cb2-192" aria-hidden="true"></a></span>
     <span id="cb2-193"><a href="#cb2-193" aria-hidden="true"></a><span class="co">## Display plots https://wilkelab.org/cowplot/articles/shared_legends.html</span></span>
     <span id="cb2-194"><a href="#cb2-194" aria-hidden="true"></a>topo_leg =<span class="st"> </span><span class="kw">get_legend</span>(topo_diff_nov_hap_neu_P1_leg)</span>
     <span id="cb2-195"><a href="#cb2-195" aria-hidden="true"></a>fig_Face_<span class="dv">2</span>_topo =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(topo_diff_nov_hap_neu_P1, topo_diff_rep_hap_nov_neu_P1, </span>
     <span id="cb2-196"><a href="#cb2-196" aria-hidden="true"></a>    topo_diff_rep_ang_nov_neu_P1, topo_diff_rep_neu_nov_neu_P1, topo_leg, <span class="dt">ncol =</span> <span class="dv">5</span>)</span>
     <span id="cb2-197"><a href="#cb2-197" aria-hidden="true"></a></span>
     <span id="cb2-198"><a href="#cb2-198" aria-hidden="true"></a>fig_Face2_cat =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(fig_rep_ERP, fig_Face_<span class="dv">2</span>_topo, <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">rel_heights =</span> <span class="kw">c</span>(<span class="dv">2</span>, </span>
     <span id="cb2-199"><a href="#cb2-199" aria-hidden="true"></a>    <span class="dv">1</span>), <span class="dt">align =</span> <span class="st">&quot;v&quot;</span>)</span>
     <span id="cb2-200"><a href="#cb2-200" aria-hidden="true"></a></span>
     <span id="cb2-201"><a href="#cb2-201" aria-hidden="true"></a>fig_Face2_cat</span></code></pre></div>
     <p><img src="R_Script_3_ERP_measures_files/figure-html/ERP_cat_plot-1.png" width="768" style="display: block; margin: auto;" /></p>
     </div>
     <div id="section" class="section level2">
     <h2><br><br></h2>
     <div id="model-specification" class="section level3 tabset tabset-pills">
     <h3 class="tabset tabset-pills"><strong>Model specification</strong></h3>
     <ul>
     <li>_val = ERP LMMs for Face 1</li>
     <li>_rep = ERP LMMs for Face 2</li>
     </ul>
     <div id="lmm_p1_val-random-effect-structure" class="section level4">
     <h4>LMM_P1_val: Random effect structure</h4>
     <div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="co"># Select Face 1</span></span>
     <span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a>P1_Val =<span class="st"> </span><span class="kw">subset</span>(ERP_data, Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
     <span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a></span>
     <span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a><span class="co"># Prepare fixed factors</span></span>
     <span id="cb3-5"><a href="#cb3-5" aria-hidden="true"></a>P1_Val<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(P1_Val<span class="op">$</span>ID)</span>
     <span id="cb3-6"><a href="#cb3-6" aria-hidden="true"></a>P1_Val<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(P1_Val<span class="op">$</span>Stim_Type)</span>
     <span id="cb3-7"><a href="#cb3-7" aria-hidden="true"></a></span>
     <span id="cb3-8"><a href="#cb3-8" aria-hidden="true"></a><span class="co"># Re-code emotion condition</span></span>
     <span id="cb3-9"><a href="#cb3-9" aria-hidden="true"></a>P1_Val<span class="op">$</span>Condition[P1_Val<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;happy&quot;</span></span>
     <span id="cb3-10"><a href="#cb3-10" aria-hidden="true"></a>P1_Val<span class="op">$</span>Condition[P1_Val<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;neutral&quot;</span></span>
     <span id="cb3-11"><a href="#cb3-11" aria-hidden="true"></a>P1_Val<span class="op">$</span>Condition[P1_Val<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] =<span class="st"> &quot;angry&quot;</span></span>
     <span id="cb3-12"><a href="#cb3-12" aria-hidden="true"></a></span>
     <span id="cb3-13"><a href="#cb3-13" aria-hidden="true"></a><span class="co"># Create factor &amp; set neutral as baseline</span></span>
     <span id="cb3-14"><a href="#cb3-14" aria-hidden="true"></a>P1_Val<span class="op">$</span>Condition =<span class="st"> </span><span class="kw">factor</span>(P1_Val<span class="op">$</span>Condition)</span>
     <span id="cb3-15"><a href="#cb3-15" aria-hidden="true"></a></span>
     <span id="cb3-16"><a href="#cb3-16" aria-hidden="true"></a><span class="kw">contrasts</span>(P1_Val<span class="op">$</span>Condition) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>, <span class="dt">base =</span> <span class="dv">3</span>)</span>
     <span id="cb3-17"><a href="#cb3-17" aria-hidden="true"></a></span>
     <span id="cb3-18"><a href="#cb3-18" aria-hidden="true"></a><span class="co"># A = angry, N = neutral, H = happy</span></span>
     <span id="cb3-19"><a href="#cb3-19" aria-hidden="true"></a>HvsA =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">-0.5</span>, <span class="dv">0</span>)</span>
     <span id="cb3-20"><a href="#cb3-20" aria-hidden="true"></a>EvsN =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">0</span>)</span>
     <span id="cb3-21"><a href="#cb3-21" aria-hidden="true"></a><span class="kw">contrasts</span>(P1_Val<span class="op">$</span>Condition) =<span class="st"> </span><span class="kw">cbind</span>(EvsN, HvsA)</span>
     <span id="cb3-22"><a href="#cb3-22" aria-hidden="true"></a></span>
     <span id="cb3-23"><a href="#cb3-23" aria-hidden="true"></a><span class="co"># Add contrast columns</span></span>
     <span id="cb3-24"><a href="#cb3-24" aria-hidden="true"></a>mm_P1_Val =<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span>Condition, P1_Val)</span>
     <span id="cb3-25"><a href="#cb3-25" aria-hidden="true"></a></span>
     <span id="cb3-26"><a href="#cb3-26" aria-hidden="true"></a><span class="co"># Attach to dataframe</span></span>
     <span id="cb3-27"><a href="#cb3-27" aria-hidden="true"></a>P1_Val[, (<span class="kw">ncol</span>(P1_Val) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(P1_Val) <span class="op">+</span><span class="st"> </span><span class="dv">3</span>)] =<span class="st"> </span>mm_P1_Val</span>
     <span id="cb3-28"><a href="#cb3-28" aria-hidden="true"></a><span class="kw">names</span>(P1_Val)[(<span class="kw">ncol</span>(P1_Val) <span class="op">-</span><span class="st"> </span><span class="dv">2</span>)<span class="op">:</span><span class="kw">ncol</span>(P1_Val)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;Emo_Neu&quot;</span>, <span class="st">&quot;Hap_Ang&quot;</span>)</span>
     <span id="cb3-29"><a href="#cb3-29" aria-hidden="true"></a></span>
     <span id="cb3-30"><a href="#cb3-30" aria-hidden="true"></a><span class="co"># Build model</span></span>
     <span id="cb3-31"><a href="#cb3-31" aria-hidden="true"></a>mod_P1_val.lmer1 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P1 <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>contr_F1_scal <span class="op">+</span><span class="st"> </span></span>
     <span id="cb3-32"><a href="#cb3-32" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> P1_Val, </span>
     <span id="cb3-33"><a href="#cb3-33" aria-hidden="true"></a>    <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
     <span id="cb3-34"><a href="#cb3-34" aria-hidden="true"></a></span>
     <span id="cb3-35"><a href="#cb3-35" aria-hidden="true"></a><span class="co"># 1st: check how many zero variance terms you got in random effects</span></span>
     <span id="cb3-36"><a href="#cb3-36" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_P1_val.lmer1))</span>
     <span id="cb3-37"><a href="#cb3-37" aria-hidden="true"></a></span>
     <span id="cb3-38"><a href="#cb3-38" aria-hidden="true"></a><span class="co"># 2nd: check which random terms explain the least variance</span></span>
     <span id="cb3-39"><a href="#cb3-39" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_P1_val.lmer1), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
     <span id="cb3-40"><a href="#cb3-40" aria-hidden="true"></a></span>
     <span id="cb3-41"><a href="#cb3-41" aria-hidden="true"></a><span class="co"># Remove intercepts/slopes based on variance check</span></span>
     <span id="cb3-42"><a href="#cb3-42" aria-hidden="true"></a>mod_P1_val.lmer2 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P1 <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>contr_F1_scal <span class="op">+</span><span class="st"> </span></span>
     <span id="cb3-43"><a href="#cb3-43" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> P1_Val, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
     <span id="cb3-44"><a href="#cb3-44" aria-hidden="true"></a></span>
     <span id="cb3-45"><a href="#cb3-45" aria-hidden="true"></a><span class="co"># Re-check the model</span></span>
     <span id="cb3-46"><a href="#cb3-46" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_P1_val.lmer2))</span>
     <span id="cb3-47"><a href="#cb3-47" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_P1_val.lmer2), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
     <span id="cb3-48"><a href="#cb3-48" aria-hidden="true"></a></span>
     <span id="cb3-49"><a href="#cb3-49" aria-hidden="true"></a><span class="co"># Likelihood ratio testing</span></span>
     <span id="cb3-50"><a href="#cb3-50" aria-hidden="true"></a></span>
     <span id="cb3-51"><a href="#cb3-51" aria-hidden="true"></a><span class="co"># For ID</span></span>
     <span id="cb3-52"><a href="#cb3-52" aria-hidden="true"></a>mod_P1_val.lmer3 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P1 <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>contr_F1_scal <span class="op">+</span><span class="st"> </span></span>
     <span id="cb3-53"><a href="#cb3-53" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> P1_Val, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
     <span id="cb3-54"><a href="#cb3-54" aria-hidden="true"></a><span class="co"># Calculate ANOVA</span></span>
     <span id="cb3-55"><a href="#cb3-55" aria-hidden="true"></a><span class="kw">anova</span>(mod_P1_val.lmer2, mod_P1_val.lmer3)</span>
     <span id="cb3-56"><a href="#cb3-56" aria-hidden="true"></a></span>
     <span id="cb3-57"><a href="#cb3-57" aria-hidden="true"></a><span class="co"># Stimulus type</span></span>
     <span id="cb3-58"><a href="#cb3-58" aria-hidden="true"></a>mod_P1_val.lmer4 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P1 <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>contr_F1_scal <span class="op">+</span><span class="st"> </span></span>
     <span id="cb3-59"><a href="#cb3-59" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> P1_Val, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
     <span id="cb3-60"><a href="#cb3-60" aria-hidden="true"></a></span>
     <span id="cb3-61"><a href="#cb3-61" aria-hidden="true"></a><span class="co"># Calculate ANOVA</span></span>
     <span id="cb3-62"><a href="#cb3-62" aria-hidden="true"></a><span class="kw">anova</span>(mod_P1_val.lmer2, mod_P1_val.lmer4)</span>
     <span id="cb3-63"><a href="#cb3-63" aria-hidden="true"></a></span>
     <span id="cb3-64"><a href="#cb3-64" aria-hidden="true"></a><span class="co"># Without Stimulus type</span></span>
     <span id="cb3-65"><a href="#cb3-65" aria-hidden="true"></a>mod_P1_val.lmer4 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P1 <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>contr_F1_scal <span class="op">+</span><span class="st"> </span></span>
     <span id="cb3-66"><a href="#cb3-66" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID), <span class="dt">data =</span> P1_Val, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
     <span id="cb3-67"><a href="#cb3-67" aria-hidden="true"></a></span>
     <span id="cb3-68"><a href="#cb3-68" aria-hidden="true"></a><span class="co"># Calculate ANOVA</span></span>
     <span id="cb3-69"><a href="#cb3-69" aria-hidden="true"></a><span class="kw">anova</span>(mod_P1_val.lmer2, mod_P1_val.lmer4)</span>
     <span id="cb3-70"><a href="#cb3-70" aria-hidden="true"></a></span>
     <span id="cb3-71"><a href="#cb3-71" aria-hidden="true"></a><span class="co"># Final model</span></span>
     <span id="cb3-72"><a href="#cb3-72" aria-hidden="true"></a>mod_P1_val.lmer4 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P1 <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>contr_F1_scal <span class="op">+</span><span class="st"> </span></span>
     <span id="cb3-73"><a href="#cb3-73" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID), <span class="dt">data =</span> P1_Val, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span></code></pre></div>
     <p><br></p>
     <p>The final model was comprised of:</p>
     <p><code>mean_ROI_P1 ~ Emo_Neu + Hap_Ang + WM_scal + contr_F1_scal + (1 | ,     ID)</code></p>
     <hr />
     </div>
     <div id="lmm_p1_val-normality-of-residuals" class="section level4">
     <h4>LMM_P1_val: Normality of residuals</h4>
     <div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="co"># Set treatment contrast</span></span>
     <span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a><span class="kw">contrasts</span>(P1_Val<span class="op">$</span>Condition) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>)</span>
     <span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a></span>
     <span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a><span class="co">## Check properties of DV / residuals</span></span>
     <span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a>P1_Val<span class="op">$</span>Trans_P1 =<span class="st"> </span>P1_Val<span class="op">$</span>mean_ROI_P1 <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(P1_Val<span class="op">$</span>mean_ROI_P1)</span>
     <span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a></span>
     <span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a><span class="co"># To make sure residuals follow ND: Calculate box-cox plot</span></span>
     <span id="cb4-8"><a href="#cb4-8" aria-hidden="true"></a><span class="kw">boxcox</span>(P1_Val<span class="op">$</span>Trans_P1 <span class="op">~</span><span class="st"> </span>P1_Val<span class="op">$</span>Condition)</span></code></pre></div>
     <p><img src="R_Script_3_ERP_measures_files/figure-html/P1_val_res_box-1.png" width="576" style="display: block; margin: auto;" /></p>
     <p>P1 amplitudes met the assumption of normally distributed residuals.</p>
     <div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="co"># Visualize normality assumption of residuals (without log transform)</span></span>
     <span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a>mod_P1_val =<span class="st"> </span><span class="kw">lm</span>(Trans_P1 <span class="op">~</span><span class="st"> </span>Condition, <span class="dt">data =</span> P1_Val)</span>
     <span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a>res.mod_P1_val =<span class="st"> </span><span class="kw">residuals</span>(mod_P1_val)</span>
     <span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a></span>
     <span id="cb5-5"><a href="#cb5-5" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
     <span id="cb5-6"><a href="#cb5-6" aria-hidden="true"></a>qqpl_mod_P1_val =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_P1_val, <span class="dt">main =</span> <span class="st">&quot;QQplot before transformation&quot;</span>)</span>
     <span id="cb5-7"><a href="#cb5-7" aria-hidden="true"></a>norm_mod_P1_val =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_P1_val), <span class="dt">main =</span> <span class="st">&quot;Density plot before transformation&quot;</span>)</span></code></pre></div>
     <p><img src="R_Script_3_ERP_measures_files/figure-html/P1_val_res_plot-1.png" width="576" style="display: block; margin: auto;" /></p>
     <div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
     <hr />
     </div>
     <div id="lmm_p1_val-homoscedasticity" class="section level4">
     <h4>LMM_P1_val: Homoscedasticity</h4>
     <div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="co"># Check homoscedasticity</span></span>
     <span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">fitted</span>(mod_P1_val.lmer4), <span class="kw">residuals</span>(mod_P1_val.lmer4))</span>
     <span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span></code></pre></div>
     <p><img src="R_Script_3_ERP_measures_files/figure-html/P1_val_homosk-1.png" width="576" style="display: block; margin: auto;" /></p>
     <p>Based on visual inspection, we assumed homoscedasticity.</p>
     <hr />
     </div>
     <div id="lmm_n170_val-random-effect-structure" class="section level4">
     <h4>LMM_N170_val: Random effect structure</h4>
     <div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="co"># Transform dataset so that left/right hemisphere are accounted for</span></span>
     <span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a>N170_Val =<span class="st"> </span><span class="kw">gather</span>(ERP_data, Elect_site, N170_Amplitude, mean_ROI_N170l<span class="op">:</span>mean_ROI_N170r, </span>
     <span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a>    <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
     <span id="cb8-4"><a href="#cb8-4" aria-hidden="true"></a></span>
     <span id="cb8-5"><a href="#cb8-5" aria-hidden="true"></a><span class="co"># Add variable name</span></span>
     <span id="cb8-6"><a href="#cb8-6" aria-hidden="true"></a>N170_Val<span class="op">$</span>Elect_site =<span class="st"> </span><span class="kw">as.character</span>(N170_Val<span class="op">$</span>Elect_site)</span>
     <span id="cb8-7"><a href="#cb8-7" aria-hidden="true"></a>N170_Val<span class="op">$</span>Elect_site[N170_Val<span class="op">$</span>Elect_site <span class="op">==</span><span class="st"> &quot;mean_ROI_N170l&quot;</span>] =<span class="st"> &quot;left&quot;</span></span>
     <span id="cb8-8"><a href="#cb8-8" aria-hidden="true"></a>N170_Val<span class="op">$</span>Elect_site[N170_Val<span class="op">$</span>Elect_site <span class="op">==</span><span class="st"> &quot;mean_ROI_N170r&quot;</span>] =<span class="st"> &quot;right&quot;</span></span>
     <span id="cb8-9"><a href="#cb8-9" aria-hidden="true"></a></span>
     <span id="cb8-10"><a href="#cb8-10" aria-hidden="true"></a><span class="co"># Prepare fixed factors</span></span>
     <span id="cb8-11"><a href="#cb8-11" aria-hidden="true"></a>N170_Val<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(N170_Val<span class="op">$</span>ID)</span>
     <span id="cb8-12"><a href="#cb8-12" aria-hidden="true"></a>N170_Val<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(N170_Val<span class="op">$</span>Stim_Type)</span>
     <span id="cb8-13"><a href="#cb8-13" aria-hidden="true"></a>N170_Val<span class="op">$</span>Elect_site =<span class="st"> </span><span class="kw">factor</span>(N170_Val<span class="op">$</span>Elect_site)</span>
     <span id="cb8-14"><a href="#cb8-14" aria-hidden="true"></a></span>
     <span id="cb8-15"><a href="#cb8-15" aria-hidden="true"></a><span class="co"># Select primes</span></span>
     <span id="cb8-16"><a href="#cb8-16" aria-hidden="true"></a>N170_Val =<span class="st"> </span><span class="kw">subset</span>(N170_Val, Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
     <span id="cb8-17"><a href="#cb8-17" aria-hidden="true"></a></span>
     <span id="cb8-18"><a href="#cb8-18" aria-hidden="true"></a><span class="co"># Re-code values for emotion variable</span></span>
     <span id="cb8-19"><a href="#cb8-19" aria-hidden="true"></a>N170_Val<span class="op">$</span>Condition[N170_Val<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;happy&quot;</span></span>
     <span id="cb8-20"><a href="#cb8-20" aria-hidden="true"></a>N170_Val<span class="op">$</span>Condition[N170_Val<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;neutral&quot;</span></span>
     <span id="cb8-21"><a href="#cb8-21" aria-hidden="true"></a>N170_Val<span class="op">$</span>Condition[N170_Val<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] =<span class="st"> &quot;angry&quot;</span></span>
     <span id="cb8-22"><a href="#cb8-22" aria-hidden="true"></a></span>
     <span id="cb8-23"><a href="#cb8-23" aria-hidden="true"></a><span class="co"># Create factor, get neutral as baseline</span></span>
     <span id="cb8-24"><a href="#cb8-24" aria-hidden="true"></a>N170_Val<span class="op">$</span>Condition =<span class="st"> </span><span class="kw">factor</span>(N170_Val<span class="op">$</span>Condition)</span>
     <span id="cb8-25"><a href="#cb8-25" aria-hidden="true"></a></span>
     <span id="cb8-26"><a href="#cb8-26" aria-hidden="true"></a><span class="co"># Set treatment contrasts</span></span>
     <span id="cb8-27"><a href="#cb8-27" aria-hidden="true"></a><span class="kw">contrasts</span>(N170_Val<span class="op">$</span>Condition) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>, <span class="dt">base =</span> <span class="dv">3</span>)</span>
     <span id="cb8-28"><a href="#cb8-28" aria-hidden="true"></a></span>
     <span id="cb8-29"><a href="#cb8-29" aria-hidden="true"></a><span class="co"># A = angry, N = neutral, H = happy</span></span>
     <span id="cb8-30"><a href="#cb8-30" aria-hidden="true"></a>HvsA =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">-0.5</span>, <span class="dv">0</span>)</span>
     <span id="cb8-31"><a href="#cb8-31" aria-hidden="true"></a>EvsN =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">0</span>)</span>
     <span id="cb8-32"><a href="#cb8-32" aria-hidden="true"></a><span class="kw">contrasts</span>(N170_Val<span class="op">$</span>Condition) =<span class="st"> </span><span class="kw">cbind</span>(EvsN, HvsA)</span>
     <span id="cb8-33"><a href="#cb8-33" aria-hidden="true"></a></span>
     <span id="cb8-34"><a href="#cb8-34" aria-hidden="true"></a><span class="co"># Add contrast columns</span></span>
     <span id="cb8-35"><a href="#cb8-35" aria-hidden="true"></a>mm_N170_Val =<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span>Condition <span class="op">+</span><span class="st"> </span>Elect_site, N170_Val)</span>
     <span id="cb8-36"><a href="#cb8-36" aria-hidden="true"></a></span>
     <span id="cb8-37"><a href="#cb8-37" aria-hidden="true"></a><span class="co"># Attach to dataframe</span></span>
     <span id="cb8-38"><a href="#cb8-38" aria-hidden="true"></a>N170_Val[, (<span class="kw">ncol</span>(N170_Val) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(N170_Val) <span class="op">+</span><span class="st"> </span><span class="dv">4</span>)] =<span class="st"> </span>mm_N170_Val</span>
     <span id="cb8-39"><a href="#cb8-39" aria-hidden="true"></a><span class="kw">names</span>(N170_Val)[(<span class="kw">ncol</span>(N170_Val) <span class="op">-</span><span class="st"> </span><span class="dv">3</span>)<span class="op">:</span><span class="kw">ncol</span>(N170_Val)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;Emo_Neu&quot;</span>, <span class="st">&quot;Hap_Ang&quot;</span>, </span>
     <span id="cb8-40"><a href="#cb8-40" aria-hidden="true"></a>    <span class="st">&quot;Elect_site&quot;</span>)</span>
     <span id="cb8-41"><a href="#cb8-41" aria-hidden="true"></a></span>
     <span id="cb8-42"><a href="#cb8-42" aria-hidden="true"></a><span class="co"># Get model</span></span>
     <span id="cb8-43"><a href="#cb8-43" aria-hidden="true"></a>mod_N170_val.lmer1 =<span class="st"> </span><span class="kw">lmer</span>(N170_Amplitude <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Elect_site <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span></span>
     <span id="cb8-44"><a href="#cb8-44" aria-hidden="true"></a><span class="st">    </span>contr_F1_scal <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Elect_site <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span></span>
     <span id="cb8-45"><a href="#cb8-45" aria-hidden="true"></a><span class="st">    </span>Elect_site <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> N170_Val, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
     <span id="cb8-46"><a href="#cb8-46" aria-hidden="true"></a></span>
     <span id="cb8-47"><a href="#cb8-47" aria-hidden="true"></a><span class="co"># 1st: check how many zero variance terms you got in random effects</span></span>
     <span id="cb8-48"><a href="#cb8-48" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_N170_val.lmer1))</span>
     <span id="cb8-49"><a href="#cb8-49" aria-hidden="true"></a></span>
     <span id="cb8-50"><a href="#cb8-50" aria-hidden="true"></a><span class="co"># 2nd: check which random terms explain the least variance</span></span>
     <span id="cb8-51"><a href="#cb8-51" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_N170_val.lmer1), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
     <span id="cb8-52"><a href="#cb8-52" aria-hidden="true"></a></span>
     <span id="cb8-53"><a href="#cb8-53" aria-hidden="true"></a><span class="co"># Improved model</span></span>
     <span id="cb8-54"><a href="#cb8-54" aria-hidden="true"></a>mod_N170_val.lmer2 =<span class="st"> </span><span class="kw">lmer</span>(N170_Amplitude <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Elect_site <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span></span>
     <span id="cb8-55"><a href="#cb8-55" aria-hidden="true"></a><span class="st">    </span>contr_F1_scal <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Elect_site <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> N170_Val, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
     <span id="cb8-56"><a href="#cb8-56" aria-hidden="true"></a></span>
     <span id="cb8-57"><a href="#cb8-57" aria-hidden="true"></a><span class="co"># 1st: check how many zero variance terms you got in random effects</span></span>
     <span id="cb8-58"><a href="#cb8-58" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_N170_val.lmer2))</span>
     <span id="cb8-59"><a href="#cb8-59" aria-hidden="true"></a></span>
     <span id="cb8-60"><a href="#cb8-60" aria-hidden="true"></a><span class="co"># 2nd: check which random terms explain the least variance</span></span>
     <span id="cb8-61"><a href="#cb8-61" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_N170_val.lmer2), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
     <span id="cb8-62"><a href="#cb8-62" aria-hidden="true"></a></span>
     <span id="cb8-63"><a href="#cb8-63" aria-hidden="true"></a><span class="co"># Likelihood-testing</span></span>
     <span id="cb8-64"><a href="#cb8-64" aria-hidden="true"></a></span>
     <span id="cb8-65"><a href="#cb8-65" aria-hidden="true"></a>mod_N170_val.lmer3 =<span class="st"> </span><span class="kw">lmer</span>(N170_Amplitude <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Elect_site <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span></span>
     <span id="cb8-66"><a href="#cb8-66" aria-hidden="true"></a><span class="st">    </span>contr_F1_scal <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> N170_Val, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
     <span id="cb8-67"><a href="#cb8-67" aria-hidden="true"></a></span>
     <span id="cb8-68"><a href="#cb8-68" aria-hidden="true"></a></span>
     <span id="cb8-69"><a href="#cb8-69" aria-hidden="true"></a></span>
     <span id="cb8-70"><a href="#cb8-70" aria-hidden="true"></a>mod_N170_val.lmer4 =<span class="st"> </span><span class="kw">lmer</span>(N170_Amplitude <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Elect_site <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span></span>
     <span id="cb8-71"><a href="#cb8-71" aria-hidden="true"></a><span class="st">    </span>contr_F1_scal <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID), <span class="dt">data =</span> N170_Val, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
     <span id="cb8-72"><a href="#cb8-72" aria-hidden="true"></a></span>
     <span id="cb8-73"><a href="#cb8-73" aria-hidden="true"></a><span class="kw">anova</span>(mod_N170_val.lmer2, mod_N170_val.lmer3)</span>
     <span id="cb8-74"><a href="#cb8-74" aria-hidden="true"></a><span class="kw">anova</span>(mod_N170_val.lmer2, mod_N170_val.lmer4)</span>
     <span id="cb8-75"><a href="#cb8-75" aria-hidden="true"></a></span>
     <span id="cb8-76"><a href="#cb8-76" aria-hidden="true"></a></span>
     <span id="cb8-77"><a href="#cb8-77" aria-hidden="true"></a><span class="co"># Final model</span></span>
     <span id="cb8-78"><a href="#cb8-78" aria-hidden="true"></a>mod_N170_val.lmer2 =<span class="st"> </span><span class="kw">lmer</span>(N170_Amplitude <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Elect_site <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span></span>
     <span id="cb8-79"><a href="#cb8-79" aria-hidden="true"></a><span class="st">    </span>contr_F1_scal <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID), <span class="dt">data =</span> N170_Val, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span></code></pre></div>
     <p><br> The final model was comprised of:</p>
     <p><code>N170_Amplitude ~ Emo_Neu + Hap_Ang + Elect_site + WM_scal + contr_F1_scal + ,     (1 | ID)</code></p>
     <hr />
     </div>
     <div id="lmm_n170_val-normality-of-residuals" class="section level4">
     <h4>LMM_N170_val: Normality of residuals</h4>
     <div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="co">## Check properties of DV / residuals</span></span>
     <span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a>N170_Val<span class="op">$</span>Trans_N170 =<span class="st"> </span>N170_Val<span class="op">$</span>N170_Amplitude <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(N170_Val<span class="op">$</span>N170_Amplitude)</span>
     <span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a></span>
     <span id="cb9-4"><a href="#cb9-4" aria-hidden="true"></a><span class="co"># To make sure residuals follow ND: Calculate box-cox plot</span></span>
     <span id="cb9-5"><a href="#cb9-5" aria-hidden="true"></a><span class="kw">boxcox</span>(N170_Val<span class="op">$</span>Trans_N170 <span class="op">~</span><span class="st"> </span>N170_Val<span class="op">$</span>Condition)</span></code></pre></div>
     <p><img src="R_Script_3_ERP_measures_files/figure-html/N170_val_res_box-1.png" width="576" style="display: block; margin: auto;" /></p>
     <p>N170 amplitudes met the assumption of normally distributed residuals.</p>
     <div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a><span class="co"># Visualize normality assumption of residuals (without log transform)</span></span>
     <span id="cb10-2"><a href="#cb10-2" aria-hidden="true"></a>mod_N170_val =<span class="st"> </span><span class="kw">lm</span>(Trans_N170 <span class="op">~</span><span class="st"> </span>Condition, <span class="dt">data =</span> N170_Val)</span>
     <span id="cb10-3"><a href="#cb10-3" aria-hidden="true"></a>res.mod_N170_val =<span class="st"> </span><span class="kw">residuals</span>(mod_N170_val)</span>
     <span id="cb10-4"><a href="#cb10-4" aria-hidden="true"></a></span>
     <span id="cb10-5"><a href="#cb10-5" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
     <span id="cb10-6"><a href="#cb10-6" aria-hidden="true"></a>qqpl_mod_N170_val =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_N170_val, <span class="dt">main =</span> <span class="st">&quot;QQplot before transformation&quot;</span>)</span>
     <span id="cb10-7"><a href="#cb10-7" aria-hidden="true"></a>norm_mod_N170_val =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_N170_val), <span class="dt">main =</span> <span class="st">&quot;Density plot before transformation&quot;</span>)</span></code></pre></div>
     <p><img src="R_Script_3_ERP_measures_files/figure-html/N170_val_res_plot-1.png" width="576" style="display: block; margin: auto;" /></p>
     <div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
     <hr />
     </div>
     <div id="lmm_n170_val-homoscedasticity" class="section level4">
     <h4>LMM_N170_val: Homoscedasticity</h4>
     <div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="co"># Check homoscedasticity</span></span>
     <span id="cb12-2"><a href="#cb12-2" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">fitted</span>(mod_N170_val.lmer2), <span class="kw">residuals</span>(mod_N170_val.lmer2))</span>
     <span id="cb12-3"><a href="#cb12-3" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span></code></pre></div>
     <p><img src="R_Script_3_ERP_measures_files/figure-html/N170_val_homosk-1.png" width="576" style="display: block; margin: auto;" /></p>
     <p>Based on visual inspection, we assumed homoscedasticity.</p>
     <hr />
     </div>
     <div id="lmm_p3_val-random-effect-structure" class="section level4">
     <h4>LMM_P3_val: Random effect structure</h4>
     <div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a><span class="co"># Select primes</span></span>
     <span id="cb13-2"><a href="#cb13-2" aria-hidden="true"></a>P3_Val =<span class="st"> </span><span class="kw">subset</span>(ERP_data, Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
     <span id="cb13-3"><a href="#cb13-3" aria-hidden="true"></a></span>
     <span id="cb13-4"><a href="#cb13-4" aria-hidden="true"></a><span class="co"># Prepare fixed factors</span></span>
     <span id="cb13-5"><a href="#cb13-5" aria-hidden="true"></a>P3_Val<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(P3_Val<span class="op">$</span>ID)</span>
     <span id="cb13-6"><a href="#cb13-6" aria-hidden="true"></a>P3_Val<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(P3_Val<span class="op">$</span>Stim_Type)</span>
     <span id="cb13-7"><a href="#cb13-7" aria-hidden="true"></a></span>
     <span id="cb13-8"><a href="#cb13-8" aria-hidden="true"></a><span class="co"># Re-Name values of emotion condition</span></span>
     <span id="cb13-9"><a href="#cb13-9" aria-hidden="true"></a>P3_Val<span class="op">$</span>Condition[P3_Val<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;happy&quot;</span></span>
     <span id="cb13-10"><a href="#cb13-10" aria-hidden="true"></a>P3_Val<span class="op">$</span>Condition[P3_Val<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;neutral&quot;</span></span>
     <span id="cb13-11"><a href="#cb13-11" aria-hidden="true"></a>P3_Val<span class="op">$</span>Condition[P3_Val<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] =<span class="st"> &quot;angry&quot;</span></span>
     <span id="cb13-12"><a href="#cb13-12" aria-hidden="true"></a></span>
     <span id="cb13-13"><a href="#cb13-13" aria-hidden="true"></a><span class="co"># Create factor &amp; set neutral as baseline</span></span>
     <span id="cb13-14"><a href="#cb13-14" aria-hidden="true"></a>P3_Val<span class="op">$</span>Condition =<span class="st"> </span><span class="kw">factor</span>(P3_Val<span class="op">$</span>Condition)</span>
     <span id="cb13-15"><a href="#cb13-15" aria-hidden="true"></a></span>
     <span id="cb13-16"><a href="#cb13-16" aria-hidden="true"></a><span class="kw">contrasts</span>(P3_Val<span class="op">$</span>Condition) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>, <span class="dt">base =</span> <span class="dv">3</span>)</span>
     <span id="cb13-17"><a href="#cb13-17" aria-hidden="true"></a></span>
     <span id="cb13-18"><a href="#cb13-18" aria-hidden="true"></a><span class="co"># A = angry, N = neutral, H = happy</span></span>
     <span id="cb13-19"><a href="#cb13-19" aria-hidden="true"></a>HvsA =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">-0.5</span>, <span class="dv">0</span>)</span>
     <span id="cb13-20"><a href="#cb13-20" aria-hidden="true"></a>EvsN =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">0</span>)</span>
     <span id="cb13-21"><a href="#cb13-21" aria-hidden="true"></a><span class="kw">contrasts</span>(P3_Val<span class="op">$</span>Condition) =<span class="st"> </span><span class="kw">cbind</span>(EvsN, HvsA)</span>
     <span id="cb13-22"><a href="#cb13-22" aria-hidden="true"></a></span>
     <span id="cb13-23"><a href="#cb13-23" aria-hidden="true"></a><span class="co"># Add contrast columns</span></span>
     <span id="cb13-24"><a href="#cb13-24" aria-hidden="true"></a>mm_P3_Val =<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span>Condition, P3_Val)</span>
     <span id="cb13-25"><a href="#cb13-25" aria-hidden="true"></a></span>
     <span id="cb13-26"><a href="#cb13-26" aria-hidden="true"></a><span class="co"># Attach to dataframe</span></span>
     <span id="cb13-27"><a href="#cb13-27" aria-hidden="true"></a>P3_Val[, (<span class="kw">ncol</span>(P3_Val) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(P3_Val) <span class="op">+</span><span class="st"> </span><span class="dv">3</span>)] =<span class="st"> </span>mm_P3_Val</span>
     <span id="cb13-28"><a href="#cb13-28" aria-hidden="true"></a><span class="kw">names</span>(P3_Val)[(<span class="kw">ncol</span>(P3_Val) <span class="op">-</span><span class="st"> </span><span class="dv">2</span>)<span class="op">:</span><span class="kw">ncol</span>(P3_Val)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;Hap_Ang&quot;</span>, <span class="st">&quot;Emo_Neu&quot;</span>)</span>
     <span id="cb13-29"><a href="#cb13-29" aria-hidden="true"></a></span>
     <span id="cb13-30"><a href="#cb13-30" aria-hidden="true"></a><span class="co"># Build model</span></span>
     <span id="cb13-31"><a href="#cb13-31" aria-hidden="true"></a>mod_P3_val.lmer1 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P3 <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>contr_F1_scal <span class="op">+</span><span class="st"> </span></span>
     <span id="cb13-32"><a href="#cb13-32" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> P3_Val, </span>
     <span id="cb13-33"><a href="#cb13-33" aria-hidden="true"></a>    <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
     <span id="cb13-34"><a href="#cb13-34" aria-hidden="true"></a></span>
     <span id="cb13-35"><a href="#cb13-35" aria-hidden="true"></a><span class="co"># 1st: check how many zero variance terms you got in random effects</span></span>
     <span id="cb13-36"><a href="#cb13-36" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_P3_val.lmer1))</span>
     <span id="cb13-37"><a href="#cb13-37" aria-hidden="true"></a></span>
     <span id="cb13-38"><a href="#cb13-38" aria-hidden="true"></a><span class="co"># 2nd: check which random terms explain the least variance</span></span>
     <span id="cb13-39"><a href="#cb13-39" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_P3_val.lmer1), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
     <span id="cb13-40"><a href="#cb13-40" aria-hidden="true"></a></span>
     <span id="cb13-41"><a href="#cb13-41" aria-hidden="true"></a><span class="co"># Improved model</span></span>
     <span id="cb13-42"><a href="#cb13-42" aria-hidden="true"></a>mod_P3_val.lmer2 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P3 <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>contr_F1_scal <span class="op">+</span><span class="st"> </span></span>
     <span id="cb13-43"><a href="#cb13-43" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> P3_Val, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
     <span id="cb13-44"><a href="#cb13-44" aria-hidden="true"></a></span>
     <span id="cb13-45"><a href="#cb13-45" aria-hidden="true"></a><span class="co"># Re-check the model</span></span>
     <span id="cb13-46"><a href="#cb13-46" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_P3_val.lmer2))</span>
     <span id="cb13-47"><a href="#cb13-47" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_P3_val.lmer2), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
     <span id="cb13-48"><a href="#cb13-48" aria-hidden="true"></a></span>
     <span id="cb13-49"><a href="#cb13-49" aria-hidden="true"></a></span>
     <span id="cb13-50"><a href="#cb13-50" aria-hidden="true"></a><span class="co"># Likelihood ratio testing</span></span>
     <span id="cb13-51"><a href="#cb13-51" aria-hidden="true"></a></span>
     <span id="cb13-52"><a href="#cb13-52" aria-hidden="true"></a><span class="co"># Stimulus type</span></span>
     <span id="cb13-53"><a href="#cb13-53" aria-hidden="true"></a>mod_P3_val.lmer3 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P3 <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>contr_F1_scal <span class="op">+</span><span class="st"> </span></span>
     <span id="cb13-54"><a href="#cb13-54" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> P3_Val, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
     <span id="cb13-55"><a href="#cb13-55" aria-hidden="true"></a></span>
     <span id="cb13-56"><a href="#cb13-56" aria-hidden="true"></a><span class="co"># Calculate ANOVA</span></span>
     <span id="cb13-57"><a href="#cb13-57" aria-hidden="true"></a><span class="kw">anova</span>(mod_P3_val.lmer2, mod_P3_val.lmer3)</span>
     <span id="cb13-58"><a href="#cb13-58" aria-hidden="true"></a></span>
     <span id="cb13-59"><a href="#cb13-59" aria-hidden="true"></a></span>
     <span id="cb13-60"><a href="#cb13-60" aria-hidden="true"></a><span class="co"># Final model</span></span>
     <span id="cb13-61"><a href="#cb13-61" aria-hidden="true"></a>mod_P3_val.lmer4 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P3 <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>contr_F1_scal <span class="op">+</span><span class="st"> </span></span>
     <span id="cb13-62"><a href="#cb13-62" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> P3_Val, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span></code></pre></div>
     <p><br></p>
     <p>The final model was comprised of:</p>
     <p><code>mean_ROI_P3 ~ Emo_Neu + Hap_Ang + WM_scal + contr_F1_scal + (1 | ,     ID) + (1 | Stim_Type)</code></p>
     <hr />
     </div>
     <div id="lmm_p3_val-normality-of-residuals" class="section level4">
     <h4>LMM_P3_val: Normality of residuals</h4>
     <div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a><span class="co">## Check properties of DV / residuals</span></span>
     <span id="cb14-2"><a href="#cb14-2" aria-hidden="true"></a>P3_Val<span class="op">$</span>Trans_P3 =<span class="st"> </span>P3_Val<span class="op">$</span>mean_ROI_P3 <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(P3_Val<span class="op">$</span>mean_ROI_P3)</span>
     <span id="cb14-3"><a href="#cb14-3" aria-hidden="true"></a></span>
     <span id="cb14-4"><a href="#cb14-4" aria-hidden="true"></a><span class="co"># To make sure residuals follow ND: Calculate box-cox plot</span></span>
     <span id="cb14-5"><a href="#cb14-5" aria-hidden="true"></a><span class="kw">boxcox</span>(P3_Val<span class="op">$</span>Trans_P3 <span class="op">~</span><span class="st"> </span>P3_Val<span class="op">$</span>Condition)</span></code></pre></div>
     <p><img src="R_Script_3_ERP_measures_files/figure-html/P3_val_res_box-1.png" width="576" style="display: block; margin: auto;" /></p>
     <p>P3 amplitudes met the assumption of normally distributed residuals.</p>
     <div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a><span class="co"># Visualize normality assumption of residuals (without log transform)</span></span>
     <span id="cb15-2"><a href="#cb15-2" aria-hidden="true"></a>mod_P3_val =<span class="st"> </span><span class="kw">lm</span>(Trans_P3 <span class="op">~</span><span class="st"> </span>Condition, <span class="dt">data =</span> P3_Val)</span>
     <span id="cb15-3"><a href="#cb15-3" aria-hidden="true"></a>res.mod_P3_val =<span class="st"> </span><span class="kw">residuals</span>(mod_P3_val)</span>
     <span id="cb15-4"><a href="#cb15-4" aria-hidden="true"></a></span>
     <span id="cb15-5"><a href="#cb15-5" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
     <span id="cb15-6"><a href="#cb15-6" aria-hidden="true"></a>qqpl_mod_P3_val =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_P3_val, <span class="dt">main =</span> <span class="st">&quot;QQplot before transformation&quot;</span>)</span>
     <span id="cb15-7"><a href="#cb15-7" aria-hidden="true"></a>norm_mod_P3_val =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_P3_val), <span class="dt">main =</span> <span class="st">&quot;Density plot before transformation&quot;</span>)</span></code></pre></div>
     <p><img src="R_Script_3_ERP_measures_files/figure-html/P3_val_res_plot-1.png" width="576" style="display: block; margin: auto;" /></p>
     <div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
     <hr />
     </div>
     <div id="lmm_p3_val-homoscedasticity" class="section level4">
     <h4>LMM_P3_val: Homoscedasticity</h4>
     <div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true"></a><span class="co"># Check homoscedasticity</span></span>
     <span id="cb17-2"><a href="#cb17-2" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">fitted</span>(mod_P3_val.lmer4), <span class="kw">residuals</span>(mod_P3_val.lmer4))</span>
     <span id="cb17-3"><a href="#cb17-3" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span></code></pre></div>
     <p><img src="R_Script_3_ERP_measures_files/figure-html/P3_val_homosk-1.png" width="576" style="display: block; margin: auto;" /></p>
     <p>Based on visual inspection, we assumed homoscedasticity.</p>
     <hr />
     </div>
     <div id="lmm_p1_rep-random-effect-structure" class="section level4">
     <h4>LMM_P1_rep: Random effect structure</h4>
     <p><br></p>
     <p>The final model was comprised of:</p>
     <div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true"></a><span class="co"># Select correct responses and outlier-free data</span></span>
     <span id="cb18-2"><a href="#cb18-2" aria-hidden="true"></a>P1_Cat =<span class="st"> </span><span class="kw">subset</span>(ERP_data, Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
     <span id="cb18-3"><a href="#cb18-3" aria-hidden="true"></a>P1_Cat =<span class="st"> </span><span class="kw">subset</span>(P1_Cat, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_larger_7s <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span></span>
     <span id="cb18-4"><a href="#cb18-4" aria-hidden="true"></a><span class="st">    </span>Exclude_MAD <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>)</span>
     <span id="cb18-5"><a href="#cb18-5" aria-hidden="true"></a></span>
     <span id="cb18-6"><a href="#cb18-6" aria-hidden="true"></a><span class="co"># Select targets</span></span>
     <span id="cb18-7"><a href="#cb18-7" aria-hidden="true"></a>P1_Cat =<span class="st"> </span><span class="kw">subset</span>(P1_Cat, Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">2</span>)</span>
     <span id="cb18-8"><a href="#cb18-8" aria-hidden="true"></a></span>
     <span id="cb18-9"><a href="#cb18-9" aria-hidden="true"></a><span class="co"># Prepare fixed factors</span></span>
     <span id="cb18-10"><a href="#cb18-10" aria-hidden="true"></a>P1_Cat<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(P1_Cat<span class="op">$</span>ID)</span>
     <span id="cb18-11"><a href="#cb18-11" aria-hidden="true"></a>P1_Cat<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(P1_Cat<span class="op">$</span>Stim_Type)</span>
     <span id="cb18-12"><a href="#cb18-12" aria-hidden="true"></a></span>
     <span id="cb18-13"><a href="#cb18-13" aria-hidden="true"></a><span class="co"># Define novel vs repeated trials</span></span>
     <span id="cb18-14"><a href="#cb18-14" aria-hidden="true"></a>P1_Cat<span class="op">$</span>Condition[P1_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">4</span>] =<span class="st"> &quot;c_happy&quot;</span></span>
     <span id="cb18-15"><a href="#cb18-15" aria-hidden="true"></a>P1_Cat<span class="op">$</span>Condition[P1_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">5</span>] =<span class="st"> &quot;c_neutral&quot;</span></span>
     <span id="cb18-16"><a href="#cb18-16" aria-hidden="true"></a>P1_Cat<span class="op">$</span>Condition[P1_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">6</span>] =<span class="st"> &quot;c_angry&quot;</span></span>
     <span id="cb18-17"><a href="#cb18-17" aria-hidden="true"></a>P1_Cat<span class="op">$</span>Condition[P1_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">7</span>] =<span class="st"> &quot;ic_happy&quot;</span></span>
     <span id="cb18-18"><a href="#cb18-18" aria-hidden="true"></a>P1_Cat<span class="op">$</span>Condition[P1_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">8</span>] =<span class="st"> &quot;ic_neutral&quot;</span></span>
     <span id="cb18-19"><a href="#cb18-19" aria-hidden="true"></a>P1_Cat<span class="op">$</span>Condition[P1_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">9</span>] =<span class="st"> &quot;ic_angry&quot;</span></span>
     <span id="cb18-20"><a href="#cb18-20" aria-hidden="true"></a></span>
     <span id="cb18-21"><a href="#cb18-21" aria-hidden="true"></a><span class="co"># Create one variable for emotion and one for repetition</span></span>
     <span id="cb18-22"><a href="#cb18-22" aria-hidden="true"></a>P1_Cat<span class="op">$</span>emot[(P1_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;c_happy&quot;</span>) <span class="op">|</span><span class="st"> </span>(P1_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;ic_happy&quot;</span>)] =<span class="st"> </span><span class="dv">1</span></span>
     <span id="cb18-23"><a href="#cb18-23" aria-hidden="true"></a>P1_Cat<span class="op">$</span>emot[(P1_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;c_angry&quot;</span>) <span class="op">|</span><span class="st"> </span>(P1_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;ic_angry&quot;</span>)] =<span class="st"> </span><span class="dv">2</span></span>
     <span id="cb18-24"><a href="#cb18-24" aria-hidden="true"></a>P1_Cat<span class="op">$</span>emot[(P1_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;c_neutral&quot;</span>) <span class="op">|</span><span class="st"> </span>(P1_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;ic_neutral&quot;</span>)] =<span class="st"> </span><span class="dv">3</span></span>
     <span id="cb18-25"><a href="#cb18-25" aria-hidden="true"></a></span>
     <span id="cb18-26"><a href="#cb18-26" aria-hidden="true"></a>P1_Cat<span class="op">$</span>rep[(P1_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;c_happy&quot;</span>) <span class="op">|</span><span class="st"> </span>(P1_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;c_angry&quot;</span>) <span class="op">|</span><span class="st"> </span>(P1_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span></span>
     <span id="cb18-27"><a href="#cb18-27" aria-hidden="true"></a><span class="st">    &quot;c_neutral&quot;</span>)] =<span class="st"> </span><span class="dv">1</span></span>
     <span id="cb18-28"><a href="#cb18-28" aria-hidden="true"></a>P1_Cat<span class="op">$</span>rep[(P1_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;ic_happy&quot;</span>) <span class="op">|</span><span class="st"> </span>(P1_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;ic_angry&quot;</span>) <span class="op">|</span><span class="st"> </span></span>
     <span id="cb18-29"><a href="#cb18-29" aria-hidden="true"></a><span class="st">    </span>(P1_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;ic_neutral&quot;</span>)] =<span class="st"> </span><span class="dv">2</span></span>
     <span id="cb18-30"><a href="#cb18-30" aria-hidden="true"></a></span>
     <span id="cb18-31"><a href="#cb18-31" aria-hidden="true"></a><span class="co"># Rename variables</span></span>
     <span id="cb18-32"><a href="#cb18-32" aria-hidden="true"></a>P1_Cat<span class="op">$</span>emot[P1_Cat<span class="op">$</span>emot <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;happy&quot;</span></span>
     <span id="cb18-33"><a href="#cb18-33" aria-hidden="true"></a>P1_Cat<span class="op">$</span>emot[P1_Cat<span class="op">$</span>emot <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;angry&quot;</span></span>
     <span id="cb18-34"><a href="#cb18-34" aria-hidden="true"></a>P1_Cat<span class="op">$</span>emot[P1_Cat<span class="op">$</span>emot <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] =<span class="st"> &quot;neutral&quot;</span></span>
     <span id="cb18-35"><a href="#cb18-35" aria-hidden="true"></a></span>
     <span id="cb18-36"><a href="#cb18-36" aria-hidden="true"></a><span class="co"># Rename variables</span></span>
     <span id="cb18-37"><a href="#cb18-37" aria-hidden="true"></a>P1_Cat<span class="op">$</span>rep[P1_Cat<span class="op">$</span>rep <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;repeated&quot;</span></span>
     <span id="cb18-38"><a href="#cb18-38" aria-hidden="true"></a>P1_Cat<span class="op">$</span>rep[P1_Cat<span class="op">$</span>rep <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;novel&quot;</span></span>
     <span id="cb18-39"><a href="#cb18-39" aria-hidden="true"></a></span>
     <span id="cb18-40"><a href="#cb18-40" aria-hidden="true"></a><span class="co"># Factor and create contrasts</span></span>
     <span id="cb18-41"><a href="#cb18-41" aria-hidden="true"></a>P1_Cat<span class="op">$</span>rep =<span class="st"> </span><span class="kw">factor</span>(P1_Cat<span class="op">$</span>rep)</span>
     <span id="cb18-42"><a href="#cb18-42" aria-hidden="true"></a>P1_Cat<span class="op">$</span>emot =<span class="st"> </span><span class="kw">factor</span>(P1_Cat<span class="op">$</span>emot)</span>
     <span id="cb18-43"><a href="#cb18-43" aria-hidden="true"></a></span>
     <span id="cb18-44"><a href="#cb18-44" aria-hidden="true"></a><span class="kw">contrasts</span>(P1_Cat<span class="op">$</span>rep) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>, <span class="dt">base =</span> <span class="dv">1</span>)</span>
     <span id="cb18-45"><a href="#cb18-45" aria-hidden="true"></a><span class="kw">contrasts</span>(P1_Cat<span class="op">$</span>emot) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>, <span class="dt">base =</span> <span class="dv">3</span>)</span>
     <span id="cb18-46"><a href="#cb18-46" aria-hidden="true"></a></span>
     <span id="cb18-47"><a href="#cb18-47" aria-hidden="true"></a><span class="co"># A = angry, N = neutral, H = happy</span></span>
     <span id="cb18-48"><a href="#cb18-48" aria-hidden="true"></a>HvsA =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">-0.5</span>, <span class="dv">0</span>)</span>
     <span id="cb18-49"><a href="#cb18-49" aria-hidden="true"></a>EvsN =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">0</span>)</span>
     <span id="cb18-50"><a href="#cb18-50" aria-hidden="true"></a><span class="kw">contrasts</span>(P1_Cat<span class="op">$</span>emot) =<span class="st"> </span><span class="kw">cbind</span>(EvsN, HvsA)</span>
     <span id="cb18-51"><a href="#cb18-51" aria-hidden="true"></a></span>
     <span id="cb18-52"><a href="#cb18-52" aria-hidden="true"></a><span class="co"># Add contrast columns</span></span>
     <span id="cb18-53"><a href="#cb18-53" aria-hidden="true"></a>mm_P1_Cat =<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span>emot <span class="op">*</span><span class="st"> </span>rep, P1_Cat)</span>
     <span id="cb18-54"><a href="#cb18-54" aria-hidden="true"></a></span>
     <span id="cb18-55"><a href="#cb18-55" aria-hidden="true"></a><span class="co"># Attach to dataframe</span></span>
     <span id="cb18-56"><a href="#cb18-56" aria-hidden="true"></a>P1_Cat[, (<span class="kw">ncol</span>(P1_Cat) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(P1_Cat) <span class="op">+</span><span class="st"> </span><span class="dv">6</span>)] =<span class="st"> </span>mm_P1_Cat</span>
     <span id="cb18-57"><a href="#cb18-57" aria-hidden="true"></a><span class="kw">names</span>(P1_Cat)[(<span class="kw">ncol</span>(P1_Cat) <span class="op">-</span><span class="st"> </span><span class="dv">5</span>)<span class="op">:</span><span class="kw">ncol</span>(P1_Cat)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;Emo_Neu&quot;</span>, <span class="st">&quot;Hap_Ang&quot;</span>, </span>
     <span id="cb18-58"><a href="#cb18-58" aria-hidden="true"></a>    <span class="st">&quot;Rep_Nov&quot;</span>, <span class="st">&quot;Emo_NeuxRep_Nov&quot;</span>, <span class="st">&quot;Hap_AngxRep_Nov&quot;</span>)</span>
     <span id="cb18-59"><a href="#cb18-59" aria-hidden="true"></a></span>
     <span id="cb18-60"><a href="#cb18-60" aria-hidden="true"></a><span class="co"># Build full model</span></span>
     <span id="cb18-61"><a href="#cb18-61" aria-hidden="true"></a>mod_P1_cat.lmer1 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P1 <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Rep_Nov <span class="op">+</span><span class="st"> </span>Emo_NeuxRep_Nov <span class="op">+</span><span class="st"> </span></span>
     <span id="cb18-62"><a href="#cb18-62" aria-hidden="true"></a><span class="st">    </span>Hap_AngxRep_Nov <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Rep_Nov <span class="op">+</span><span class="st"> </span></span>
     <span id="cb18-63"><a href="#cb18-63" aria-hidden="true"></a><span class="st">    </span>Emo_NeuxRep_Nov <span class="op">+</span><span class="st"> </span>Hap_AngxRep_Nov <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Rep_Nov <span class="op">+</span><span class="st"> </span></span>
     <span id="cb18-64"><a href="#cb18-64" aria-hidden="true"></a><span class="st">    </span>Emo_NeuxRep_Nov <span class="op">+</span><span class="st"> </span>Hap_AngxRep_Nov <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> P1_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
     <span id="cb18-65"><a href="#cb18-65" aria-hidden="true"></a></span>
     <span id="cb18-66"><a href="#cb18-66" aria-hidden="true"></a><span class="co"># 1st: check how many zero variance terms you got in random effects</span></span>
     <span id="cb18-67"><a href="#cb18-67" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_P1_cat.lmer1))</span>
     <span id="cb18-68"><a href="#cb18-68" aria-hidden="true"></a></span>
     <span id="cb18-69"><a href="#cb18-69" aria-hidden="true"></a><span class="co"># 2nd: check which random terms explain the least variance</span></span>
     <span id="cb18-70"><a href="#cb18-70" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_P1_cat.lmer1), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
     <span id="cb18-71"><a href="#cb18-71" aria-hidden="true"></a></span>
     <span id="cb18-72"><a href="#cb18-72" aria-hidden="true"></a>mod_P1_cat.lmer2 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P1 <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Rep_Nov <span class="op">+</span><span class="st"> </span>Emo_NeuxRep_Nov <span class="op">+</span><span class="st"> </span></span>
     <span id="cb18-73"><a href="#cb18-73" aria-hidden="true"></a><span class="st">    </span>Hap_AngxRep_Nov <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Rep_Nov <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span></span>
     <span id="cb18-74"><a href="#cb18-74" aria-hidden="true"></a><span class="st">    </span>Rep_Nov <span class="op">+</span><span class="st"> </span>Emo_NeuxRep_Nov <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> P1_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
     <span id="cb18-75"><a href="#cb18-75" aria-hidden="true"></a></span>
     <span id="cb18-76"><a href="#cb18-76" aria-hidden="true"></a><span class="co">## Likelihood-ratio testing</span></span>
     <span id="cb18-77"><a href="#cb18-77" aria-hidden="true"></a></span>
     <span id="cb18-78"><a href="#cb18-78" aria-hidden="true"></a><span class="co"># ID</span></span>
     <span id="cb18-79"><a href="#cb18-79" aria-hidden="true"></a>mod_P1_cat.lmer3 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P1 <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Rep_Nov <span class="op">+</span><span class="st"> </span>Emo_NeuxRep_Nov <span class="op">+</span><span class="st"> </span></span>
     <span id="cb18-80"><a href="#cb18-80" aria-hidden="true"></a><span class="st">    </span>Hap_AngxRep_Nov <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Rep_Nov <span class="op">+</span><span class="st"> </span>Emo_NeuxRep_Nov <span class="op">||</span><span class="st"> </span></span>
     <span id="cb18-81"><a href="#cb18-81" aria-hidden="true"></a><span class="st">    </span>Stim_Type), <span class="dt">data =</span> P1_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
     <span id="cb18-82"><a href="#cb18-82" aria-hidden="true"></a></span>
     <span id="cb18-83"><a href="#cb18-83" aria-hidden="true"></a><span class="co"># Stim_Type</span></span>
     <span id="cb18-84"><a href="#cb18-84" aria-hidden="true"></a>mod_P1_cat.lmer4 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P1 <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Rep_Nov <span class="op">+</span><span class="st"> </span>Emo_NeuxRep_Nov <span class="op">+</span><span class="st"> </span></span>
     <span id="cb18-85"><a href="#cb18-85" aria-hidden="true"></a><span class="st">    </span>Hap_AngxRep_Nov <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Rep_Nov <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span></span>
     <span id="cb18-86"><a href="#cb18-86" aria-hidden="true"></a><span class="st">    </span>Stim_Type), <span class="dt">data =</span> P1_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
     <span id="cb18-87"><a href="#cb18-87" aria-hidden="true"></a></span>
     <span id="cb18-88"><a href="#cb18-88" aria-hidden="true"></a><span class="co"># Calculate ANOVA</span></span>
     <span id="cb18-89"><a href="#cb18-89" aria-hidden="true"></a><span class="kw">anova</span>(mod_P1_cat.lmer2, mod_P1_cat.lmer3)</span>
     <span id="cb18-90"><a href="#cb18-90" aria-hidden="true"></a><span class="kw">anova</span>(mod_P1_cat.lmer2, mod_P1_cat.lmer4)</span>
     <span id="cb18-91"><a href="#cb18-91" aria-hidden="true"></a></span>
     <span id="cb18-92"><a href="#cb18-92" aria-hidden="true"></a></span>
     <span id="cb18-93"><a href="#cb18-93" aria-hidden="true"></a><span class="co"># Without Stim_Type</span></span>
     <span id="cb18-94"><a href="#cb18-94" aria-hidden="true"></a>mod_P1_cat.lmer5 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P1 <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Rep_Nov <span class="op">+</span><span class="st"> </span>Emo_NeuxRep_Nov <span class="op">+</span><span class="st"> </span></span>
     <span id="cb18-95"><a href="#cb18-95" aria-hidden="true"></a><span class="st">    </span>Hap_AngxRep_Nov <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID), <span class="dt">data =</span> P1_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
     <span id="cb18-96"><a href="#cb18-96" aria-hidden="true"></a></span>
     <span id="cb18-97"><a href="#cb18-97" aria-hidden="true"></a><span class="co"># Calculate ANOVA</span></span>
     <span id="cb18-98"><a href="#cb18-98" aria-hidden="true"></a><span class="kw">anova</span>(mod_P1_cat.lmer2, mod_P1_cat.lmer5)</span>
     <span id="cb18-99"><a href="#cb18-99" aria-hidden="true"></a></span>
     <span id="cb18-100"><a href="#cb18-100" aria-hidden="true"></a><span class="co"># Final model</span></span>
     <span id="cb18-101"><a href="#cb18-101" aria-hidden="true"></a>mod_P1_cat.lmer4 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P1 <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Rep_Nov <span class="op">+</span><span class="st"> </span>Emo_NeuxRep_Nov <span class="op">+</span><span class="st"> </span></span>
     <span id="cb18-102"><a href="#cb18-102" aria-hidden="true"></a><span class="st">    </span>Hap_AngxRep_Nov <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID), <span class="dt">data =</span> P1_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span></code></pre></div>
     <p><code>mean_ROI_P1 ~ Emo_Neu + Hap_Ang + Rep_Nov + Emo_NeuxRep_Nov + ,     Hap_AngxRep_Nov + WM_scal + contr_F2_scal + (1 | ID)</code></p>
     <hr />
     </div>
     <div id="lmm_p1_rep-normality-of-residuals" class="section level4">
     <h4>LMM_P1_rep: Normality of residuals</h4>
     <div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true"></a><span class="co">## Check properties of DV / residuals</span></span>
     <span id="cb19-2"><a href="#cb19-2" aria-hidden="true"></a>P1_Cat<span class="op">$</span>Trans_P1 =<span class="st"> </span>P1_Cat<span class="op">$</span>mean_ROI_P1 <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(P1_Cat<span class="op">$</span>mean_ROI_P1)</span>
     <span id="cb19-3"><a href="#cb19-3" aria-hidden="true"></a></span>
     <span id="cb19-4"><a href="#cb19-4" aria-hidden="true"></a><span class="co"># To make sure residuals follow ND: Calculate box-cox plot</span></span>
     <span id="cb19-5"><a href="#cb19-5" aria-hidden="true"></a><span class="kw">boxcox</span>(P1_Cat<span class="op">$</span>Trans_P1 <span class="op">~</span><span class="st"> </span>P1_Cat<span class="op">$</span>Group_pcic)</span></code></pre></div>
     <p><img src="R_Script_3_ERP_measures_files/figure-html/P1_cat_res_box-1.png" width="576" style="display: block; margin: auto;" /></p>
     <p>P1 amplitudes met the assumption of normally distributed residuals.</p>
     <div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true"></a><span class="co"># Visualize normality assumption of residuals (without log transform)</span></span>
     <span id="cb20-2"><a href="#cb20-2" aria-hidden="true"></a>mod_P1_Cat =<span class="st"> </span><span class="kw">lm</span>(Trans_P1 <span class="op">~</span><span class="st"> </span>Group_pcic, <span class="dt">data =</span> P1_Cat)</span>
     <span id="cb20-3"><a href="#cb20-3" aria-hidden="true"></a>res.mod_P1_Cat =<span class="st"> </span><span class="kw">residuals</span>(mod_P1_Cat)</span>
     <span id="cb20-4"><a href="#cb20-4" aria-hidden="true"></a></span>
     <span id="cb20-5"><a href="#cb20-5" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
     <span id="cb20-6"><a href="#cb20-6" aria-hidden="true"></a>qqpl_mod_P1_Cat =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_P1_Cat, <span class="dt">main =</span> <span class="st">&quot;QQplot before transformation&quot;</span>)</span>
     <span id="cb20-7"><a href="#cb20-7" aria-hidden="true"></a>norm_mod_P1_Cat =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_P1_Cat), <span class="dt">main =</span> <span class="st">&quot;Density plot before transformation&quot;</span>)</span></code></pre></div>
     <p><img src="R_Script_3_ERP_measures_files/figure-html/P1_cat_res_plot-1.png" width="576" style="display: block; margin: auto;" /></p>
     <div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
     <hr />
     </div>
     <div id="lmm_p1_rep-homoscedasticity" class="section level4">
     <h4>LMM_P1_rep: Homoscedasticity</h4>
     <p>Based on visual inspection, we assumed homoscedasticity.</p>
     <div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true"></a><span class="co"># Check homoscedasticity</span></span>
     <span id="cb22-2"><a href="#cb22-2" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">fitted</span>(mod_P1_cat.lmer4), <span class="kw">residuals</span>(mod_P1_cat.lmer4))</span>
     <span id="cb22-3"><a href="#cb22-3" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span></code></pre></div>
     <p><img src="R_Script_3_ERP_measures_files/figure-html/P1_cat_homosk-1.png" width="576" style="display: block; margin: auto;" /></p>
     <hr />
     </div>
     <div id="lmm_n170_rep-random-effect-structure" class="section level4">
     <h4>LMM_N170_rep: Random effect structure</h4>
     <p><br></p>
     <p>The final model was comprised of:</p>
     <div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true"></a><span class="co"># Select targets</span></span>
     <span id="cb23-2"><a href="#cb23-2" aria-hidden="true"></a>N170_Cat =<span class="st"> </span><span class="kw">subset</span>(ERP_data, Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">2</span>)</span>
     <span id="cb23-3"><a href="#cb23-3" aria-hidden="true"></a></span>
     <span id="cb23-4"><a href="#cb23-4" aria-hidden="true"></a><span class="co"># Select correct responses and outlier-free data</span></span>
     <span id="cb23-5"><a href="#cb23-5" aria-hidden="true"></a>N170_Cat =<span class="st"> </span><span class="kw">subset</span>(N170_Cat, Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
     <span id="cb23-6"><a href="#cb23-6" aria-hidden="true"></a>N170_Cat =<span class="st"> </span><span class="kw">subset</span>(N170_Cat, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_larger_7s <span class="op">==</span><span class="st"> </span></span>
     <span id="cb23-7"><a href="#cb23-7" aria-hidden="true"></a><span class="st">    </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_MAD <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>)</span>
     <span id="cb23-8"><a href="#cb23-8" aria-hidden="true"></a></span>
     <span id="cb23-9"><a href="#cb23-9" aria-hidden="true"></a><span class="co"># Prepare random factors</span></span>
     <span id="cb23-10"><a href="#cb23-10" aria-hidden="true"></a>N170_Cat<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(N170_Cat<span class="op">$</span>ID)</span>
     <span id="cb23-11"><a href="#cb23-11" aria-hidden="true"></a>N170_Cat<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(N170_Cat<span class="op">$</span>Stim_Type)</span>
     <span id="cb23-12"><a href="#cb23-12" aria-hidden="true"></a></span>
     <span id="cb23-13"><a href="#cb23-13" aria-hidden="true"></a><span class="co"># Define novel vs repeated trials</span></span>
     <span id="cb23-14"><a href="#cb23-14" aria-hidden="true"></a>N170_Cat<span class="op">$</span>Condition[N170_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">4</span>] =<span class="st"> &quot;c_happy&quot;</span></span>
     <span id="cb23-15"><a href="#cb23-15" aria-hidden="true"></a>N170_Cat<span class="op">$</span>Condition[N170_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">5</span>] =<span class="st"> &quot;c_neutral&quot;</span></span>
     <span id="cb23-16"><a href="#cb23-16" aria-hidden="true"></a>N170_Cat<span class="op">$</span>Condition[N170_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">6</span>] =<span class="st"> &quot;c_angry&quot;</span></span>
     <span id="cb23-17"><a href="#cb23-17" aria-hidden="true"></a>N170_Cat<span class="op">$</span>Condition[N170_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">7</span>] =<span class="st"> &quot;ic_happy&quot;</span></span>
     <span id="cb23-18"><a href="#cb23-18" aria-hidden="true"></a>N170_Cat<span class="op">$</span>Condition[N170_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">8</span>] =<span class="st"> &quot;ic_neutral&quot;</span></span>
     <span id="cb23-19"><a href="#cb23-19" aria-hidden="true"></a>N170_Cat<span class="op">$</span>Condition[N170_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">9</span>] =<span class="st"> &quot;ic_angry&quot;</span></span>
     <span id="cb23-20"><a href="#cb23-20" aria-hidden="true"></a></span>
     <span id="cb23-21"><a href="#cb23-21" aria-hidden="true"></a><span class="co"># Separate data in left and right hemisphere</span></span>
     <span id="cb23-22"><a href="#cb23-22" aria-hidden="true"></a>N170_Cat =<span class="st"> </span><span class="kw">gather</span>(N170_Cat, Elect_site, N170_Amplitude, mean_ROI_N170l<span class="op">:</span>mean_ROI_N170r, </span>
     <span id="cb23-23"><a href="#cb23-23" aria-hidden="true"></a>    <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
     <span id="cb23-24"><a href="#cb23-24" aria-hidden="true"></a>N170_Cat<span class="op">$</span>Elect_site =<span class="st"> </span><span class="kw">as.character</span>(N170_Cat<span class="op">$</span>Elect_site)</span>
     <span id="cb23-25"><a href="#cb23-25" aria-hidden="true"></a></span>
     <span id="cb23-26"><a href="#cb23-26" aria-hidden="true"></a><span class="co"># Add variable name</span></span>
     <span id="cb23-27"><a href="#cb23-27" aria-hidden="true"></a>N170_Cat<span class="op">$</span>Elect_site[N170_Cat<span class="op">$</span>Elect_site <span class="op">==</span><span class="st"> &quot;mean_ROI_N170l&quot;</span>] =<span class="st"> &quot;left&quot;</span></span>
     <span id="cb23-28"><a href="#cb23-28" aria-hidden="true"></a>N170_Cat<span class="op">$</span>Elect_site[N170_Cat<span class="op">$</span>Elect_site <span class="op">==</span><span class="st"> &quot;mean_ROI_N170r&quot;</span>] =<span class="st"> &quot;right&quot;</span></span>
     <span id="cb23-29"><a href="#cb23-29" aria-hidden="true"></a></span>
     <span id="cb23-30"><a href="#cb23-30" aria-hidden="true"></a><span class="co"># Create one variable for emotion and one for repetition</span></span>
     <span id="cb23-31"><a href="#cb23-31" aria-hidden="true"></a>N170_Cat<span class="op">$</span>emot[(N170_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;c_happy&quot;</span>) <span class="op">|</span><span class="st"> </span>(N170_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;ic_happy&quot;</span>)] =<span class="st"> </span><span class="dv">1</span></span>
     <span id="cb23-32"><a href="#cb23-32" aria-hidden="true"></a>N170_Cat<span class="op">$</span>emot[(N170_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;c_angry&quot;</span>) <span class="op">|</span><span class="st"> </span>(N170_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;ic_angry&quot;</span>)] =<span class="st"> </span><span class="dv">2</span></span>
     <span id="cb23-33"><a href="#cb23-33" aria-hidden="true"></a>N170_Cat<span class="op">$</span>emot[(N170_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;c_neutral&quot;</span>) <span class="op">|</span><span class="st"> </span>(N170_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;ic_neutral&quot;</span>)] =<span class="st"> </span><span class="dv">3</span></span>
     <span id="cb23-34"><a href="#cb23-34" aria-hidden="true"></a></span>
     <span id="cb23-35"><a href="#cb23-35" aria-hidden="true"></a>N170_Cat<span class="op">$</span>rep[(N170_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;c_happy&quot;</span>) <span class="op">|</span><span class="st"> </span>(N170_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;c_angry&quot;</span>) <span class="op">|</span><span class="st"> </span></span>
     <span id="cb23-36"><a href="#cb23-36" aria-hidden="true"></a><span class="st">    </span>(N170_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;c_neutral&quot;</span>)] =<span class="st"> </span><span class="dv">1</span></span>
     <span id="cb23-37"><a href="#cb23-37" aria-hidden="true"></a>N170_Cat<span class="op">$</span>rep[(N170_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;ic_happy&quot;</span>) <span class="op">|</span><span class="st"> </span>(N170_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;ic_angry&quot;</span>) <span class="op">|</span><span class="st"> </span></span>
     <span id="cb23-38"><a href="#cb23-38" aria-hidden="true"></a><span class="st">    </span>(N170_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;ic_neutral&quot;</span>)] =<span class="st"> </span><span class="dv">2</span></span>
     <span id="cb23-39"><a href="#cb23-39" aria-hidden="true"></a></span>
     <span id="cb23-40"><a href="#cb23-40" aria-hidden="true"></a><span class="co"># Rename variables</span></span>
     <span id="cb23-41"><a href="#cb23-41" aria-hidden="true"></a>N170_Cat<span class="op">$</span>emot[N170_Cat<span class="op">$</span>emot <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;happy&quot;</span></span>
     <span id="cb23-42"><a href="#cb23-42" aria-hidden="true"></a>N170_Cat<span class="op">$</span>emot[N170_Cat<span class="op">$</span>emot <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;angry&quot;</span></span>
     <span id="cb23-43"><a href="#cb23-43" aria-hidden="true"></a>N170_Cat<span class="op">$</span>emot[N170_Cat<span class="op">$</span>emot <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] =<span class="st"> &quot;neutral&quot;</span></span>
     <span id="cb23-44"><a href="#cb23-44" aria-hidden="true"></a></span>
     <span id="cb23-45"><a href="#cb23-45" aria-hidden="true"></a><span class="co"># Rename variables</span></span>
     <span id="cb23-46"><a href="#cb23-46" aria-hidden="true"></a>N170_Cat<span class="op">$</span>rep[N170_Cat<span class="op">$</span>rep <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;repeated&quot;</span></span>
     <span id="cb23-47"><a href="#cb23-47" aria-hidden="true"></a>N170_Cat<span class="op">$</span>rep[N170_Cat<span class="op">$</span>rep <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;novel&quot;</span></span>
     <span id="cb23-48"><a href="#cb23-48" aria-hidden="true"></a></span>
     <span id="cb23-49"><a href="#cb23-49" aria-hidden="true"></a><span class="co"># Factor and create contrasts</span></span>
     <span id="cb23-50"><a href="#cb23-50" aria-hidden="true"></a>N170_Cat<span class="op">$</span>rep =<span class="st"> </span><span class="kw">factor</span>(N170_Cat<span class="op">$</span>rep)</span>
     <span id="cb23-51"><a href="#cb23-51" aria-hidden="true"></a>N170_Cat<span class="op">$</span>emot =<span class="st"> </span><span class="kw">factor</span>(N170_Cat<span class="op">$</span>emot)</span>
     <span id="cb23-52"><a href="#cb23-52" aria-hidden="true"></a></span>
     <span id="cb23-53"><a href="#cb23-53" aria-hidden="true"></a><span class="kw">contrasts</span>(N170_Cat<span class="op">$</span>rep) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>, <span class="dt">base =</span> <span class="dv">1</span>)</span>
     <span id="cb23-54"><a href="#cb23-54" aria-hidden="true"></a><span class="kw">contrasts</span>(N170_Cat<span class="op">$</span>emot) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>, <span class="dt">base =</span> <span class="dv">3</span>)</span>
     <span id="cb23-55"><a href="#cb23-55" aria-hidden="true"></a></span>
     <span id="cb23-56"><a href="#cb23-56" aria-hidden="true"></a><span class="co"># A = angry, N = neutral, H = happy</span></span>
     <span id="cb23-57"><a href="#cb23-57" aria-hidden="true"></a>HvsA =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">-0.5</span>, <span class="dv">0</span>)</span>
     <span id="cb23-58"><a href="#cb23-58" aria-hidden="true"></a>EvsN =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">0</span>)</span>
     <span id="cb23-59"><a href="#cb23-59" aria-hidden="true"></a><span class="kw">contrasts</span>(N170_Cat<span class="op">$</span>emot) =<span class="st"> </span><span class="kw">cbind</span>(EvsN, HvsA)</span>
     <span id="cb23-60"><a href="#cb23-60" aria-hidden="true"></a></span>
     <span id="cb23-61"><a href="#cb23-61" aria-hidden="true"></a><span class="co"># Add contrast columns</span></span>
     <span id="cb23-62"><a href="#cb23-62" aria-hidden="true"></a>mm_N170_Cat =<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span>emot <span class="op">*</span><span class="st"> </span>rep <span class="op">+</span><span class="st"> </span>Elect_site, N170_Cat)</span>
     <span id="cb23-63"><a href="#cb23-63" aria-hidden="true"></a></span>
     <span id="cb23-64"><a href="#cb23-64" aria-hidden="true"></a><span class="co"># Attach to dataframe</span></span>
     <span id="cb23-65"><a href="#cb23-65" aria-hidden="true"></a>N170_Cat[, (<span class="kw">ncol</span>(N170_Cat) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(N170_Cat) <span class="op">+</span><span class="st"> </span><span class="dv">7</span>)] =<span class="st"> </span>mm_N170_Cat</span>
     <span id="cb23-66"><a href="#cb23-66" aria-hidden="true"></a><span class="kw">names</span>(N170_Cat)[(<span class="kw">ncol</span>(N170_Cat) <span class="op">-</span><span class="st"> </span><span class="dv">6</span>)<span class="op">:</span><span class="kw">ncol</span>(N170_Cat)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;Emo_Neu&quot;</span>, <span class="st">&quot;Hap_Ang&quot;</span>, </span>
     <span id="cb23-67"><a href="#cb23-67" aria-hidden="true"></a>    <span class="st">&quot;Rep_Nov&quot;</span>, <span class="st">&quot;Emo_NeuxRep_Nov&quot;</span>, <span class="st">&quot;Hap_AngxRep_Nov&quot;</span>, <span class="st">&quot;Hem&quot;</span>)</span>
     <span id="cb23-68"><a href="#cb23-68" aria-hidden="true"></a></span>
     <span id="cb23-69"><a href="#cb23-69" aria-hidden="true"></a><span class="co"># Build full model</span></span>
     <span id="cb23-70"><a href="#cb23-70" aria-hidden="true"></a>mod_N170_cat.lmer1 =<span class="st"> </span><span class="kw">lmer</span>(N170_Amplitude <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Rep_Nov <span class="op">+</span><span class="st"> </span>Emo_NeuxRep_Nov <span class="op">+</span><span class="st"> </span></span>
     <span id="cb23-71"><a href="#cb23-71" aria-hidden="true"></a><span class="st">    </span>Hap_AngxRep_Nov <span class="op">+</span><span class="st"> </span>Hem <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Rep_Nov <span class="op">+</span><span class="st"> </span></span>
     <span id="cb23-72"><a href="#cb23-72" aria-hidden="true"></a><span class="st">    </span>Emo_NeuxRep_Nov <span class="op">+</span><span class="st"> </span>Hap_AngxRep_Nov <span class="op">+</span><span class="st"> </span>Hem <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Rep_Nov <span class="op">+</span><span class="st"> </span></span>
     <span id="cb23-73"><a href="#cb23-73" aria-hidden="true"></a><span class="st">    </span>Emo_NeuxRep_Nov <span class="op">+</span><span class="st"> </span>Hap_AngxRep_Nov <span class="op">+</span><span class="st"> </span>Hem <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> N170_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
     <span id="cb23-74"><a href="#cb23-74" aria-hidden="true"></a></span>
     <span id="cb23-75"><a href="#cb23-75" aria-hidden="true"></a></span>
     <span id="cb23-76"><a href="#cb23-76" aria-hidden="true"></a></span>
     <span id="cb23-77"><a href="#cb23-77" aria-hidden="true"></a><span class="co"># 1st: check how many zero variance terms you got in random effects</span></span>
     <span id="cb23-78"><a href="#cb23-78" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_N170_cat.lmer1))</span>
     <span id="cb23-79"><a href="#cb23-79" aria-hidden="true"></a></span>
     <span id="cb23-80"><a href="#cb23-80" aria-hidden="true"></a><span class="co"># 2nd: check which random terms explain the least variance</span></span>
     <span id="cb23-81"><a href="#cb23-81" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_N170_cat.lmer1), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
     <span id="cb23-82"><a href="#cb23-82" aria-hidden="true"></a></span>
     <span id="cb23-83"><a href="#cb23-83" aria-hidden="true"></a><span class="co"># Improved model</span></span>
     <span id="cb23-84"><a href="#cb23-84" aria-hidden="true"></a>mod_N170_cat.lmer2 =<span class="st"> </span><span class="kw">lmer</span>(N170_Amplitude <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Rep_Nov <span class="op">+</span><span class="st"> </span>Emo_NeuxRep_Nov <span class="op">+</span><span class="st"> </span></span>
     <span id="cb23-85"><a href="#cb23-85" aria-hidden="true"></a><span class="st">    </span>Hap_AngxRep_Nov <span class="op">+</span><span class="st"> </span>Hem <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Emo_NeuxRep_Nov <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span></span>
     <span id="cb23-86"><a href="#cb23-86" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Hem <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> N170_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
     <span id="cb23-87"><a href="#cb23-87" aria-hidden="true"></a><span class="co"># Re-check variances</span></span>
     <span id="cb23-88"><a href="#cb23-88" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_N170_cat.lmer2))</span>
     <span id="cb23-89"><a href="#cb23-89" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_N170_cat.lmer2), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
     <span id="cb23-90"><a href="#cb23-90" aria-hidden="true"></a></span>
     <span id="cb23-91"><a href="#cb23-91" aria-hidden="true"></a><span class="co">## Likelihood ratio testing</span></span>
     <span id="cb23-92"><a href="#cb23-92" aria-hidden="true"></a></span>
     <span id="cb23-93"><a href="#cb23-93" aria-hidden="true"></a><span class="co"># ID</span></span>
     <span id="cb23-94"><a href="#cb23-94" aria-hidden="true"></a>mod_N170_cat.lmer3 =<span class="st"> </span><span class="kw">lmer</span>(N170_Amplitude <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Rep_Nov <span class="op">+</span><span class="st"> </span>Emo_NeuxRep_Nov <span class="op">+</span><span class="st"> </span></span>
     <span id="cb23-95"><a href="#cb23-95" aria-hidden="true"></a><span class="st">    </span>Hap_AngxRep_Nov <span class="op">+</span><span class="st"> </span>Hem <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Hem <span class="op">||</span><span class="st"> </span></span>
     <span id="cb23-96"><a href="#cb23-96" aria-hidden="true"></a><span class="st">    </span>Stim_Type), <span class="dt">data =</span> N170_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
     <span id="cb23-97"><a href="#cb23-97" aria-hidden="true"></a></span>
     <span id="cb23-98"><a href="#cb23-98" aria-hidden="true"></a><span class="co"># Stim Type</span></span>
     <span id="cb23-99"><a href="#cb23-99" aria-hidden="true"></a>mod_N170_cat.lmer4 =<span class="st"> </span><span class="kw">lmer</span>(N170_Amplitude <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Rep_Nov <span class="op">+</span><span class="st"> </span>Emo_NeuxRep_Nov <span class="op">+</span><span class="st"> </span></span>
     <span id="cb23-100"><a href="#cb23-100" aria-hidden="true"></a><span class="st">    </span>Hap_AngxRep_Nov <span class="op">+</span><span class="st"> </span>Hem <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Emo_NeuxRep_Nov <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span></span>
     <span id="cb23-101"><a href="#cb23-101" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> N170_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
     <span id="cb23-102"><a href="#cb23-102" aria-hidden="true"></a><span class="co"># Without Stim Type</span></span>
     <span id="cb23-103"><a href="#cb23-103" aria-hidden="true"></a>mod_N170_cat.lmer5 =<span class="st"> </span><span class="kw">lmer</span>(N170_Amplitude <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Rep_Nov <span class="op">+</span><span class="st"> </span>Emo_NeuxRep_Nov <span class="op">+</span><span class="st"> </span></span>
     <span id="cb23-104"><a href="#cb23-104" aria-hidden="true"></a><span class="st">    </span>Hap_AngxRep_Nov <span class="op">+</span><span class="st"> </span>Hem <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID), <span class="dt">data =</span> N170_Cat, </span>
     <span id="cb23-105"><a href="#cb23-105" aria-hidden="true"></a>    <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
     <span id="cb23-106"><a href="#cb23-106" aria-hidden="true"></a></span>
     <span id="cb23-107"><a href="#cb23-107" aria-hidden="true"></a><span class="co"># Calculate ANOVA</span></span>
     <span id="cb23-108"><a href="#cb23-108" aria-hidden="true"></a><span class="kw">anova</span>(mod_N170_cat.lmer2, mod_N170_cat.lmer3)</span>
     <span id="cb23-109"><a href="#cb23-109" aria-hidden="true"></a><span class="kw">anova</span>(mod_N170_cat.lmer2, mod_N170_cat.lmer4)</span>
     <span id="cb23-110"><a href="#cb23-110" aria-hidden="true"></a><span class="kw">anova</span>(mod_N170_cat.lmer2, mod_N170_cat.lmer5)</span>
     <span id="cb23-111"><a href="#cb23-111" aria-hidden="true"></a></span>
     <span id="cb23-112"><a href="#cb23-112" aria-hidden="true"></a><span class="co"># Final model</span></span>
     <span id="cb23-113"><a href="#cb23-113" aria-hidden="true"></a>mod_N170_cat.lmer4 =<span class="st"> </span>mod_N170_cat.lmer4 =<span class="st"> </span><span class="kw">lmer</span>(N170_Amplitude <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span></span>
     <span id="cb23-114"><a href="#cb23-114" aria-hidden="true"></a><span class="st">    </span>Rep_Nov <span class="op">+</span><span class="st"> </span>Emo_NeuxRep_Nov <span class="op">+</span><span class="st"> </span>Hap_AngxRep_Nov <span class="op">+</span><span class="st"> </span>Hem <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span></span>
     <span id="cb23-115"><a href="#cb23-115" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Emo_NeuxRep_Nov <span class="op">||</span><span class="st"> </span>ID), <span class="dt">data =</span> N170_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span></code></pre></div>
     <p><code>N170_Amplitude ~ Emo_Neu + Hap_Ang + Rep_Nov + Emo_NeuxRep_Nov + ,     Hap_AngxRep_Nov + Hem + WM_scal + contr_F2_scal + ((1 | ID) + ,     (0 + Emo_NeuxRep_Nov | ID))</code></p>
     <hr />
     </div>
     <div id="lmm_n170_rep-normality-of-residuals" class="section level4">
     <h4>LMM_N170_rep: Normality of residuals</h4>
     <div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true"></a><span class="co">## Check properties of DV / residuals</span></span>
     <span id="cb24-2"><a href="#cb24-2" aria-hidden="true"></a>N170_Cat<span class="op">$</span>Trans_N170 =<span class="st"> </span>N170_Cat<span class="op">$</span>N170_Amplitude <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(N170_Cat<span class="op">$</span>N170_Amplitude)</span>
     <span id="cb24-3"><a href="#cb24-3" aria-hidden="true"></a></span>
     <span id="cb24-4"><a href="#cb24-4" aria-hidden="true"></a><span class="co"># To make sure residuals follow ND: Calculate box-cox plot</span></span>
     <span id="cb24-5"><a href="#cb24-5" aria-hidden="true"></a><span class="kw">boxcox</span>(N170_Cat<span class="op">$</span>Trans_N170 <span class="op">~</span><span class="st"> </span>N170_Cat<span class="op">$</span>Group_pcic)</span></code></pre></div>
     <p><img src="R_Script_3_ERP_measures_files/figure-html/N170_cat_res_box-1.png" width="576" style="display: block; margin: auto;" /></p>
     <p>N170 amplitudes met the assumption of normally distributed residuals.</p>
     <div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true"></a><span class="co"># Visualize normality assumption of residuals (without log transform)</span></span>
     <span id="cb25-2"><a href="#cb25-2" aria-hidden="true"></a>mod_N170_Cat =<span class="st"> </span><span class="kw">lm</span>(Trans_N170 <span class="op">~</span><span class="st"> </span>Group_pcic, <span class="dt">data =</span> N170_Cat)</span>
     <span id="cb25-3"><a href="#cb25-3" aria-hidden="true"></a>res.mod_N170_Cat =<span class="st"> </span><span class="kw">residuals</span>(mod_N170_Cat)</span>
     <span id="cb25-4"><a href="#cb25-4" aria-hidden="true"></a></span>
     <span id="cb25-5"><a href="#cb25-5" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
     <span id="cb25-6"><a href="#cb25-6" aria-hidden="true"></a>qqpl_mod_N170_Cat =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_N170_Cat, <span class="dt">main =</span> <span class="st">&quot;QQplot before transformation&quot;</span>)</span>
     <span id="cb25-7"><a href="#cb25-7" aria-hidden="true"></a>norm_mod_N170_Cat =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_N170_Cat), <span class="dt">main =</span> <span class="st">&quot;Density plot before transformation&quot;</span>)</span></code></pre></div>
     <p><img src="R_Script_3_ERP_measures_files/figure-html/N170_cat_res_plot-1.png" width="576" style="display: block; margin: auto;" /></p>
     <div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
     <hr />
     </div>
     <div id="lmm_n170_rep-homoscedasticity" class="section level4">
     <h4>LMM_N170_rep: Homoscedasticity</h4>
     <div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true"></a><span class="co"># Check homoscedasticity</span></span>
     <span id="cb27-2"><a href="#cb27-2" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">fitted</span>(mod_N170_cat.lmer4), <span class="kw">residuals</span>(mod_N170_cat.lmer4))</span>
     <span id="cb27-3"><a href="#cb27-3" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span></code></pre></div>
     <p><img src="R_Script_3_ERP_measures_files/figure-html/N170_cat_homosk-1.png" width="576" style="display: block; margin: auto;" /></p>
     <p>Based on visual inspection, we assumed homoscedasticity.</p>
     <hr />
     </div>
     <div id="lmm_p3_rep-random-effect-structure" class="section level4">
     <h4>LMM_P3_rep: Random effect structure</h4>
     <p><br></p>
     <p>The final model was comprised of:</p>
     <div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true"></a><span class="co"># Select correct responses and outlier-free data</span></span>
     <span id="cb28-2"><a href="#cb28-2" aria-hidden="true"></a>P3_Cat =<span class="st"> </span><span class="kw">subset</span>(ERP_data, Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
     <span id="cb28-3"><a href="#cb28-3" aria-hidden="true"></a>P3_Cat =<span class="st"> </span><span class="kw">subset</span>(P3_Cat, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_larger_7s <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span></span>
     <span id="cb28-4"><a href="#cb28-4" aria-hidden="true"></a><span class="st">    </span>Exclude_MAD <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>)</span>
     <span id="cb28-5"><a href="#cb28-5" aria-hidden="true"></a></span>
     <span id="cb28-6"><a href="#cb28-6" aria-hidden="true"></a><span class="co"># Select targets</span></span>
     <span id="cb28-7"><a href="#cb28-7" aria-hidden="true"></a>P3_Cat =<span class="st"> </span><span class="kw">subset</span>(P3_Cat, Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">2</span>)</span>
     <span id="cb28-8"><a href="#cb28-8" aria-hidden="true"></a></span>
     <span id="cb28-9"><a href="#cb28-9" aria-hidden="true"></a><span class="co"># Prepare fixed factors</span></span>
     <span id="cb28-10"><a href="#cb28-10" aria-hidden="true"></a>P3_Cat<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(P3_Cat<span class="op">$</span>ID)</span>
     <span id="cb28-11"><a href="#cb28-11" aria-hidden="true"></a>P3_Cat<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(P3_Cat<span class="op">$</span>Stim_Type)</span>
     <span id="cb28-12"><a href="#cb28-12" aria-hidden="true"></a></span>
     <span id="cb28-13"><a href="#cb28-13" aria-hidden="true"></a><span class="co"># Define novel vs repeated trials</span></span>
     <span id="cb28-14"><a href="#cb28-14" aria-hidden="true"></a>P3_Cat<span class="op">$</span>Condition[P3_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">4</span>] =<span class="st"> &quot;c_happy&quot;</span></span>
     <span id="cb28-15"><a href="#cb28-15" aria-hidden="true"></a>P3_Cat<span class="op">$</span>Condition[P3_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">5</span>] =<span class="st"> &quot;c_neutral&quot;</span></span>
     <span id="cb28-16"><a href="#cb28-16" aria-hidden="true"></a>P3_Cat<span class="op">$</span>Condition[P3_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">6</span>] =<span class="st"> &quot;c_angry&quot;</span></span>
     <span id="cb28-17"><a href="#cb28-17" aria-hidden="true"></a>P3_Cat<span class="op">$</span>Condition[P3_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">7</span>] =<span class="st"> &quot;ic_happy&quot;</span></span>
     <span id="cb28-18"><a href="#cb28-18" aria-hidden="true"></a>P3_Cat<span class="op">$</span>Condition[P3_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">8</span>] =<span class="st"> &quot;ic_neutral&quot;</span></span>
     <span id="cb28-19"><a href="#cb28-19" aria-hidden="true"></a>P3_Cat<span class="op">$</span>Condition[P3_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">9</span>] =<span class="st"> &quot;ic_angry&quot;</span></span>
     <span id="cb28-20"><a href="#cb28-20" aria-hidden="true"></a></span>
     <span id="cb28-21"><a href="#cb28-21" aria-hidden="true"></a><span class="co"># Create one variable for emotion and one for repetition</span></span>
     <span id="cb28-22"><a href="#cb28-22" aria-hidden="true"></a>P3_Cat<span class="op">$</span>emot[(P3_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;c_happy&quot;</span>) <span class="op">|</span><span class="st"> </span>(P3_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;ic_happy&quot;</span>)] =<span class="st"> </span><span class="dv">1</span></span>
     <span id="cb28-23"><a href="#cb28-23" aria-hidden="true"></a>P3_Cat<span class="op">$</span>emot[(P3_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;c_angry&quot;</span>) <span class="op">|</span><span class="st"> </span>(P3_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;ic_angry&quot;</span>)] =<span class="st"> </span><span class="dv">2</span></span>
     <span id="cb28-24"><a href="#cb28-24" aria-hidden="true"></a>P3_Cat<span class="op">$</span>emot[(P3_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;c_neutral&quot;</span>) <span class="op">|</span><span class="st"> </span>(P3_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;ic_neutral&quot;</span>)] =<span class="st"> </span><span class="dv">3</span></span>
     <span id="cb28-25"><a href="#cb28-25" aria-hidden="true"></a></span>
     <span id="cb28-26"><a href="#cb28-26" aria-hidden="true"></a>P3_Cat<span class="op">$</span>rep[(P3_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;c_happy&quot;</span>) <span class="op">|</span><span class="st"> </span>(P3_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;c_angry&quot;</span>) <span class="op">|</span><span class="st"> </span>(P3_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span></span>
     <span id="cb28-27"><a href="#cb28-27" aria-hidden="true"></a><span class="st">    &quot;c_neutral&quot;</span>)] =<span class="st"> </span><span class="dv">1</span></span>
     <span id="cb28-28"><a href="#cb28-28" aria-hidden="true"></a>P3_Cat<span class="op">$</span>rep[(P3_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;ic_happy&quot;</span>) <span class="op">|</span><span class="st"> </span>(P3_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;ic_angry&quot;</span>) <span class="op">|</span><span class="st"> </span></span>
     <span id="cb28-29"><a href="#cb28-29" aria-hidden="true"></a><span class="st">    </span>(P3_Cat<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;ic_neutral&quot;</span>)] =<span class="st"> </span><span class="dv">2</span></span>
     <span id="cb28-30"><a href="#cb28-30" aria-hidden="true"></a></span>
     <span id="cb28-31"><a href="#cb28-31" aria-hidden="true"></a><span class="co"># Rename variables</span></span>
     <span id="cb28-32"><a href="#cb28-32" aria-hidden="true"></a>P3_Cat<span class="op">$</span>emot[P3_Cat<span class="op">$</span>emot <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;happy&quot;</span></span>
     <span id="cb28-33"><a href="#cb28-33" aria-hidden="true"></a>P3_Cat<span class="op">$</span>emot[P3_Cat<span class="op">$</span>emot <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;angry&quot;</span></span>
     <span id="cb28-34"><a href="#cb28-34" aria-hidden="true"></a>P3_Cat<span class="op">$</span>emot[P3_Cat<span class="op">$</span>emot <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] =<span class="st"> &quot;neutral&quot;</span></span>
     <span id="cb28-35"><a href="#cb28-35" aria-hidden="true"></a></span>
     <span id="cb28-36"><a href="#cb28-36" aria-hidden="true"></a>P3_Cat<span class="op">$</span>rep[P3_Cat<span class="op">$</span>rep <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;repeated&quot;</span></span>
     <span id="cb28-37"><a href="#cb28-37" aria-hidden="true"></a>P3_Cat<span class="op">$</span>rep[P3_Cat<span class="op">$</span>rep <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;novel&quot;</span></span>
     <span id="cb28-38"><a href="#cb28-38" aria-hidden="true"></a></span>
     <span id="cb28-39"><a href="#cb28-39" aria-hidden="true"></a><span class="co"># Factor variables</span></span>
     <span id="cb28-40"><a href="#cb28-40" aria-hidden="true"></a>P3_Cat<span class="op">$</span>rep =<span class="st"> </span><span class="kw">factor</span>(P3_Cat<span class="op">$</span>rep)</span>
     <span id="cb28-41"><a href="#cb28-41" aria-hidden="true"></a>P3_Cat<span class="op">$</span>emot =<span class="st"> </span><span class="kw">factor</span>(P3_Cat<span class="op">$</span>emot)</span>
     <span id="cb28-42"><a href="#cb28-42" aria-hidden="true"></a></span>
     <span id="cb28-43"><a href="#cb28-43" aria-hidden="true"></a><span class="co"># Create contrasts</span></span>
     <span id="cb28-44"><a href="#cb28-44" aria-hidden="true"></a><span class="kw">contrasts</span>(P3_Cat<span class="op">$</span>emot) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>, <span class="dt">base =</span> <span class="dv">3</span>)</span>
     <span id="cb28-45"><a href="#cb28-45" aria-hidden="true"></a></span>
     <span id="cb28-46"><a href="#cb28-46" aria-hidden="true"></a><span class="co"># A = angry, N = neutral, H = happy</span></span>
     <span id="cb28-47"><a href="#cb28-47" aria-hidden="true"></a>HvsA =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">-0.5</span>, <span class="dv">0</span>)</span>
     <span id="cb28-48"><a href="#cb28-48" aria-hidden="true"></a>EvsN =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">0</span>)</span>
     <span id="cb28-49"><a href="#cb28-49" aria-hidden="true"></a><span class="kw">contrasts</span>(P3_Cat<span class="op">$</span>emot) =<span class="st"> </span><span class="kw">cbind</span>(EvsN, HvsA)</span>
     <span id="cb28-50"><a href="#cb28-50" aria-hidden="true"></a></span>
     <span id="cb28-51"><a href="#cb28-51" aria-hidden="true"></a><span class="co"># Add contrast columns</span></span>
     <span id="cb28-52"><a href="#cb28-52" aria-hidden="true"></a>mm_P3_Cat =<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span>emot <span class="op">*</span><span class="st"> </span>rep, P3_Cat)</span>
     <span id="cb28-53"><a href="#cb28-53" aria-hidden="true"></a></span>
     <span id="cb28-54"><a href="#cb28-54" aria-hidden="true"></a><span class="co"># Attach to dataframe</span></span>
     <span id="cb28-55"><a href="#cb28-55" aria-hidden="true"></a>P3_Cat[, (<span class="kw">ncol</span>(P3_Cat) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(P3_Cat) <span class="op">+</span><span class="st"> </span><span class="dv">6</span>)] =<span class="st"> </span>mm_P3_Cat</span>
     <span id="cb28-56"><a href="#cb28-56" aria-hidden="true"></a><span class="kw">names</span>(P3_Cat)[(<span class="kw">ncol</span>(P3_Cat) <span class="op">-</span><span class="st"> </span><span class="dv">5</span>)<span class="op">:</span><span class="kw">ncol</span>(P3_Cat)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;Emo_Neu&quot;</span>, <span class="st">&quot;Hap_Ang&quot;</span>, </span>
     <span id="cb28-57"><a href="#cb28-57" aria-hidden="true"></a>    <span class="st">&quot;Rep_Nov&quot;</span>, <span class="st">&quot;Emo_NeuxRep_Nov&quot;</span>, <span class="st">&quot;Hap_AngxRep_Nov&quot;</span>)</span>
     <span id="cb28-58"><a href="#cb28-58" aria-hidden="true"></a></span>
     <span id="cb28-59"><a href="#cb28-59" aria-hidden="true"></a><span class="co"># Build full model</span></span>
     <span id="cb28-60"><a href="#cb28-60" aria-hidden="true"></a>mod_P3_cat.lmer1 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P3 <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Rep_Nov <span class="op">+</span><span class="st"> </span>Emo_NeuxRep_Nov <span class="op">+</span><span class="st"> </span></span>
     <span id="cb28-61"><a href="#cb28-61" aria-hidden="true"></a><span class="st">    </span>Hap_AngxRep_Nov <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Rep_Nov <span class="op">+</span><span class="st"> </span></span>
     <span id="cb28-62"><a href="#cb28-62" aria-hidden="true"></a><span class="st">    </span>Emo_NeuxRep_Nov <span class="op">+</span><span class="st"> </span>Hap_AngxRep_Nov <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Rep_Nov <span class="op">+</span><span class="st"> </span></span>
     <span id="cb28-63"><a href="#cb28-63" aria-hidden="true"></a><span class="st">    </span>Emo_NeuxRep_Nov <span class="op">+</span><span class="st"> </span>Hap_AngxRep_Nov <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> P3_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
     <span id="cb28-64"><a href="#cb28-64" aria-hidden="true"></a></span>
     <span id="cb28-65"><a href="#cb28-65" aria-hidden="true"></a><span class="co"># 1st: check how many zero variance terms you got in random effects</span></span>
     <span id="cb28-66"><a href="#cb28-66" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_P3_cat.lmer1))</span>
     <span id="cb28-67"><a href="#cb28-67" aria-hidden="true"></a></span>
     <span id="cb28-68"><a href="#cb28-68" aria-hidden="true"></a><span class="co"># 2nd: check which random terms explain the least variance</span></span>
     <span id="cb28-69"><a href="#cb28-69" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_P3_cat.lmer1), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
     <span id="cb28-70"><a href="#cb28-70" aria-hidden="true"></a></span>
     <span id="cb28-71"><a href="#cb28-71" aria-hidden="true"></a><span class="co"># Improved model</span></span>
     <span id="cb28-72"><a href="#cb28-72" aria-hidden="true"></a>mod_P3_cat.lmer2 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P3 <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Rep_Nov <span class="op">+</span><span class="st"> </span>Emo_NeuxRep_Nov <span class="op">+</span><span class="st"> </span></span>
     <span id="cb28-73"><a href="#cb28-73" aria-hidden="true"></a><span class="st">    </span>Hap_AngxRep_Nov <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Rep_Nov <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Rep_Nov <span class="op">||</span><span class="st"> </span></span>
     <span id="cb28-74"><a href="#cb28-74" aria-hidden="true"></a><span class="st">    </span>Stim_Type), <span class="dt">data =</span> P3_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
     <span id="cb28-75"><a href="#cb28-75" aria-hidden="true"></a><span class="co"># Re-check the model</span></span>
     <span id="cb28-76"><a href="#cb28-76" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_P3_cat.lmer2))</span>
     <span id="cb28-77"><a href="#cb28-77" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_P3_cat.lmer2), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
     <span id="cb28-78"><a href="#cb28-78" aria-hidden="true"></a></span>
     <span id="cb28-79"><a href="#cb28-79" aria-hidden="true"></a><span class="co">## Likelhood ratio testing</span></span>
     <span id="cb28-80"><a href="#cb28-80" aria-hidden="true"></a></span>
     <span id="cb28-81"><a href="#cb28-81" aria-hidden="true"></a><span class="co"># ID</span></span>
     <span id="cb28-82"><a href="#cb28-82" aria-hidden="true"></a>mod_P3_cat.lmer3 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P3 <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Rep_Nov <span class="op">+</span><span class="st"> </span>Emo_NeuxRep_Nov <span class="op">+</span><span class="st"> </span></span>
     <span id="cb28-83"><a href="#cb28-83" aria-hidden="true"></a><span class="st">    </span>Hap_AngxRep_Nov <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Rep_Nov <span class="op">||</span><span class="st"> </span>Stim_Type), </span>
     <span id="cb28-84"><a href="#cb28-84" aria-hidden="true"></a>    <span class="dt">data =</span> P3_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
     <span id="cb28-85"><a href="#cb28-85" aria-hidden="true"></a></span>
     <span id="cb28-86"><a href="#cb28-86" aria-hidden="true"></a><span class="co"># Calculate ANOVA</span></span>
     <span id="cb28-87"><a href="#cb28-87" aria-hidden="true"></a><span class="kw">anova</span>(mod_P3_cat.lmer2, mod_P3_cat.lmer3)</span>
     <span id="cb28-88"><a href="#cb28-88" aria-hidden="true"></a></span>
     <span id="cb28-89"><a href="#cb28-89" aria-hidden="true"></a><span class="co"># Stim_Type</span></span>
     <span id="cb28-90"><a href="#cb28-90" aria-hidden="true"></a>mod_P3_cat.lmer4 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P3 <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Rep_Nov <span class="op">+</span><span class="st"> </span>Emo_NeuxRep_Nov <span class="op">+</span><span class="st"> </span></span>
     <span id="cb28-91"><a href="#cb28-91" aria-hidden="true"></a><span class="st">    </span>Hap_AngxRep_Nov <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Rep_Nov <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type), </span>
     <span id="cb28-92"><a href="#cb28-92" aria-hidden="true"></a>    <span class="dt">data =</span> P3_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
     <span id="cb28-93"><a href="#cb28-93" aria-hidden="true"></a></span>
     <span id="cb28-94"><a href="#cb28-94" aria-hidden="true"></a></span>
     <span id="cb28-95"><a href="#cb28-95" aria-hidden="true"></a><span class="co"># Calculate ANOVA</span></span>
     <span id="cb28-96"><a href="#cb28-96" aria-hidden="true"></a><span class="kw">anova</span>(mod_P3_cat.lmer2, mod_P3_cat.lmer4)</span>
     <span id="cb28-97"><a href="#cb28-97" aria-hidden="true"></a></span>
     <span id="cb28-98"><a href="#cb28-98" aria-hidden="true"></a></span>
     <span id="cb28-99"><a href="#cb28-99" aria-hidden="true"></a><span class="co"># Without stim_Type</span></span>
     <span id="cb28-100"><a href="#cb28-100" aria-hidden="true"></a>mod_P3_cat.lmer5 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P3 <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Rep_Nov <span class="op">+</span><span class="st"> </span>Emo_NeuxRep_Nov <span class="op">+</span><span class="st"> </span></span>
     <span id="cb28-101"><a href="#cb28-101" aria-hidden="true"></a><span class="st">    </span>Hap_AngxRep_Nov <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID), <span class="dt">data =</span> P3_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
     <span id="cb28-102"><a href="#cb28-102" aria-hidden="true"></a><span class="co"># Calculate ANOVA</span></span>
     <span id="cb28-103"><a href="#cb28-103" aria-hidden="true"></a><span class="kw">anova</span>(mod_P3_cat.lmer2, mod_P3_cat.lmer5)</span>
     <span id="cb28-104"><a href="#cb28-104" aria-hidden="true"></a></span>
     <span id="cb28-105"><a href="#cb28-105" aria-hidden="true"></a></span>
     <span id="cb28-106"><a href="#cb28-106" aria-hidden="true"></a><span class="co"># Final model</span></span>
     <span id="cb28-107"><a href="#cb28-107" aria-hidden="true"></a>mod_P3_cat.lmer4 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P3 <span class="op">~</span><span class="st"> </span>Emo_Neu <span class="op">+</span><span class="st"> </span>Hap_Ang <span class="op">+</span><span class="st"> </span>Rep_Nov <span class="op">+</span><span class="st"> </span>Emo_NeuxRep_Nov <span class="op">+</span><span class="st"> </span></span>
     <span id="cb28-108"><a href="#cb28-108" aria-hidden="true"></a><span class="st">    </span>Hap_AngxRep_Nov <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID), <span class="dt">data =</span> P3_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span></code></pre></div>
     <p><code>mean_ROI_P3 ~ Emo_Neu + Hap_Ang + Rep_Nov + Emo_NeuxRep_Nov + ,     Hap_AngxRep_Nov + WM_scal + contr_F2_scal + (1 | ID)</code></p>
     <hr />
     </div>
     <div id="lmm_p3_rep-normality-of-residuals" class="section level4">
     <h4>LMM_P3_rep: Normality of residuals</h4>
     <div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true"></a><span class="co">## Check properties of DV / residuals</span></span>
     <span id="cb29-2"><a href="#cb29-2" aria-hidden="true"></a>P3_Cat<span class="op">$</span>Trans_P3 =<span class="st"> </span>P3_Cat<span class="op">$</span>mean_ROI_P3 <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(P3_Cat<span class="op">$</span>mean_ROI_P3)</span>
     <span id="cb29-3"><a href="#cb29-3" aria-hidden="true"></a></span>
     <span id="cb29-4"><a href="#cb29-4" aria-hidden="true"></a><span class="co"># To make sure residuals follow ND: Calculate box-cox plot</span></span>
     <span id="cb29-5"><a href="#cb29-5" aria-hidden="true"></a><span class="kw">boxcox</span>(P3_Cat<span class="op">$</span>Trans_P3 <span class="op">~</span><span class="st"> </span>P3_Cat<span class="op">$</span>Group_pcic)</span></code></pre></div>
     <p><img src="R_Script_3_ERP_measures_files/figure-html/P3_cat_res_box-1.png" width="576" style="display: block; margin: auto;" /></p>
     <p>P3 amplitudes met the assumption of normally distributed residuals.</p>
     <div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true"></a><span class="co"># Visualize normality assumption of residuals (without log transform)</span></span>
     <span id="cb30-2"><a href="#cb30-2" aria-hidden="true"></a>mod_P3_Cat =<span class="st"> </span><span class="kw">lm</span>(Trans_P3 <span class="op">~</span><span class="st"> </span>Group_pcic, <span class="dt">data =</span> P3_Cat)</span>
     <span id="cb30-3"><a href="#cb30-3" aria-hidden="true"></a>res.mod_P3_Cat =<span class="st"> </span><span class="kw">residuals</span>(mod_P3_Cat)</span>
     <span id="cb30-4"><a href="#cb30-4" aria-hidden="true"></a></span>
     <span id="cb30-5"><a href="#cb30-5" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
     <span id="cb30-6"><a href="#cb30-6" aria-hidden="true"></a>qqpl_mod_P3_Cat =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_P3_Cat, <span class="dt">main =</span> <span class="st">&quot;QQplot before transformation&quot;</span>)</span>
     <span id="cb30-7"><a href="#cb30-7" aria-hidden="true"></a>norm_mod_P3_Cat =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_P3_Cat), <span class="dt">main =</span> <span class="st">&quot;Density plot before transformation&quot;</span>)</span></code></pre></div>
     <p><img src="R_Script_3_ERP_measures_files/figure-html/P3_cat_res_plot-1.png" width="576" style="display: block; margin: auto;" /></p>
     <div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
     <hr />
     </div>
     <div id="lmm_p3_rep-homoscedasticity" class="section level4">
     <h4>LMM_P3_rep: Homoscedasticity</h4>
     <div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true"></a><span class="co"># Check homoscedasticity</span></span>
     <span id="cb32-2"><a href="#cb32-2" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">fitted</span>(mod_P3_cat.lmer4), <span class="kw">residuals</span>(mod_P3_cat.lmer4))</span>
     <span id="cb32-3"><a href="#cb32-3" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span></code></pre></div>
     <p><img src="R_Script_3_ERP_measures_files/figure-html/P3_cat_homosk-1.png" width="576" style="display: block; margin: auto;" /></p>
     <p>Based on visual inspection, we assumed homoscedasticity.</p>
     <hr />
     </div>
     </div>
     <div id="results" class="section level3">
     <h3><strong>Results</strong></h3>
     <div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true"></a><span class="co">### Calculate post-hoc tests P1 valence</span></span>
     <span id="cb33-2"><a href="#cb33-2" aria-hidden="true"></a>mod_P1_val_lmer =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P1 <span class="op">~</span><span class="st"> </span>Condition <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>contr_F1_scal <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID), </span>
     <span id="cb33-3"><a href="#cb33-3" aria-hidden="true"></a>    <span class="dt">data =</span> P1_Val, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
     <span id="cb33-4"><a href="#cb33-4" aria-hidden="true"></a></span>
     <span id="cb33-5"><a href="#cb33-5" aria-hidden="true"></a></span>
     <span id="cb33-6"><a href="#cb33-6" aria-hidden="true"></a><span class="co"># Choose contrasts of interest / add fdr-correction</span></span>
     <span id="cb33-7"><a href="#cb33-7" aria-hidden="true"></a>P1_Val_lmm_model_posthoc =<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(mod_P1_val_lmer, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">Condition =</span> <span class="kw">c</span>(<span class="st">&quot;neutral - happy = 0&quot;</span>, </span>
     <span id="cb33-8"><a href="#cb33-8" aria-hidden="true"></a>    <span class="st">&quot;neutral - angry = 0&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="dt">type =</span> <span class="st">&quot;fdr&quot;</span>)))</span>
     <span id="cb33-9"><a href="#cb33-9" aria-hidden="true"></a></span>
     <span id="cb33-10"><a href="#cb33-10" aria-hidden="true"></a></span>
     <span id="cb33-11"><a href="#cb33-11" aria-hidden="true"></a><span class="co"># Get ready for presentation in RMarkdown</span></span>
     <span id="cb33-12"><a href="#cb33-12" aria-hidden="true"></a>tab1 =<span class="st"> </span><span class="kw">merge</span>(<span class="kw">as.data.frame</span>(P1_Val_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>coefficients), <span class="kw">as.data.frame</span>(P1_Val_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>sigma), </span>
     <span id="cb33-13"><a href="#cb33-13" aria-hidden="true"></a>    <span class="dt">by =</span> <span class="dv">0</span>)</span>
     <span id="cb33-14"><a href="#cb33-14" aria-hidden="true"></a>tab2 =<span class="st"> </span><span class="kw">as.data.frame</span>(P1_Val_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>pvalues)</span>
     <span id="cb33-15"><a href="#cb33-15" aria-hidden="true"></a><span class="kw">rownames</span>(tab2) =<span class="st"> </span><span class="kw">rownames</span>(<span class="kw">as.data.frame</span>(P1_Val_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>tstat))</span>
     <span id="cb33-16"><a href="#cb33-16" aria-hidden="true"></a>tab2 =<span class="st"> </span><span class="kw">merge</span>(<span class="kw">as.data.frame</span>(P1_Val_lmm_model_posthoc<span class="op">$</span>test<span class="op">$</span>tstat), tab2, <span class="dt">by =</span> <span class="dv">0</span>)</span>
     <span id="cb33-17"><a href="#cb33-17" aria-hidden="true"></a>P1_Val_posthoc =<span class="st"> </span><span class="kw">merge</span>(tab1, tab2, <span class="dt">by =</span> <span class="st">&quot;Row.names&quot;</span>)</span>
     <span id="cb33-18"><a href="#cb33-18" aria-hidden="true"></a><span class="kw">colnames</span>(P1_Val_posthoc) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Contrast&quot;</span>, <span class="st">&quot;Est.&quot;</span>, <span class="st">&quot;Std. Error&quot;</span>, <span class="st">&quot;z value&quot;</span>, <span class="st">&quot;p value&quot;</span>)</span>
     <span id="cb33-19"><a href="#cb33-19" aria-hidden="true"></a></span>
     <span id="cb33-20"><a href="#cb33-20" aria-hidden="true"></a></span>
     <span id="cb33-21"><a href="#cb33-21" aria-hidden="true"></a><span class="co">### Calculate post-hoc tests for P1</span></span>
     <span id="cb33-22"><a href="#cb33-22" aria-hidden="true"></a>P1_Cat<span class="op">$</span>interaction =<span class="st"> </span><span class="kw">interaction</span>(P1_Cat<span class="op">$</span>rep, P1_Cat<span class="op">$</span>emot)</span>
     <span id="cb33-23"><a href="#cb33-23" aria-hidden="true"></a></span>
     <span id="cb33-24"><a href="#cb33-24" aria-hidden="true"></a>P1_Cat_model =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P1 <span class="op">~</span><span class="st"> </span>interaction <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID), </span>
     <span id="cb33-25"><a href="#cb33-25" aria-hidden="true"></a>    <span class="dt">data =</span> P1_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
     <span id="cb33-26"><a href="#cb33-26" aria-hidden="true"></a></span>
     <span id="cb33-27"><a href="#cb33-27" aria-hidden="true"></a></span>
     <span id="cb33-28"><a href="#cb33-28" aria-hidden="true"></a><span class="co"># Select contrasts of interest</span></span>
     <span id="cb33-29"><a href="#cb33-29" aria-hidden="true"></a>P1_Cat_model_posthoc =<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(P1_Cat_model, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">interaction =</span> <span class="kw">c</span>(<span class="st">&quot;repeated.neutral - novel.neutral = 0&quot;</span>, </span>
     <span id="cb33-30"><a href="#cb33-30" aria-hidden="true"></a>    <span class="st">&quot;repeated.happy - novel.happy = 0&quot;</span>, <span class="st">&quot;repeated.angry - novel.angry = 0&quot;</span>, <span class="st">&quot;novel.neutral - novel.happy = 0&quot;</span>, </span>
     <span id="cb33-31"><a href="#cb33-31" aria-hidden="true"></a>    <span class="st">&quot;novel.neutral - repeated.happy = 0&quot;</span>, <span class="st">&quot;repeated.neutral - repeated.happy = 0&quot;</span>, </span>
     <span id="cb33-32"><a href="#cb33-32" aria-hidden="true"></a>    <span class="st">&quot;repeated.neutral - novel.happy = 0&quot;</span>, <span class="st">&quot;novel.neutral - novel.angry = 0&quot;</span>, <span class="st">&quot;novel.neutral - repeated.angry = 0&quot;</span>, </span>
     <span id="cb33-33"><a href="#cb33-33" aria-hidden="true"></a>    <span class="st">&quot;repeated.neutral - repeated.angry = 0&quot;</span>, <span class="st">&quot;repeated.neutral - novel.angry = 0&quot;</span>)), </span>
     <span id="cb33-34"><a href="#cb33-34" aria-hidden="true"></a>    <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="dt">type =</span> <span class="st">&quot;fdr&quot;</span>)))</span>
     <span id="cb33-35"><a href="#cb33-35" aria-hidden="true"></a></span>
     <span id="cb33-36"><a href="#cb33-36" aria-hidden="true"></a><span class="co"># Get ready for presentation in RMarkdown</span></span>
     <span id="cb33-37"><a href="#cb33-37" aria-hidden="true"></a>tab1 =<span class="st"> </span><span class="kw">merge</span>(<span class="kw">as.data.frame</span>(P1_Cat_model_posthoc<span class="op">$</span>test<span class="op">$</span>coefficients), <span class="kw">as.data.frame</span>(P1_Cat_model_posthoc<span class="op">$</span>test<span class="op">$</span>sigma), </span>
     <span id="cb33-38"><a href="#cb33-38" aria-hidden="true"></a>    <span class="dt">by =</span> <span class="dv">0</span>)</span>
     <span id="cb33-39"><a href="#cb33-39" aria-hidden="true"></a>tab2 =<span class="st"> </span><span class="kw">as.data.frame</span>(P1_Cat_model_posthoc<span class="op">$</span>test<span class="op">$</span>pvalues)</span>
     <span id="cb33-40"><a href="#cb33-40" aria-hidden="true"></a><span class="kw">rownames</span>(tab2) =<span class="st"> </span><span class="kw">rownames</span>(<span class="kw">as.data.frame</span>(P1_Cat_model_posthoc<span class="op">$</span>test<span class="op">$</span>tstat))</span>
     <span id="cb33-41"><a href="#cb33-41" aria-hidden="true"></a>tab2 =<span class="st"> </span><span class="kw">merge</span>(<span class="kw">as.data.frame</span>(P1_Cat_model_posthoc<span class="op">$</span>test<span class="op">$</span>tstat), tab2, <span class="dt">by =</span> <span class="dv">0</span>)</span>
     <span id="cb33-42"><a href="#cb33-42" aria-hidden="true"></a>P1_Cat_posthoc =<span class="st"> </span><span class="kw">merge</span>(tab1, tab2, <span class="dt">by =</span> <span class="st">&quot;Row.names&quot;</span>)</span>
     <span id="cb33-43"><a href="#cb33-43" aria-hidden="true"></a><span class="kw">colnames</span>(P1_Cat_posthoc) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Contrast&quot;</span>, <span class="st">&quot;Est.&quot;</span>, <span class="st">&quot;Std. Error&quot;</span>, <span class="st">&quot;z value&quot;</span>, <span class="st">&quot;p value&quot;</span>)</span>
     <span id="cb33-44"><a href="#cb33-44" aria-hidden="true"></a></span>
     <span id="cb33-45"><a href="#cb33-45" aria-hidden="true"></a></span>
     <span id="cb33-46"><a href="#cb33-46" aria-hidden="true"></a></span>
     <span id="cb33-47"><a href="#cb33-47" aria-hidden="true"></a><span class="co">### Calculate post-hoc tests for N170</span></span>
     <span id="cb33-48"><a href="#cb33-48" aria-hidden="true"></a>N170_Cat<span class="op">$</span>interaction =<span class="st"> </span><span class="kw">interaction</span>(N170_Cat<span class="op">$</span>rep, N170_Cat<span class="op">$</span>emot)</span>
     <span id="cb33-49"><a href="#cb33-49" aria-hidden="true"></a></span>
     <span id="cb33-50"><a href="#cb33-50" aria-hidden="true"></a>N170_Cat_model =<span class="st"> </span><span class="kw">lmer</span>(N170_Amplitude <span class="op">~</span><span class="st"> </span>interaction <span class="op">+</span><span class="st"> </span>Hem <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span></span>
     <span id="cb33-51"><a href="#cb33-51" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Emo_NeuxRep_Nov <span class="op">||</span><span class="st"> </span>ID), <span class="dt">data =</span> N170_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
     <span id="cb33-52"><a href="#cb33-52" aria-hidden="true"></a></span>
     <span id="cb33-53"><a href="#cb33-53" aria-hidden="true"></a></span>
     <span id="cb33-54"><a href="#cb33-54" aria-hidden="true"></a><span class="co"># Select contrasts of interest</span></span>
     <span id="cb33-55"><a href="#cb33-55" aria-hidden="true"></a>N170_Cat_model_posthoc =<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(N170_Cat_model, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">interaction =</span> <span class="kw">c</span>(<span class="st">&quot;repeated.neutral - novel.neutral = 0&quot;</span>, </span>
     <span id="cb33-56"><a href="#cb33-56" aria-hidden="true"></a>    <span class="st">&quot;repeated.happy - novel.happy = 0&quot;</span>, <span class="st">&quot;repeated.angry - novel.angry = 0&quot;</span>, <span class="st">&quot;novel.neutral - novel.happy = 0&quot;</span>, </span>
     <span id="cb33-57"><a href="#cb33-57" aria-hidden="true"></a>    <span class="st">&quot;novel.neutral - repeated.happy = 0&quot;</span>, <span class="st">&quot;repeated.neutral - repeated.happy = 0&quot;</span>, </span>
     <span id="cb33-58"><a href="#cb33-58" aria-hidden="true"></a>    <span class="st">&quot;repeated.neutral - novel.happy = 0&quot;</span>, <span class="st">&quot;novel.neutral - novel.angry = 0&quot;</span>, <span class="st">&quot;novel.neutral - repeated.angry = 0&quot;</span>, </span>
     <span id="cb33-59"><a href="#cb33-59" aria-hidden="true"></a>    <span class="st">&quot;repeated.neutral - repeated.angry = 0&quot;</span>, <span class="st">&quot;repeated.neutral - novel.angry = 0&quot;</span>)), </span>
     <span id="cb33-60"><a href="#cb33-60" aria-hidden="true"></a>    <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="dt">type =</span> <span class="st">&quot;fdr&quot;</span>)))</span>
     <span id="cb33-61"><a href="#cb33-61" aria-hidden="true"></a><span class="co"># Get ready for presentation in RMarkdown</span></span>
     <span id="cb33-62"><a href="#cb33-62" aria-hidden="true"></a>tab1 =<span class="st"> </span><span class="kw">merge</span>(<span class="kw">as.data.frame</span>(N170_Cat_model_posthoc<span class="op">$</span>test<span class="op">$</span>coefficients), <span class="kw">as.data.frame</span>(N170_Cat_model_posthoc<span class="op">$</span>test<span class="op">$</span>sigma), </span>
     <span id="cb33-63"><a href="#cb33-63" aria-hidden="true"></a>    <span class="dt">by =</span> <span class="dv">0</span>)</span>
     <span id="cb33-64"><a href="#cb33-64" aria-hidden="true"></a>tab2 =<span class="st"> </span><span class="kw">as.data.frame</span>(N170_Cat_model_posthoc<span class="op">$</span>test<span class="op">$</span>pvalues)</span>
     <span id="cb33-65"><a href="#cb33-65" aria-hidden="true"></a><span class="kw">rownames</span>(tab2) =<span class="st"> </span><span class="kw">rownames</span>(<span class="kw">as.data.frame</span>(N170_Cat_model_posthoc<span class="op">$</span>test<span class="op">$</span>tstat))</span>
     <span id="cb33-66"><a href="#cb33-66" aria-hidden="true"></a>tab2 =<span class="st"> </span><span class="kw">merge</span>(<span class="kw">as.data.frame</span>(N170_Cat_model_posthoc<span class="op">$</span>test<span class="op">$</span>tstat), tab2, <span class="dt">by =</span> <span class="dv">0</span>)</span>
     <span id="cb33-67"><a href="#cb33-67" aria-hidden="true"></a>N170_Cat_posthoc =<span class="st"> </span><span class="kw">merge</span>(tab1, tab2, <span class="dt">by =</span> <span class="st">&quot;Row.names&quot;</span>)</span>
     <span id="cb33-68"><a href="#cb33-68" aria-hidden="true"></a><span class="kw">colnames</span>(N170_Cat_posthoc) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Contrast&quot;</span>, <span class="st">&quot;Est.&quot;</span>, <span class="st">&quot;Std. Error&quot;</span>, <span class="st">&quot;z value&quot;</span>, <span class="st">&quot;p value&quot;</span>)</span>
     <span id="cb33-69"><a href="#cb33-69" aria-hidden="true"></a></span>
     <span id="cb33-70"><a href="#cb33-70" aria-hidden="true"></a><span class="co">### Calculate post-hoc tests for P3</span></span>
     <span id="cb33-71"><a href="#cb33-71" aria-hidden="true"></a>P3_Cat<span class="op">$</span>interaction =<span class="st"> </span><span class="kw">interaction</span>(P3_Cat<span class="op">$</span>rep, P3_Cat<span class="op">$</span>emot)</span>
     <span id="cb33-72"><a href="#cb33-72" aria-hidden="true"></a></span>
     <span id="cb33-73"><a href="#cb33-73" aria-hidden="true"></a>P3_Cat_model =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P3 <span class="op">~</span><span class="st"> </span>emot <span class="op">*</span><span class="st"> </span>rep <span class="op">+</span><span class="st"> </span>WM_scal <span class="op">+</span><span class="st"> </span>contr_F2_scal <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID), </span>
     <span id="cb33-74"><a href="#cb33-74" aria-hidden="true"></a>    <span class="dt">data =</span> P3_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
     <span id="cb33-75"><a href="#cb33-75" aria-hidden="true"></a></span>
     <span id="cb33-76"><a href="#cb33-76" aria-hidden="true"></a></span>
     <span id="cb33-77"><a href="#cb33-77" aria-hidden="true"></a><span class="co"># Select contrasts of interest</span></span>
     <span id="cb33-78"><a href="#cb33-78" aria-hidden="true"></a>P3_Cat_model_posthoc =<span class="st"> </span><span class="kw">summary</span>(<span class="kw">glht</span>(P3_Cat_model, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">emot =</span> <span class="kw">c</span>(<span class="st">&quot;happy - neutral = 0&quot;</span>, </span>
     <span id="cb33-79"><a href="#cb33-79" aria-hidden="true"></a>    <span class="st">&quot;angry - neutral = 0&quot;</span>)), <span class="dt">test =</span> <span class="kw">adjusted</span>(<span class="dt">type =</span> <span class="st">&quot;fdr&quot;</span>)))</span>
     <span id="cb33-80"><a href="#cb33-80" aria-hidden="true"></a></span>
     <span id="cb33-81"><a href="#cb33-81" aria-hidden="true"></a><span class="co"># Get ready for presentation in RMarkdown</span></span>
     <span id="cb33-82"><a href="#cb33-82" aria-hidden="true"></a>tab1 =<span class="st"> </span><span class="kw">merge</span>(<span class="kw">as.data.frame</span>(P3_Cat_model_posthoc<span class="op">$</span>test<span class="op">$</span>coefficients), <span class="kw">as.data.frame</span>(P3_Cat_model_posthoc<span class="op">$</span>test<span class="op">$</span>sigma), </span>
     <span id="cb33-83"><a href="#cb33-83" aria-hidden="true"></a>    <span class="dt">by =</span> <span class="dv">0</span>)</span>
     <span id="cb33-84"><a href="#cb33-84" aria-hidden="true"></a>tab2 =<span class="st"> </span><span class="kw">as.data.frame</span>(P3_Cat_model_posthoc<span class="op">$</span>test<span class="op">$</span>pvalues)</span>
     <span id="cb33-85"><a href="#cb33-85" aria-hidden="true"></a><span class="kw">rownames</span>(tab2) =<span class="st"> </span><span class="kw">rownames</span>(<span class="kw">as.data.frame</span>(P3_Cat_model_posthoc<span class="op">$</span>test<span class="op">$</span>tstat))</span>
     <span id="cb33-86"><a href="#cb33-86" aria-hidden="true"></a>tab2 =<span class="st"> </span><span class="kw">merge</span>(<span class="kw">as.data.frame</span>(P3_Cat_model_posthoc<span class="op">$</span>test<span class="op">$</span>tstat), tab2, <span class="dt">by =</span> <span class="dv">0</span>)</span>
     <span id="cb33-87"><a href="#cb33-87" aria-hidden="true"></a>P3_Cat_posthoc =<span class="st"> </span><span class="kw">merge</span>(tab1, tab2, <span class="dt">by =</span> <span class="st">&quot;Row.names&quot;</span>)</span>
     <span id="cb33-88"><a href="#cb33-88" aria-hidden="true"></a><span class="kw">colnames</span>(P3_Cat_posthoc) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Contrast&quot;</span>, <span class="st">&quot;Est.&quot;</span>, <span class="st">&quot;Std. Error&quot;</span>, <span class="st">&quot;z value&quot;</span>, <span class="st">&quot;p value&quot;</span>)</span></code></pre></div>
     <div id="p1" class="section level4">
     <h4><strong>P1</strong></h4>
     <p>P1 amplitudes at Face 1 were significantly larger for emotional vs. neutral facial expressions (<span class="math inline">\(\beta\)</span> = 2.58, <em>p</em> = 0.02). Post-hoc tests indicated that angry facial expressions elicited larger P1 amplitudes than neutral facial expressions (<em>p</em> = 0.03). The happy vs. neutral contrast was not significant (<em>p</em> = 0.20). Additionally, happy vs. angry facial expressions did not elicit larger P1 amplitudes (<span class="math inline">\(\beta\)</span> = 0.57, <em>p</em> = 0.38). For Face 2, we also found larger P1 amplitudes to emotional vs. neutral facial expressions (<span class="math inline">\(\beta\)</span> = 6.89, <em>p</em> &lt; 0.001), but not happy vs. angry facial expressions (<span class="math inline">\(\beta\)</span> = -0.89, <em>p</em> = 0.41). As shown in Figure @ref(fig:EEG-cat-plot), the main effect for repetition was significant (<span class="math inline">\(\beta\)</span> = 3.76, <em>p</em> = 0.00) and qualified by an interaction with emotional vs. neutral facial expression (<span class="math inline">\(\beta\)</span> = -7.35, <em>p</em> = 0.01). Post-hoc test showed that novel happy (<em>p</em> = 0.00), repeated happy (<em>p</em> = 0.01), repeated angry (<em>p</em> = 0.04) and repeated neutral facial expressions (<em>p</em> = 0.01) elicited larger P1 amplitudes than novel neutral facial expressions. Other post-hoc tests did not survive FDR-correction (all <em>p</em> &gt; 0.07). The interaction of repetition with happy vs. angry faces was not significant (<span class="math inline">\(\beta\)</span> = 0.56, <em>p</em> = 0.72).</p>
     </div>
     <div id="n170" class="section level4">
     <h4><strong>N170</strong></h4>
     <p>Regarding Face 1, we neither detected N170 amplitude differences for emotional vs. neutral facial expressions (<span class="math inline">\(\beta\)</span> = 0.49, <em>p</em> = 0.48), angry vs. neutral facial expressions (<span class="math inline">\(\beta\)</span> = 0.67, <em>p</em> = 0.10) nor hemisphere (<span class="math inline">\(\beta\)</span> = 0.09, <em>p</em> = 0.59). Accordingly, we did not find significant effects for emotion vs. neutral faces <span class="math inline">\(\beta\)</span> = 0.42, <em>p</em> = 0.73), happy vs. angry faces (<span class="math inline">\(\beta\)</span> = -0.69, <em>p</em> = 0.30) or repetition (<span class="math inline">\(\beta\)</span> = 1.02, <em>p</em> = 0.15) at Face 2. We detected a significant interaction of repetition with emotional vs. neutral facial expressions (<span class="math inline">\(\beta\)</span> = -1.74, <em>p</em> = 0.00). However, none of the post-hoc tests remained significant after FDR-correction (all <em>p</em> &gt; 0.26). Neither the interaction of repetition with angry vs. neutral facial expressions (<span class="math inline">\(\beta\)</span> = -0.89, <em>p</em> = 0.60) nor the effect of hemisphere were significant (<span class="math inline">\(\beta\)</span> = 1.78, <em>p</em> = 0.07).</p>
     </div>
     <div id="p3" class="section level4">
     <h4><strong>P3</strong></h4>
     <p>At Face 1, emotional facial expressions did not elicit larger P3 amplitudes than neutral facial expressions (<span class="math inline">\(\beta\)</span> = 0.98, <em>p</em> = 0.21). P3 amplitude differences between happy and angry facial expressions also failed to reach significance (<span class="math inline">\(\beta\)</span> = 2.36, <em>p</em> = 0.07). In contrast, P3 amplitudes differed significantly for emotional vs. neutral facial expressions for Face 2 (<span class="math inline">\(\beta\)</span> = 4.67, <em>p</em> = 0.03). Angry facial expressions elicited larger P3 amplitudes than neutral facial expressions (<em>p</em> = 0.03). No significant difference was found for happy vs. neutral facial expressions (<em>p</em> = 0.31). The happy vs. angry facial expression contrast yielded no significant results (<span class="math inline">\(\beta\)</span> = 1.38, <em>p</em> = 0.25). Neither repetition (<span class="math inline">\(\beta\)</span> = 1.88, <em>p</em> = 0.14), nor interactions with facial expression contrasts (emotional vs. neutral facial expressions: <span class="math inline">\(\beta\)</span> = -4.85, <em>p</em> = 0.12; happy vs. angry facial expressions: <span class="math inline">\(\beta\)</span> = -0.76, <em>p</em> = 0.67) were significant.</p>
     <p><br></p>
     <p><strong>Table: Face 1 results</strong></p>
     <div align="center">


     <div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true"></a><span class="co"># Define labels</span></span>
     <span id="cb34-2"><a href="#cb34-2" aria-hidden="true"></a>labels =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Emotion vs. Neutral&quot;</span>, <span class="st">&quot;Happy vs. Angry&quot;</span>, <span class="st">&quot;Working Memory&quot;</span>, <span class="st">&quot;Stimulus&#39; Contrast&quot;</span>, </span>
     <span id="cb34-3"><a href="#cb34-3" aria-hidden="true"></a>    <span class="st">&quot;Hemisphere&quot;</span>)</span>
     <span id="cb34-4"><a href="#cb34-4" aria-hidden="true"></a></span>
     <span id="cb34-5"><a href="#cb34-5" aria-hidden="true"></a></span>
     <span id="cb34-6"><a href="#cb34-6" aria-hidden="true"></a><span class="co"># Create table</span></span>
     <span id="cb34-7"><a href="#cb34-7" aria-hidden="true"></a><span class="kw">tab_model</span>(mod_P1_val.lmer4, mod_N170_val.lmer2, mod_P3_val.lmer4, <span class="dt">show.intercept =</span> <span class="ot">FALSE</span>, </span>
     <span id="cb34-8"><a href="#cb34-8" aria-hidden="true"></a>    <span class="dt">pred.labels =</span> labels, <span class="dt">string.est =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">show.se =</span> <span class="ot">TRUE</span>, <span class="dt">string.se =</span> <span class="st">&quot;SE&quot;</span>, <span class="dt">show.stat =</span> <span class="ot">TRUE</span>, </span>
     <span id="cb34-9"><a href="#cb34-9" aria-hidden="true"></a>    <span class="dt">string.stat =</span> <span class="st">&quot;t&quot;</span>, <span class="dt">show.ci =</span> <span class="ot">FALSE</span>, <span class="dt">show.re.var =</span> <span class="ot">TRUE</span>, <span class="dt">show.obs =</span> <span class="ot">FALSE</span>, <span class="dt">emph.p =</span> <span class="ot">TRUE</span>, </span>
     <span id="cb34-10"><a href="#cb34-10" aria-hidden="true"></a>    <span class="dt">dv.labels =</span> <span class="kw">c</span>(<span class="st">&quot;P1 Amplitude&quot;</span>, <span class="st">&quot;N170 Amplitude&quot;</span>, <span class="st">&quot;P3 Amplitude&quot;</span>), <span class="dt">show.icc =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
     <table style="border-collapse:collapse; border:none;">
     <tr>
     <th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
      
     </th>
     <th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
     P1 Amplitude
     </th>
     <th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
     N170 Amplitude
     </th>
     <th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
     P3 Amplitude
     </th>
     </tr>
     <tr>
     <td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
     Predictors
     </td>
     <td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
     b
     </td>
     <td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
     SE
     </td>
     <td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
     t
     </td>
     <td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
     p
     </td>
     <td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
     b
     </td>
     <td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">
     SE
     </td>
     <td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col8">
     t
     </td>
     <td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col9">
     p
     </td>
     <td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  0">
     b
     </td>
     <td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  1">
     SE
     </td>
     <td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  2">
     t
     </td>
     <td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  3">
     p
     </td>
     </tr>
     <tr>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
     Emotion vs. Neutral
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     2.58
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     1.11
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     2.32
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     <strong>0.020</strong>
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     0.49
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
     0.70
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
     0.70
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
     0.481
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
     0.98
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
     0.78
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
     1.27
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
     0.205
     </td>
     </tr>
     <tr>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
     Happy vs. Angry
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     0.57
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     0.66
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     0.88
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     0.382
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     0.67
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
     0.41
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
     1.63
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
     0.104
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
     2.36
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
     1.32
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
     1.80
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
     0.072
     </td>
     </tr>
     <tr>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
     Working Memory
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     0.18
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     0.98
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     0.18
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     0.856
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     0.11
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
     0.60
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
     0.18
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
     0.860
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
     0.67
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
     1.10
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
     0.61
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
     0.544
     </td>
     </tr>
     <tr>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
     Stimulus’ Contrast
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     -0.11
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     0.27
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     -0.43
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     0.666
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     0.09
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
     0.17
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
     0.54
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
     0.587
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
     0.03
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
     0.32
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
     0.10
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
     0.922
     </td>
     </tr>
     <tr>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
     Hemisphere
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     0.16
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
     0.33
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
     0.50
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
     0.620
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
     </td>
     </tr>
     <tr>
     <td colspan="13" style="font-weight:bold; text-align:left; padding-top:.8em;">
     Random Effects
     </td>
     </tr>
     <tr>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
     σ<sup>2</sup>
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
     198.98
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
     156.58
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
     277.95
     </td>
     <tr>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
     τ<sub>00</sub>
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
     25.51 <sub>ID</sub>
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
     9.67 <sub>ID</sub>
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
     0.19 <sub>Stim_Type</sub>
     </td>
     <tr>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
      
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
      
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
     32.03 <sub>ID</sub>
     </td>
     <tr>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
     ICC
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
     0.11
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
     0.06
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
     0.10
     </td>
     <tr>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
     N
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
     28 <sub>ID</sub>
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
     28 <sub>ID</sub>
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
     28 <sub>ID</sub>
     </td>
     <tr>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
      
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
      
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
     72 <sub>Stim_Type</sub>
     </td>
     <tr>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
     Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
     0.002 / 0.116
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
     0.001 / 0.059
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
     0.003 / 0.107
     </td>
     </tr>
     </table>
     </div>
     <p><br></p>
     <p><em>Note:</em> p-values for the fixed effects calculated using Wald-statistics approximation, uncorrected. <em>b</em>: unstandardized coefficient; <em>SE</em>: standard error; <em>t</em>: test statistic coefficient; <em>p</em>: p-value; <em>σ2</em>: within-group variance; <em>τ00</em>: between-group variance; <em>ICC</em>: interclass correlation (ratio of between-cluster variance to total variance); <em>N</em>: number of random effects.</p>
     <p><br> <br></p>
     <p><strong>Post-hoc test P1: Emotion vs. Neutral contrast</strong></p>
     <div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true"></a><span class="co"># Create table</span></span>
     <span id="cb35-2"><a href="#cb35-2" aria-hidden="true"></a><span class="kw">kable</span>(P1_Val_posthoc) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&quot;hover&quot;</span>), <span class="dt">font_size =</span> <span class="dv">14</span>, </span>
     <span id="cb35-3"><a href="#cb35-3" aria-hidden="true"></a>    <span class="dt">fixed_thead =</span> T)</span></code></pre></div>
     <table class="table table-hover" style="font-size: 14px; margin-left: auto; margin-right: auto;">
     <thead>
     <tr>
     <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
     Contrast
     </th>
     <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
     Est.
     </th>
     <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
     Std. Error
     </th>
     <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
     z value
     </th>
     <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
     p value
     </th>
     </tr>
     </thead>
     <tbody>
     <tr>
     <td style="text-align:left;">
     neutral - angry
     </td>
     <td style="text-align:right;">
     -1.58
     </td>
     <td style="text-align:right;">
     0.65
     </td>
     <td style="text-align:right;">
     -2.43
     </td>
     <td style="text-align:right;">
     0.029
     </td>
     </tr>
     <tr>
     <td style="text-align:left;">
     neutral - happy
     </td>
     <td style="text-align:right;">
     -1.00
     </td>
     <td style="text-align:right;">
     0.64
     </td>
     <td style="text-align:right;">
     -1.57
     </td>
     <td style="text-align:right;">
     0.204
     </td>
     </tr>
     </tbody>
     </table>
     <p><br></p>
     <p><strong>Table: Face 2 results</strong></p>
     <div align="center">


     <div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true"></a><span class="co"># Define labels</span></span>
     <span id="cb36-2"><a href="#cb36-2" aria-hidden="true"></a>labels =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Emotion vs. Neutral&quot;</span>, <span class="st">&quot;Happy vs. Angry&quot;</span>, <span class="st">&quot;Repetition&quot;</span>, <span class="st">&quot;E vs. N x Repetition&quot;</span>, </span>
     <span id="cb36-3"><a href="#cb36-3" aria-hidden="true"></a>    <span class="st">&quot;H vs. A x Repetition&quot;</span>, <span class="st">&quot;Working Memory&quot;</span>, <span class="st">&quot;Stimulus&#39; Contrast&quot;</span>, <span class="st">&quot;Hemisphere&quot;</span>)</span>
     <span id="cb36-4"><a href="#cb36-4" aria-hidden="true"></a></span>
     <span id="cb36-5"><a href="#cb36-5" aria-hidden="true"></a><span class="co"># Create table</span></span>
     <span id="cb36-6"><a href="#cb36-6" aria-hidden="true"></a><span class="kw">tab_model</span>(mod_P1_cat.lmer4, mod_N170_cat.lmer4, mod_P3_cat.lmer4, <span class="dt">show.intercept =</span> <span class="ot">FALSE</span>, </span>
     <span id="cb36-7"><a href="#cb36-7" aria-hidden="true"></a>    <span class="dt">pred.labels =</span> labels, <span class="dt">string.est =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">show.se =</span> <span class="ot">TRUE</span>, <span class="dt">string.se =</span> <span class="st">&quot;SE&quot;</span>, <span class="dt">show.stat =</span> <span class="ot">TRUE</span>, </span>
     <span id="cb36-8"><a href="#cb36-8" aria-hidden="true"></a>    <span class="dt">string.stat =</span> <span class="st">&quot;t&quot;</span>, <span class="dt">show.ci =</span> <span class="ot">FALSE</span>, <span class="dt">show.re.var =</span> <span class="ot">TRUE</span>, <span class="dt">show.obs =</span> <span class="ot">FALSE</span>, <span class="dt">emph.p =</span> <span class="ot">TRUE</span>, </span>
     <span id="cb36-9"><a href="#cb36-9" aria-hidden="true"></a>    <span class="dt">dv.labels =</span> <span class="kw">c</span>(<span class="st">&quot;P1 Amplitude&quot;</span>, <span class="st">&quot;N170 Amplitude&quot;</span>, <span class="st">&quot;P3 Amplitude&quot;</span>), <span class="dt">show.icc =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
     <table style="border-collapse:collapse; border:none;">
     <tr>
     <th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
      
     </th>
     <th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
     P1 Amplitude
     </th>
     <th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
     N170 Amplitude
     </th>
     <th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
     P3 Amplitude
     </th>
     </tr>
     <tr>
     <td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
     Predictors
     </td>
     <td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
     b
     </td>
     <td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
     SE
     </td>
     <td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
     t
     </td>
     <td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
     p
     </td>
     <td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
     b
     </td>
     <td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">
     SE
     </td>
     <td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col8">
     t
     </td>
     <td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col9">
     p
     </td>
     <td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  0">
     b
     </td>
     <td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  1">
     SE
     </td>
     <td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  2">
     t
     </td>
     <td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  3">
     p
     </td>
     </tr>
     <tr>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
     Emotion vs. Neutral
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     6.89
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     1.96
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     3.52
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     <strong>&lt;0.001
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     0.42
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
     1.21
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
     0.34
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
     0.731
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
     4.67
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
     2.20
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
     2.12
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
     <strong>0.034</strong>
     </td>
     </tr>
     <tr>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
     Happy vs. Angry
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     -0.89
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     1.07
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     -0.83
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     0.409
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     -0.69
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
     0.66
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
     -1.04
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
     0.296
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
     1.38
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
     1.21
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
     1.14
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
     0.255
     </td>
     </tr>
     <tr>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
     Repetition
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     3.76
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     1.14
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     3.28
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     <strong>0.001</strong>
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     1.02
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
     0.71
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
     1.44
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
     0.151
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
     1.88
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
     1.29
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
     1.46
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
     0.144
     </td>
     </tr>
     <tr>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
     E vs. N x Repetition
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     -7.35
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     2.78
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     -2.65
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     <strong>0.008</strong>
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     -1.74
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
     0.88
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
     -1.98
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
     <strong>0.048</strong>
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
     -4.85
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
     3.12
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
     -1.55
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
     0.121
     </td>
     </tr>
     <tr>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
     H vs. A x Repetition
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     0.56
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     1.59
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     0.36
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     0.722
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     -0.89
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
     1.72
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
     -0.52
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
     0.604
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
     -0.76
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
     1.79
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
     -0.43
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
     0.669
     </td>
     </tr>
     <tr>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
     Working Memory
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     0.81
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     0.94
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     0.86
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     0.388
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     0.53
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
     0.69
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
     0.77
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
     0.438
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
     0.30
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
     1.26
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
     0.24
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
     0.810
     </td>
     </tr>
     <tr>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
     Stimulus’ Contrast
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     -0.11
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     0.32
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     -0.35
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     0.729
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     0.04
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
     0.20
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
     0.19
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
     0.847
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
     -0.36
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
     0.36
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
     -0.99
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
     0.324
     </td>
     </tr>
     <tr>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
     Hemisphere
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
     1.78
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
     0.98
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
     1.81
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
     0.071
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
     </td>
     </tr>
     <tr>
     <td colspan="13" style="font-weight:bold; text-align:left; padding-top:.8em;">
     Random Effects
     </td>
     </tr>
     <tr>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
     σ<sup>2</sup>
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
     187.29
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
     143.38
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
     236.96
     </td>
     <tr>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
     τ<sub>00</sub>
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
     22.06 <sub>ID</sub>
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
     11.23 <sub>ID</sub>
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
     41.73 <sub>ID</sub>
     </td>
     <tr>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
      
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
     16.82 <sub>ID.1</sub>
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
      
     </td>
     <tr>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
     ICC
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
     0.11
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
     0.07
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
     0.15
     </td>
     <tr>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
     N
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
     28 <sub>ID</sub>
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
     28 <sub>ID</sub>
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
     28 <sub>ID</sub>
     </td>
     <tr>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
     Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
     0.011 / 0.115
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
     0.008 / 0.080
     </td>
     <td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
     0.004 / 0.153
     </td>
     </tr>
     </table>
     </div>
     <p><br></p>
     <p><em>Note:</em> p-values for the fixed effects calculated using Wald-statistics approximation, uncorrected. <em>b</em>: unstandardized coefficient; <em>SE</em>: standard error; <em>t</em>: test statistic coefficient; <em>p</em>: p-value; <em>σ2</em>: within-group variance; <em>τ00</em>: between-group variance; <em>ICC</em>: interclass correlation (ratio of between-cluster variance to total variance); <em>N</em>: number of random effects.</p>
     <p><br></p>
     <p><strong>Post-hoc test P1: Contrast Emotion vs. Neutral with Repetition interaction</strong></p>
     <div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true"></a><span class="co"># Create table</span></span>
     <span id="cb37-2"><a href="#cb37-2" aria-hidden="true"></a><span class="kw">kable</span>(P1_Cat_posthoc) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&quot;hover&quot;</span>), <span class="dt">font_size =</span> <span class="dv">14</span>, </span>
     <span id="cb37-3"><a href="#cb37-3" aria-hidden="true"></a>    <span class="dt">fixed_thead =</span> T)</span></code></pre></div>
     <table class="table table-hover" style="font-size: 14px; margin-left: auto; margin-right: auto;">
     <thead>
     <tr>
     <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
     Contrast
     </th>
     <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
     Est.
     </th>
     <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
     Std. Error
     </th>
     <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
     z value
     </th>
     <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
     p value
     </th>
     </tr>
     </thead>
     <tbody>
     <tr>
     <td style="text-align:left;">
     novel.neutral - novel.angry
     </td>
     <td style="text-align:right;">
     -3.002
     </td>
     <td style="text-align:right;">
     1.13
     </td>
     <td style="text-align:right;">
     -2.662
     </td>
     <td style="text-align:right;">
     0.066
     </td>
     </tr>
     <tr>
     <td style="text-align:left;">
     novel.neutral - novel.happy
     </td>
     <td style="text-align:right;">
     -3.889
     </td>
     <td style="text-align:right;">
     1.10
     </td>
     <td style="text-align:right;">
     -3.518
     </td>
     <td style="text-align:right;">
     0.004
     </td>
     </tr>
     <tr>
     <td style="text-align:left;">
     novel.neutral - repeated.angry
     </td>
     <td style="text-align:right;">
     -3.368
     </td>
     <td style="text-align:right;">
     1.18
     </td>
     <td style="text-align:right;">
     -2.849
     </td>
     <td style="text-align:right;">
     0.039
     </td>
     </tr>
     <tr>
     <td style="text-align:left;">
     novel.neutral - repeated.happy
     </td>
     <td style="text-align:right;">
     -3.691
     </td>
     <td style="text-align:right;">
     1.16
     </td>
     <td style="text-align:right;">
     -3.168
     </td>
     <td style="text-align:right;">
     0.015
     </td>
     </tr>
     <tr>
     <td style="text-align:left;">
     repeated.angry - novel.angry
     </td>
     <td style="text-align:right;">
     0.366
     </td>
     <td style="text-align:right;">
     1.15
     </td>
     <td style="text-align:right;">
     0.319
     </td>
     <td style="text-align:right;">
     0.999
     </td>
     </tr>
     <tr>
     <td style="text-align:left;">
     repeated.happy - novel.happy
     </td>
     <td style="text-align:right;">
     -0.198
     </td>
     <td style="text-align:right;">
     1.11
     </td>
     <td style="text-align:right;">
     -0.179
     </td>
     <td style="text-align:right;">
     1.000
     </td>
     </tr>
     <tr>
     <td style="text-align:left;">
     repeated.neutral - novel.angry
     </td>
     <td style="text-align:right;">
     0.758
     </td>
     <td style="text-align:right;">
     1.11
     </td>
     <td style="text-align:right;">
     0.681
     </td>
     <td style="text-align:right;">
     0.978
     </td>
     </tr>
     <tr>
     <td style="text-align:left;">
     repeated.neutral - novel.happy
     </td>
     <td style="text-align:right;">
     -0.129
     </td>
     <td style="text-align:right;">
     1.09
     </td>
     <td style="text-align:right;">
     -0.119
     </td>
     <td style="text-align:right;">
     1.000
     </td>
     </tr>
     <tr>
     <td style="text-align:left;">
     repeated.neutral - novel.neutral
     </td>
     <td style="text-align:right;">
     3.760
     </td>
     <td style="text-align:right;">
     1.14
     </td>
     <td style="text-align:right;">
     3.284
     </td>
     <td style="text-align:right;">
     0.010
     </td>
     </tr>
     <tr>
     <td style="text-align:left;">
     repeated.neutral - repeated.angry
     </td>
     <td style="text-align:right;">
     0.392
     </td>
     <td style="text-align:right;">
     1.15
     </td>
     <td style="text-align:right;">
     0.339
     </td>
     <td style="text-align:right;">
     0.999
     </td>
     </tr>
     <tr>
     <td style="text-align:left;">
     repeated.neutral - repeated.happy
     </td>
     <td style="text-align:right;">
     0.069
     </td>
     <td style="text-align:right;">
     1.14
     </td>
     <td style="text-align:right;">
     0.061
     </td>
     <td style="text-align:right;">
     1.000
     </td>
     </tr>
     </tbody>
     </table>
     <p><br></p>
     <p><strong>Post-hoc test N170: Contrast Emotion vs. Neutral with Repetition interaction</strong></p>
     <div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true"></a><span class="co"># Create table</span></span>
     <span id="cb38-2"><a href="#cb38-2" aria-hidden="true"></a><span class="kw">kable</span>(N170_Cat_posthoc) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&quot;hover&quot;</span>), <span class="dt">font_size =</span> <span class="dv">14</span>, </span>
     <span id="cb38-3"><a href="#cb38-3" aria-hidden="true"></a>    <span class="dt">fixed_thead =</span> T)</span></code></pre></div>
     <table class="table table-hover" style="font-size: 14px; margin-left: auto; margin-right: auto;">
     <thead>
     <tr>
     <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
     Contrast
     </th>
     <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
     Est.
     </th>
     <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
     Std. Error
     </th>
     <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
     z value
     </th>
     <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
     p value
     </th>
     </tr>
     </thead>
     <tbody>
     <tr>
     <td style="text-align:left;">
     novel.neutral - novel.angry
     </td>
     <td style="text-align:right;">
     0.140
     </td>
     <td style="text-align:right;">
     0.698
     </td>
     <td style="text-align:right;">
     0.200
     </td>
     <td style="text-align:right;">
     1.000
     </td>
     </tr>
     <tr>
     <td style="text-align:left;">
     novel.neutral - novel.happy
     </td>
     <td style="text-align:right;">
     -0.555
     </td>
     <td style="text-align:right;">
     0.684
     </td>
     <td style="text-align:right;">
     -0.811
     </td>
     <td style="text-align:right;">
     0.954
     </td>
     </tr>
     <tr>
     <td style="text-align:left;">
     novel.neutral - repeated.angry
     </td>
     <td style="text-align:right;">
     -1.321
     </td>
     <td style="text-align:right;">
     0.731
     </td>
     <td style="text-align:right;">
     -1.807
     </td>
     <td style="text-align:right;">
     0.407
     </td>
     </tr>
     <tr>
     <td style="text-align:left;">
     novel.neutral - repeated.happy
     </td>
     <td style="text-align:right;">
     -0.238
     </td>
     <td style="text-align:right;">
     0.721
     </td>
     <td style="text-align:right;">
     -0.331
     </td>
     <td style="text-align:right;">
     0.999
     </td>
     </tr>
     <tr>
     <td style="text-align:left;">
     repeated.angry - novel.angry
     </td>
     <td style="text-align:right;">
     1.461
     </td>
     <td style="text-align:right;">
     0.710
     </td>
     <td style="text-align:right;">
     2.058
     </td>
     <td style="text-align:right;">
     0.264
     </td>
     </tr>
     <tr>
     <td style="text-align:left;">
     repeated.happy - novel.happy
     </td>
     <td style="text-align:right;">
     -0.316
     </td>
     <td style="text-align:right;">
     0.686
     </td>
     <td style="text-align:right;">
     -0.461
     </td>
     <td style="text-align:right;">
     0.996
     </td>
     </tr>
     <tr>
     <td style="text-align:left;">
     repeated.neutral - novel.angry
     </td>
     <td style="text-align:right;">
     1.157
     </td>
     <td style="text-align:right;">
     0.689
     </td>
     <td style="text-align:right;">
     1.680
     </td>
     <td style="text-align:right;">
     0.489
     </td>
     </tr>
     <tr>
     <td style="text-align:left;">
     repeated.neutral - novel.happy
     </td>
     <td style="text-align:right;">
     0.463
     </td>
     <td style="text-align:right;">
     0.672
     </td>
     <td style="text-align:right;">
     0.689
     </td>
     <td style="text-align:right;">
     0.977
     </td>
     </tr>
     <tr>
     <td style="text-align:left;">
     repeated.neutral - novel.neutral
     </td>
     <td style="text-align:right;">
     1.018
     </td>
     <td style="text-align:right;">
     0.709
     </td>
     <td style="text-align:right;">
     1.436
     </td>
     <td style="text-align:right;">
     0.654
     </td>
     </tr>
     <tr>
     <td style="text-align:left;">
     repeated.neutral - repeated.angry
     </td>
     <td style="text-align:right;">
     -0.304
     </td>
     <td style="text-align:right;">
     0.714
     </td>
     <td style="text-align:right;">
     -0.426
     </td>
     <td style="text-align:right;">
     0.997
     </td>
     </tr>
     <tr>
     <td style="text-align:left;">
     repeated.neutral - repeated.happy
     </td>
     <td style="text-align:right;">
     0.779
     </td>
     <td style="text-align:right;">
     0.704
     </td>
     <td style="text-align:right;">
     1.107
     </td>
     <td style="text-align:right;">
     0.849
     </td>
     </tr>
     </tbody>
     </table>
     <p><br></p>
     <p><strong>Post-hoc test P3: Contrast Emotion vs. Neutral</strong></p>
     <div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true"></a><span class="co"># Create table</span></span>
     <span id="cb39-2"><a href="#cb39-2" aria-hidden="true"></a><span class="kw">kable</span>(P3_Cat_posthoc) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&quot;hover&quot;</span>), <span class="dt">font_size =</span> <span class="dv">14</span>, </span>
     <span id="cb39-3"><a href="#cb39-3" aria-hidden="true"></a>    <span class="dt">fixed_thead =</span> T)</span></code></pre></div>
     <table class="table table-hover" style="font-size: 14px; margin-left: auto; margin-right: auto;">
     <thead>
     <tr>
     <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
     Contrast
     </th>
     <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
     Est.
     </th>
     <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
     Std. Error
     </th>
     <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
     z value
     </th>
     <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
     p value
     </th>
     </tr>
     </thead>
     <tbody>
     <tr>
     <td style="text-align:left;">
     angry - neutral
     </td>
     <td style="text-align:right;">
     3.02
     </td>
     <td style="text-align:right;">
     1.27
     </td>
     <td style="text-align:right;">
     2.38
     </td>
     <td style="text-align:right;">
     0.032
     </td>
     </tr>
     <tr>
     <td style="text-align:left;">
     happy - neutral
     </td>
     <td style="text-align:right;">
     1.65
     </td>
     <td style="text-align:right;">
     1.24
     </td>
     <td style="text-align:right;">
     1.32
     </td>
     <td style="text-align:right;">
     0.308
     </td>
     </tr>
     </tbody>
     </table>
     </div>
     </div>
     </div>
     </div>
     <div id="session-info" class="section level1">
     <h1>Session info</h1>
     <!-- Provide session info  -->
     <div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true"></a><span class="co"># Get session info</span></span>
     <span id="cb40-2"><a href="#cb40-2" aria-hidden="true"></a><span class="kw">sessionInfo</span>()</span></code></pre></div>
     <pre><code>R version 4.0.2 (2020-06-22)
     Platform: x86_64-w64-mingw32/x64 (64-bit)
     Running under: Windows 10 x64 (build 18362)

     Matrix products: default

     locale:
     [1] LC_COLLATE=German_Germany.1252  LC_CTYPE=German_Germany.1252   
     [3] LC_MONETARY=German_Germany.1252 LC_NUMERIC=C                   
     [5] LC_TIME=German_Germany.1252    

     attached base packages:
     [1] stats     graphics  grDevices utils     datasets  methods   base     

     other attached packages:
      [1] gvlma_1.0.0.3      eegUtils_0.5.0     forcats_0.5.0      stringr_1.4.0     
      [5] purrr_0.3.4        readr_1.3.1        tidyr_1.1.1        tibble_3.0.3      
      [9] tidyverse_1.3.0    sjlabelled_1.1.7   sjmisc_2.8.5       sjPlot_2.8.4      
     [13] Rmisc_1.5          plyr_1.8.6         reshape2_1.4.4     psych_2.0.7       
     [17] multcomp_1.4-15    TH.data_1.0-10     mvtnorm_1.1-1      MASS_7.3-51.6     
     [21] lmerTest_3.1-3     lme4_1.1-23        Matrix_1.2-18      Hmisc_4.4-2       
     [25] Formula_1.2-4      survival_3.2-7     lattice_0.20-41    ggstatsplot_0.6.6 
     [29] ez_4.4-0           EnvStats_2.4.0     eeptools_1.2.4     ggplot2_3.3.2     
     [33] dplyr_1.0.1        cowplot_1.1.0      summarytools_0.9.6 miceadds_3.10-28  
     [37] mice_3.11.0        rmdformats_1.0.0   XLConnect_1.0.1    kableExtra_1.1.0  

     loaded via a namespace (and not attached):
      [1] vcd_1.4-8            ps_1.5.0             lmtest_0.9-38       
      [4] crayon_1.3.4         V8_3.4.0             PMCMRplus_1.7.1     
      [7] nlme_3.1-151         backports_1.1.8      metafor_2.4-0       
     [10] reprex_0.3.0         ggcorrplot_0.1.3     rlang_0.4.7         
     [13] readxl_1.3.1         performance_0.6.1    nloptr_1.2.2.2      
     [16] callr_3.5.1          glue_1.4.1           loo_2.4.1           
     [19] rstan_2.21.2         parallel_4.0.2       processx_3.4.5      
     [22] shinydashboard_0.7.1 tcltk_4.0.2          haven_2.3.1         
     [25] tidyselect_1.1.0     rio_0.5.16           zoo_1.8-8           
     [28] SuppDists_1.1-9.5    mc2d_0.1-18          xtable_1.8-4        
     [31] MatrixModels_0.4-1   magrittr_2.0.1       evaluate_0.14       
     [34] cli_2.2.0            rstudioapi_0.13      miniUI_0.1.1.1      
     [37] sp_1.4-4             rpart_4.1-15         shiny_1.5.0         
     [40] xfun_0.22            parameters_0.10.1    inline_0.3.17       
     [43] pkgbuild_1.2.0       cluster_2.1.0        bridgesampling_1.0-0
     [46] WRS2_1.1-0           expm_0.999-5         Brobdingnag_1.2-6   
     [49] ggrepel_0.8.2        listenv_0.8.0        png_0.1-7           
     [52] reshape_0.8.8        future_1.21.0        zeallot_0.1.0       
     [55] withr_2.3.0          rcompanion_2.3.26    cellranger_1.1.0    
     [58] pracma_2.2.9         coda_0.19-4          pillar_1.4.7        
     [61] RcppParallel_5.0.2   Rmpfr_0.8-2          fs_1.5.0            
     [64] paletteer_1.2.0      vctrs_0.3.2          ellipsis_0.3.1      
     [67] generics_0.1.0       nortest_1.0-4        tools_4.0.2         
     [70] foreign_0.8-80       munsell_0.5.0        emmeans_1.5.3       
     [73] fastmap_1.0.1        compiler_4.0.2       abind_1.4-5         
      [ reached getOption(&quot;max.print&quot;) -- omitted 124 entries ]</code></pre>
     </div>
	  </div>

	  <div class="col-xs-2">

	    	    <div class = "btn-toolbar">
	    <div class="btn-group">
	      <a class="btn btn-raised btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" href="#"><span>Code</span> <span class="caret"></span></a>
	      <ul class="dropdown-menu" style="min-width: 50px;">
				<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
		<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
							      </ul>
	    </div>
	    </div>
	    
	    </div>
    </div>
	
    

    </div>
  </div>

 <script>
    $(document).ready(function () {
	// add bootstrap table styles to pandoc tables
	$('tr.header').parent('thead').parent('table').addClass('table table-striped table-hover');
	
	
		$('.pages img').addClass("image-lb");
	$('.pages').magnificPopup({
	    type:'image',
	    closeOnContentClick: false,
	    closeBtnInside: false,
            delegate: 'img',
	    gallery: {enabled: true },
            removalDelay: 500,
            callbacks: {
		beforeOpen: function() {
                    // just a hack that adds mfp-anim class to markup
                    this.st.image.markup = this.st.image.markup.replace('mfp-figure', 'mfp-figure mfp-with-anim');
		}
            },
            mainClass: 'mfp-move-from-top',
	    image: {
	        verticalFit: true,
		titleSrc: 'alt'
	    }
 	});
 	
	  
	$('#toc ul li').first().addClass("active");
	$('#toc ul li').attr("data-target", function() {
            return($(this).children("a").attr("href"));
	})
	$('body .section.level1').first().addClass("active");
	$('body .section.level1').not('.active').hide();
	
	$('#toc a[href*="#"], a[href^="#"]').click(function() {
	    var id = $(this).attr("href");
	    if (id === "#") return;
	    if (id.substring(0, 8) === "#dyntab-") return;
	    // Menu
	    var menu_entry = $(".menu li[data-target='"+id+"']");
	    if (menu_entry.length == 0) {
		window.location.hash = id;
		return;
	    }
	    menu_entry.addClass("active");
	    $(".menu li").not(menu_entry).removeClass("active"); 
	    toggle_page(id);
	});

	function toggle_page(id) {
	    $(".page").not(page).removeClass("active").hide();
	    window.page = id;
	    var page = $(window.page);
	    window.location.hash = window.page;
	    //$(this).addClass("active");
	    page.show();

	    var totop = setInterval(function () {
		$(".pages").animate({scrollTop: 0}, 0);
	    }, 10);

	    setTimeout(function () {
		page.addClass("active");
		setTimeout(function () {
		    clearInterval(totop);
		}, 1000);
	    }, 100);
	    
	    window.dispatchEvent(new Event('resize'));
	}


	$(".menu li").click(function () {
	    toggle_page($(this).data("target"));
	    // Menu
	    if (!$(this).data("target")) return;
	    if ($(this).is(".active")) return;
	    $(".menu li").not($(this)).removeClass("active");
	    $(this).addClass("active");
	});
  
	  
	window.page = window.location.hash;
	if (window.page != "") {
	    $(".menu").find("li[data-target=" + window.page + "]").trigger("click");
	}
	/* init material bootstrap js */
	$.material.init();
    });
 </script>


  <!-- dynamically load mathjax for compatibility with self-contained -->
 <script>
   (function () {
       var script = document.createElement("script");
       script.type = "text/javascript";
       script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
       document.getElementsByTagName("head")[0].appendChild(script);
   })();
 </script>
 
</body>
</html>
